<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multiple file access functions &mdash; CALCEPH  - Fortran 77/90/95 language 3.5.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Single file access functions" href="condsingle/calceph.single.html" />
    <link rel="prev" title="Library interface" href="calceph.interface.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CALCEPH  - Fortran 77/90/95 language
          </a>
              <div class="version">
                3.5.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="calceph.intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.install.cusage.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.interface.html">Library interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multiple file access functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#time-notes">Time notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thread-notes">Thread notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-open">f90calceph_open</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.open"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.open()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-open-array">f90calceph_open_array</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.open()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-prefetch">f90calceph_prefetch</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.prefetch"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.prefetch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-isthreadsafe">f90calceph_isthreadsafe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.isthreadsafe"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.isthreadsafe()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-compute">f90calceph_compute</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.compute"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.compute()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-compute-unit">f90calceph_compute_unit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.compute_unit"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.compute_unit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-orient-unit">f90calceph_orient_unit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.orient_unit"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.orient_unit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-rotangmom-unit">f90calceph_rotangmom_unit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.rotangmom_unit"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.rotangmom_unit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-compute-order">f90calceph_compute_order</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.compute_order"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.compute_order()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-orient-order">f90calceph_orient_order</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.orient_order"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.orient_order()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-rotangmom-order">f90calceph_rotangmom_order</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.rotangmom_order"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.rotangmom_order()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstant">f90calceph_getconstant</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getconstant"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getconstant()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantsd">f90calceph_getconstantsd</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getconstantsd"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getconstantsd()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantvd">f90calceph_getconstantvd</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getconstantvd"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getconstantvd()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantss">f90calceph_getconstantss</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getconstantss"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getconstantss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantvs">f90calceph_getconstantvs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getconstantvs"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getconstantvs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantcount">f90calceph_getconstantcount</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getconstantcount"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getconstantcount()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantindex">f90calceph_getconstantindex</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getconstantindex"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getconstantindex()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getfileversion">f90calceph_getfileversion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getfileversion"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getfileversion()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-gettimescale">f90calceph_gettimescale</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.gettimescale"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.gettimescale()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-gettimespan">f90calceph_gettimespan</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.gettimespan"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.gettimespan()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getpositionrecordcount">f90calceph_getpositionrecordcount</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getpositionrecordcount"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getpositionrecordcount()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getpositionrecordindex">f90calceph_getpositionrecordindex</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getpositionrecordindex"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getpositionrecordindex()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getpositionrecordindex2">f90calceph_getpositionrecordindex2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getpositionrecordindex2"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getpositionrecordindex2()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getorientrecordcount">f90calceph_getorientrecordcount</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getorientrecordcount"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getorientrecordcount()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getorientrecordindex">f90calceph_getorientrecordindex</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getorientrecordindex"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getorientrecordindex()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getorientrecordindex2">f90calceph_getorientrecordindex2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.getorientrecordindex2"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.getorientrecordindex2()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-close">f90calceph_close</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calcephpy.CalcephBin.close"><code class="docutils literal notranslate"><span class="pre">calcephpy.CalcephBin.close()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="condsingle/calceph.single.html">Single file access functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.error.html">Error functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.misc.html">Miscellaneous functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.naifid.html">NAIF identification numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.final.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.reportbugs.html">Reporting bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.copying.html">CALCEPH Library Copying conditions</a></li>
</ul>

    <a href="genindex.html">Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CALCEPH  - Fortran 77/90/95 language</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Multiple file access functions</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="multiple-file-access-functions">
<span id="id1"></span><h1>Multiple file access functions<a class="headerlink" href="#multiple-file-access-functions" title="Permalink to this heading"></a></h1>
<p>The following group of functions should be the preferred method to access to the library. They allow to access to multiple ephemeris files at the same time, even  by multiple threads.</p>
<p>When an error occurs, these functions execute error handlers according to the behavior defined by the function <a class="reference internal" href="calceph.error.html#f/_/f90calceph_seterrorhandler" title="f/_/f90calceph_seterrorhandler"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_seterrorhandler()</span></code></a>.</p>
<section id="time-notes">
<h2>Time notes<a class="headerlink" href="#time-notes" title="Permalink to this heading"></a></h2>
<p>The functions <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>, <a class="reference internal" href="#f/_/f90calceph_compute_unit" title="f/_/f90calceph_compute_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute_unit()</span></code></a>,  <a class="reference internal" href="#f/_/f90calceph_compute_order" title="f/_/f90calceph_compute_order"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute_order()</span></code></a>, <a class="reference internal" href="#f/_/f90calceph_orient_unit" title="f/_/f90calceph_orient_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_orient_unit()</span></code></a>, ...  only accept a date expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>. Ephemeris files are generally expressed using the timescale TDB.
If a date, expressed in the TT (Terrestrial Time) timescale, is supplied to them, these functions will return an erroneous position of the order of several tens of meters for the planets.
If a date, expressed in the Coordinated Universal Time (UTC), is supplied to them, these functions  will return a very large erroneous position over several thousand kilometers for the planets.</p>
</section>
<section id="thread-notes">
<h2>Thread notes<a class="headerlink" href="#thread-notes" title="Permalink to this heading"></a></h2>
<p>If the standard I/O functions such as <strong>fread</strong> are not reentrant
then the CALCEPH I/O functions using them will not be reentrant either.</p>
<p>It's safe for two threads to call the functions with the same handle of ephemeris object if and only if the function <a class="reference internal" href="#f/_/f90calceph_isthreadsafe" title="f/_/f90calceph_isthreadsafe"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_isthreadsafe()</span></code></a> returns a non-zero value.  A previous call to the function <a class="reference internal" href="#f/_/f90calceph_prefetch" title="f/_/f90calceph_prefetch"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_prefetch()</span></code></a> is required for the function <a class="reference internal" href="#f/_/f90calceph_isthreadsafe" title="f/_/f90calceph_isthreadsafe"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_isthreadsafe()</span></code></a> to return a non-zero value.</p>
<p>It's safe for two threads to access simultaneously to the same ephemeris file with two different objects. In this case, each thread must open the same file.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h2>
<p>The following examples, that can be found in the directory <em>examples</em> of the library sources, show the typical usage of this group of functions.</p>
<p>The example in Fortran 77/90/95 language is <code class="file docutils literal notranslate"><span class="pre">f77multiple.f</span></code>.</p>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h2>
<section id="menu-calceph-open">
<h3>f90calceph_open<a class="headerlink" href="#menu-calceph-open" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_open">
<em class="property"><span class="pre">function</span> </em><span class="sig-name descname"><span class="pre">f90calceph_open</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_open" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong><em> [</em><em>CHARACTER(len=*), intent(in)</em><em>]</em> :: pathname of the file.</p></li>
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(out)</em><em>]</em> :: ephemeris descriptor</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_open</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function opens the file whose pathname is the string pointed to by filename, reads the two header blocks of this file
and returns an ephemeris descriptor associated to it.
This file must be compliant to the format specified by the 'original JPL binary' , 'INPOP 2.0 binary' or 'SPICE' ephemeris file.
At the moment, supported SPICE files are the following :</p>
<blockquote>
<div><ul class="simple">
<li><p>text Planetary Constants Kernel (KPL/PCK) files</p></li>
<li><p>binary PCK  (DAF/PCK) files.</p></li>
<li><p>binary SPK (DAF/SPK) files containing segments of type 1, 2, 3, 5, 8, 9, 12, 13, 14, 17, 18, 20, 21, 102, 103 and 120.</p></li>
<li><p>meta kernel (KPL/MK) files.</p></li>
<li><p>frame kernel (KPL/FK) files. Only a basic support is provided.</p></li>
</ul>
</div></blockquote>
<p>Just after the call of <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>, the function <a class="reference internal" href="#f/_/f90calceph_prefetch" title="f/_/f90calceph_prefetch"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_prefetch()</span></code></a> should be called to accelerate future computations.</p>
<p>The function <a class="reference internal" href="#f/_/f90calceph_close" title="f/_/f90calceph_close"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_close()</span></code></a> must be called to free allocated memory by this function.</p>
<p>The following example opens the ephemeris file example1.dat</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">include</span><span class="w"> </span><span class="s1">&#39;f90calceph.h&#39;</span>
<span class="kt">integer </span><span class="n">res</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">     </span><span class="c">! ... computation ...</span>

<span class="k">endif</span>
<span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-open-array">
<h3>f90calceph_open_array<a class="headerlink" href="#menu-calceph-open-array" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_open_array">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_open_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">n</span></em>, <em class="sig-param"><span class="pre">array_filename</span></em>, <em class="sig-param"><span class="pre">len_filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_open_array" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(out)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>n</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: number of files.</p></li>
<li><p><strong>array_filename</strong><em> [</em><em>CHARACTER(len=*), dimension(*), intent(in)</em><em>]</em> :: array of pathname of the files</p></li>
<li><p><strong>len_filename</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: number of characters of each file's name.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_open_array</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function opens n files whose pathnames are the string pointed to by array_filename,
reads the header blocks of these files
and returns an ephemeris descriptor associated to them.</p>
<p>These files must have the same type (e.g., all files are SPICE files or original JPL files).
This file must be compliant to the format specified by the  'original JPL binary' , 'INPOP 2.0 or 3.0 binary' or 'SPICE' ephemeris file.
At the moment, supported SPICE files are the following :</p>
<blockquote>
<div><ul class="simple">
<li><p>text Planetary Constants Kernel (KPL/PCK) files</p></li>
<li><p>binary PCK  (DAF/PCK) files.</p></li>
<li><p>binary SPK (DAF/SPK) files containing segments of type 1, 2, 3, 5, 8, 9, 12, 13, 14, 17, 18, 20, 21, 102, 103 and 120.</p></li>
<li><p>meta kernel (KPL/MK) files.</p></li>
<li><p>frame kernel (KPL/FK) files. Only a basic support is provided.</p></li>
</ul>
</div></blockquote>
<p>Just after the call of <a class="reference internal" href="#f/_/f90calceph_open_array" title="f/_/f90calceph_open_array"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open_array()</span></code></a>, the function <a class="reference internal" href="#f/_/f90calceph_prefetch" title="f/_/f90calceph_prefetch"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_prefetch()</span></code></a> should be called to accelerate future computations.</p>
<p>The function <a class="reference internal" href="#f/_/f90calceph_close" title="f/_/f90calceph_close"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_close()</span></code></a> must be called to free allocated memory by this function.</p>
<p>The following example opens the ephemeris file example1.bsp and example1.tpc</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">character</span><span class="o">*</span><span class="mi">80</span><span class="w"> </span><span class="n">filear</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">filear</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;example1.bsp&quot;</span>
<span class="n">filear</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;example1.tpc&quot;</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open_array</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">filear</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">   </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_prefetch</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">   </span><span class="c">!  ...  computation ...</span>
<span class="w">   </span><span class="k">call </span><span class="n">calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-prefetch">
<h3>f90calceph_prefetch<a class="headerlink" href="#menu-calceph-prefetch" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_prefetch">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_prefetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_prefetch" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_prefetch</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function prefetches to the main memory all files associated to the ephemeris descriptor <em>eph</em>.
This prefetching operation will accelerate the further computations performed with <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>, <a class="reference internal" href="#f/_/f90calceph_compute_unit" title="f/_/f90calceph_compute_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute_unit()</span></code></a>,  <a class="reference internal" href="#f/_/f90calceph_compute_order" title="f/_/f90calceph_compute_order"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute_order()</span></code></a>, <a class="reference internal" href="#f/_/f90calceph_orient_unit" title="f/_/f90calceph_orient_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_orient_unit()</span></code></a>, ... .</p>
<p>It requires that the file is smaller than the main memory.
If multiple threads (e.g. threads of openMP or Posix Pthreads) prefetch the data for the same ephemeris file,
the used memory will remain the same as if the prefetch operation was done by a single thread if and if the
endianess of the file is the same as the computer and if the operating system, such as Linux, MacOS X other unix, supports the function mmap.</p>
</section>
<section id="menu-calceph-isthreadsafe">
<h3>f90calceph_isthreadsafe<a class="headerlink" href="#menu-calceph-isthreadsafe" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_isthreadsafe">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_isthreadsafe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_isthreadsafe" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_isthreadsafe</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 1 if multiple threads can access the same ephemeris ephemeris descriptor, otherwise 0.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns 1 if multiple threads can access the same ephemeris ephemeris descriptor, otherwise 0.</p>
<p>A previous call to the function <a class="reference internal" href="#f/_/f90calceph_prefetch" title="f/_/f90calceph_prefetch"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_prefetch()</span></code></a> is required, and the library should be compiled with <strong>--enable-thread=yes</strong> on Unix-like operating system,  for the function <a class="reference internal" href="#f/_/f90calceph_isthreadsafe" title="f/_/f90calceph_isthreadsafe"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_isthreadsafe()</span></code></a> to return a non-zero value. If the file is not encoded with the same endian as the current hardware, then function may return 0.</p>
<p>If this function returns 1, severals threads may use the same ephemeris descriptor for the computational functions <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>, .... It allows to use the same object for parallel loops.</p>
</section>
<section id="menu-calceph-compute">
<h3>f90calceph_compute<a class="headerlink" href="#menu-calceph-compute" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_compute">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">JD0</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">center</span></em>, <em class="sig-param"><span class="pre">PV</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_compute" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>JD0</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Integer part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>time</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Fraction part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The body or reference point whose coordinates are required (see the list, below).</p></li>
<li><p><strong>center</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The origin of the coordinate system (see the list, below). If <em>target</em> is 14, 15, 16 or 17 (nutation, libration, TT-TDB or TCG-TCB), <em>center</em> must be <em>0</em>.</p></li>
<li><p><strong>PV</strong> (6) [REAL(8), intent(out) :: Depending on the target value, an array to receive the cartesian position (x,y,z) and the velocity (xdot, ydot, zdot), or a time scale transformation value, or the angles of the librations of the Moon and their derivatives, or the nutation angles and their derivatives.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_compute</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function reads, if needed, in the ephemeris file associated to <em>eph</em> and interpolates a single object, usually the position and velocity of one body (<em>target</em>) relative to another (<em>center</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file associated to <em>eph</em> must have been previously opened with the function <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>.</p>
<p>The returned array <em>PV</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If the target is <em>TT-TDB</em>, only the first element of this array will get the result. The time scale transformation TT-TDB is expressed in seconds.</p></li>
<li><p>If the target is <em>TCG-TCB</em>, only the first element of this array will get the result. The time scale transformation TCG-TCB is expressed in seconds.</p></li>
<li><p>If the target is <em>Librations</em>, the array contains the angles of the librations of the Moon and their derivatives. The angles of the librations of the Moon are expressed in radians and their derivatives are expressed in radians per day.</p></li>
<li><p>If the target is <em>Nutations</em>, the array contains the nutation angles and their derivatives. The nutation angles are expressed in radians and their derivatives are expressed in radians per day.</p></li>
<li><p>Otherwise the returned values is the cartesian position (x,y,z), expressed in Astronomical Unit (au), and the velocity (xdot, ydot, zdot), expressed in Astronomical Unit per day (au/day).</p></li>
</ul>
</div></blockquote>
<p>The date (JD0, time) should be expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>. To get the best numerical precision for the interpolation, the time is splitted in two floating-point numbers. The argument <em>JD0</em> should be an integer and <em>time</em> should be a fraction of the day. But you may call this function with <em>time=0</em> and <em>JD0</em>, the desired time, if you don't take care about numerical precision.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If a date, expressed in the Coordinated Universal Time (UTC), is supplied to this function, a very large erroneous position will be returned.</p>
</div>
<p>The possible values for <em>target</em> and <em>center</em> are  :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Mercury Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Venus Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Earth</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Mars Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Jupiter Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Saturn Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Uranus Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Neptune Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Pluto Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>Moon</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>Sun</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Solar Sytem barycenter</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>Earth-moon barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>Nutation angles</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>Librations</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>TT-TDB</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>TCG-TCB</p></td>
</tr>
<tr class="row-odd"><td><p>asteroid number + CALCEPH_ASTEROID</p></td>
<td><p>asteroid</p></td>
</tr>
</tbody>
</table>
<p>These accepted values by this function are the same as the value for the JPL function <em>PLEPH</em>, except for the values <em>TT-TDB</em>, <em>TCG-TCB</em> and asteroids.</p>
<p>For example, the value &quot;CALCEPH_ASTEROID+4&quot; for target or center specifies the asteroid Vesta.</p>
<p>The following example prints the heliocentric coordinates of Mars at time=2442457.5 and at 2442457.9</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">jd0</span>
<span class="kt">double precision </span><span class="n">dt1</span><span class="p">,</span><span class="w"> </span><span class="n">dt2</span>
<span class="kt">double precision </span><span class="n">PV</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">jd0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2442457</span>
<span class="n">dt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D0</span>
<span class="n">dt2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9D0</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_compute</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">PV</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">PV</span>

<span class="w">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_compute</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">PV</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">PV</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-compute-unit">
<h3>f90calceph_compute_unit<a class="headerlink" href="#menu-calceph-compute-unit" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_compute_unit">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_compute_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">JD0</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">center</span></em>, <em class="sig-param"><span class="pre">unit</span></em>, <em class="sig-param"><span class="pre">PV</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_compute_unit" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>JD0</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Integer part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>time</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Fraction part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The body or reference point whose coordinates are required. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>center</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The origin of the coordinate system. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>.</div>
<div class="line">If the unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the NAIF identification numbering system is used for the target and the center (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit doesnot contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the old number system is used for the target and the center (see the list in the function <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>PV</strong> (6) [REAL(8), intent(out) :: Depending on the target value, an array to receive the cartesian position (x,y,z) and the velocity (xdot, ydot, zdot), or a time scale transformation value, or the angles of the librations of the Moon and their derivatives, or the nutation angles and their derivatives.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_compute_unit</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function is similar to the function <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>, except that the units of the output are specified.</p>
<p>This function reads, if needed, in the ephemeris file associated to <em>eph</em> and interpolates a single object, usually the position and velocity of one body (<em>target</em>) relative to another (<em>center</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file associated to <em>eph</em> must have been previously opened with the function <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The date (JD0, time) should be expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If a date, expressed in the Coordinated Universal Time (UTC), is supplied to this function, a very large erroneous position will be returned.</p>
</div>
<p>The returned array <em>PV</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If the target is the time scale transformation TT-TDB, only the first element of this array will get the result.</p></li>
<li><p>If the target is the time scale transformation  <em>TCG-TCB</em>, only the first element of this array will get the result.</p></li>
<li><p>If the target is <em>Librations</em>, the array contains the angles of the librations of the Moon  and their derivatives.</p></li>
<li><p>If the target is <em>Nutations</em>, the array contains the nutation angles and their derivatives.</p></li>
<li><p>Otherwise the returned value is the cartesian position (x,y,z) and the velocity (xdot, ydot, zdot).</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PV</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The position and velocity are expressed in Astronomical Unit (au) if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_AU" title="f/_/CALCEPH_UNIT_AU"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_AU</span></code></a>.</p></li>
<li><p>The position and velocity are expressed in kilometers if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_KM" title="f/_/CALCEPH_UNIT_KM"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_KM</span></code></a>.</p></li>
<li><p>The velocity, TT-TDB, TCG-TCB, the derivatives of the angles of the nutation, or the derivatives of the librations of the Moon or are expressed in days if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_DAY" title="f/_/CALCEPH_UNIT_DAY"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_DAY</span></code></a>.</p></li>
<li><p>The velocity, TT-TDB, TCG-TCB, the derivatives of the angles of the nutation, or the derivatives of the librations of the Moon are expressed in seconds if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p></li>
<li><p>The angles of the librations of the Moon or the nutation angles are expressed in radians if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_RAD" title="f/_/CALCEPH_UNIT_RAD"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_RAD</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>For example, to get the position and velocities expressed in kilometers and kilometers/seconds, the unit must be set to <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_KM" title="f/_/CALCEPH_UNIT_KM"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_KM</span></code></a> + <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p>
<p>The following example prints the heliocentric coordinates of Mars  at time=2442457.5</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">jd0</span>
<span class="kt">double precision </span><span class="n">dt1</span>
<span class="kt">double precision </span><span class="n">PV</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">jd0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2442457</span>
<span class="n">dt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D0</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">  </span><span class="c">! the heliocentric coordinates of Mars  in km and km/s</span>
<span class="w">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_compute_unit</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                               </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_KM</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                               </span><span class="n">PV</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">PV</span>

<span class="w">  </span><span class="c">! compute same quantity as the previous call using NAIF ID</span>
<span class="w">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_compute_unit</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                               </span><span class="n">NAIFID_MARS_BARYCENTER</span><span class="p">,</span><span class="w"> </span><span class="n">NAIFID_SUN</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                               </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_KM</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                               </span><span class="n">PV</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">PV</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-orient-unit">
<h3>f90calceph_orient_unit<a class="headerlink" href="#menu-calceph-orient-unit" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_orient_unit">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_orient_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">JD0</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">unit</span></em>, <em class="sig-param"><span class="pre">PV</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_orient_unit" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>JD0</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Integer part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>time</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Fraction part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>.</div>
<div class="line">If the unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>PV</strong> (6) [REAL(8), intent(out) :: An array to receive the euler angles, or nutation angles, and their derivatives for the orientation of the body.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_orient_unit</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function reads, if needed, in the ephemeris file associated to <em>eph</em> and interpolates the orientation of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file associated to <em>eph</em> must have been previously opened with the function <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p>The date (JD0, time) should be expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The returned array <em>PV</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If <em>unit</em> contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_OUTPUT_NUTATIONANGLES" title="f/_/CALCEPH_OUTPUT_NUTATIONANGLES"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_OUTPUT_NUTATIONANGLES</span></code></a>,  the array contains the nutation angles and their derivatives for the orientation of the body. At the present moment, only the nutation for the earth are supported in the original DE files.</p></li>
<li><p>If <em>unit</em> contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_OUTPUT_EULERANGLES" title="f/_/CALCEPH_OUTPUT_EULERANGLES"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_OUTPUT_EULERANGLES</span></code></a>, or doesnot contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_OUTPUT_NUTATIONANGLES" title="f/_/CALCEPH_OUTPUT_NUTATIONANGLES"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_OUTPUT_NUTATIONANGLES</span></code></a>, the array contains the euler angles and their derivatives for the orientation of the body.</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PV</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The derivatives of the angles are expressed in days if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_DAY" title="f/_/CALCEPH_UNIT_DAY"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_DAY</span></code></a>.</p></li>
<li><p>The derivatives of the angles are expressed in seconds if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p></li>
<li><p>The angles and their derivatives are expressed in radians if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_RAD" title="f/_/CALCEPH_UNIT_RAD"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_RAD</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>For example, to get the nutation angles of the Earth and their derivatives expressed in radian and radian/seconds using the NAIF identification numbering system, the target must be set to NAIFID_EARTH and the unit must be set to <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_OUTPUT_NUTATIONANGLES" title="f/_/CALCEPH_OUTPUT_NUTATIONANGLES"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_OUTPUT_NUTATIONANGLES</span></code></a> + <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_RAD" title="f/_/CALCEPH_UNIT_RAD"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_RAD</span></code></a> + <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p>
<p>The following example prints the angles of libration of the Moon at time=2442457.5</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">jd0</span>
<span class="kt">double precision </span><span class="n">dt1</span>
<span class="kt">double precision </span><span class="n">PV</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">jd0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2442457</span>
<span class="n">dt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D0</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_orient_unit</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span><span class="w"> </span><span class="n">NAIFID_MOON</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_RAD</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="n">PV</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">PV</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-rotangmom-unit">
<h3>f90calceph_rotangmom_unit<a class="headerlink" href="#menu-calceph-rotangmom-unit" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_rotangmom_unit">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_rotangmom_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">JD0</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">unit</span></em>, <em class="sig-param"><span class="pre">PV</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_rotangmom_unit" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>JD0</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Integer part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>time</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Fraction part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>.</div>
<div class="line">If the unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>PV</strong> (6) [REAL(8), intent(out) :: An array to receive the angular momentum due to its rotation, divided by the product of the mass and of the square of the radius, and the derivatives, of the body.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_rotangmom_unit</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function reads, if needed, in the ephemeris file associated to <em>eph</em> and interpolates the angular momentum vector due to the rotation of the body, divided by the product of the mass <img class="math" src="_images/math/e9bc7da808d33a16a8347f27a519bd067186aa66.png" alt="m"/> and of the square of the radius <img class="math" src="_images/math/1ebe654cc7b8f2a0d8100aa5825cf2b9021adbbc.png" alt="R"/>, of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file associated to <em>eph</em> must have been previously opened with the function <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>. The angular momentum <img class="math" src="_images/math/19eef1966f7c545af3ac8c0fa486974d873e3c65.png" alt="L"/> , due to the rotation of the body, is defined as the product of the inertia matrix <img class="math" src="_images/math/015755a22b6219b345c36a9a47b091dc56007486.png" alt="I"/> by the angular velocity vector <img class="math" src="_images/math/50933ea18d380a4a0a04d410f57212d1bc68e583.png" alt="{\omega}"/>. So the returned value is <img class="math" src="_images/math/24b9ed6eb21d19417c11c253db92cbb9cd09cf83.png" alt="L/(mR^2)=(I\omega)/(mR^2)"/></p>
<p>The date (JD0, time) should be expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>The output values are expressed in the units specified by <em>unit</em>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The values stored in the  array <em>PV</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The angular momentum and its derivative are expressed in days if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_DAY" title="f/_/CALCEPH_UNIT_DAY"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_DAY</span></code></a>.</p></li>
<li><p>The angular momentum and its derivative are expressed in seconds if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>The following example prints the angular momentum, due to its rotation, for the Earth at time=2451419.5</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">jd0</span>
<span class="kt">double precision </span><span class="n">dt1</span>
<span class="kt">double precision </span><span class="n">G</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">jd0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2451419</span>
<span class="n">dt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D0</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example2_rotangmom.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_rotangmom_unit</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span><span class="w"> </span><span class="n">NAIFID_EARTH</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="n">G</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">G</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-compute-order">
<h3>f90calceph_compute_order<a class="headerlink" href="#menu-calceph-compute-order" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_compute_order">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_compute_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">JD0</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">center</span></em>, <em class="sig-param"><span class="pre">unit</span></em>, <em class="sig-param"><span class="pre">order</span></em>, <em class="sig-param"><span class="pre">PVAJ</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_compute_order" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>JD0</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Integer part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>time</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Fraction part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The body or reference point whose coordinates are required. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>center</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The origin of the coordinate system. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <div class="line-block">
<div class="line">The units of PVAJ.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>.</div>
<div class="line">If the unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the NAIF identification numbering system is used for the target and the center (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit doesnot contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the old number system is used for the target and the center (see the list in the function <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>order</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <p>The order of derivatives</p>
<blockquote>
<div><ul>
<li><p>= 0 , only the position is computed. The first three numbers of PVAJ are valid for the results.</p></li>
<li><p>= 1 , only the position and velocity are computed. The first six numbers of PVAJ are valid for the results.</p></li>
<li><p>= 2 , only the position, velocity and acceleration are computed. The first nine numbers of PVAJ are valid for the results.</p></li>
<li><p>= 3 , the position, velocity and acceleration and jerk are computed. The first twelve numbers of PVAJ are valid for the results.</p></li>
</ul>
</div></blockquote>
<p>If order equals to 1, the behavior of <a class="reference internal" href="#f/_/f90calceph_compute_order" title="f/_/f90calceph_compute_order"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute_order()</span></code></a> is the same as <a class="reference internal" href="#f/_/f90calceph_compute_unit" title="f/_/f90calceph_compute_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute_unit()</span></code></a>.</p>
</p></li>
<li><p><strong>PVAJ</strong> (12) [REAL(8), intent(out) :: Depending on the target value, an array to receive the cartesian position (x,y,z), the velocity (xdot, ydot, zdot), the acceleration and the jerk, or a time scale transformation value, or the angles of the librations of the Moon and their successive derivatives, or the nutation angles and their successive derivatives.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_compute_order</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function is similar to the function <a class="reference internal" href="#f/_/f90calceph_compute_unit" title="f/_/f90calceph_compute_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute_unit()</span></code></a>, except that the order of the computed derivatives is specified.</p>
<p>This function reads, if needed, in the ephemeris file associated to <em>eph</em> and interpolates a single object, usually the position and their derivatives of one body (<em>target</em>) relative to another (<em>center</em>) for the time <em>JD0+time</em> and stores the results to <em>PVAJ</em>. The ephemeris file associated to <em>eph</em> must have been previously opened with the function <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>.
The order of the derivatives are specified by <em>order</em>. The output values are expressed in the units specified by <em>unit</em>.</p>
<p>The returned array <em>PVAJ</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If the target is the time scale transformation TT-TDB, only the first elements of each component will get the result.</p></li>
<li><p>If the target is the time scale transformation  <em>TCG-TCB</em>, only the first elements of each component will get the result.</p></li>
<li><p>If the target is <em>Librations</em>, the array contains the angles of the librations of the Moon  and their successive derivatives.</p></li>
<li><p>If the target is <em>Nutations</em>, the array contains the nutation angles and their successive derivatives.</p></li>
<li><p>Otherwise the returned value is the cartesian position (x,y,z), the velocity (xdot, ydot, zdot), the jerk and the acceleration.</p></li>
</ul>
</div></blockquote>
<p>The returned array <em>PVAJ</em> must be large enough to store the results.</p>
<blockquote>
<div><ul class="simple">
<li><p>PVAJ[1:3] contain the position (x,y,z) and is always valid.</p></li>
<li><p>PVAJ[4:6] contain the velocity  (dx/dt,dy/dt,dz/dt) and is only valid if <em>order</em> is greater or equal to 1.</p></li>
<li><p>PVAJ[7:9] contain the acceleration (d^2x/dt^2,d^2y/dt^2,d^2z/dt^2) and is only valid if <em>order</em> is greater or equal to 2.</p></li>
<li><p>PVAJ[10:12] contain the jerk (d^3x/dt^3,d^3y/dt^3,d^3z/dt^3) and is only valid if <em>order</em> is equal to 3.</p></li>
</ul>
</div></blockquote>
<p>The date (JD0, time) should be expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If a date, expressed in the Coordinated Universal Time (UTC), is supplied to this function, a very large erroneous position will be returned.</p>
</div>
<p>The values stored in the  array <em>PVAJ</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The position, velocity, acceleration and jerk are expressed in Astronomical Unit (au) if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_AU" title="f/_/CALCEPH_UNIT_AU"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_AU</span></code></a>.</p></li>
<li><p>The position, velocity, acceleration and jerk are expressed in kilometers if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_KM" title="f/_/CALCEPH_UNIT_KM"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_KM</span></code></a>.</p></li>
<li><p>The velocity, acceleration, jerk, TT-TDB, TCG-TCB or the derivatives of the angles of the librations of the Moon are expressed in days if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_DAY" title="f/_/CALCEPH_UNIT_DAY"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_DAY</span></code></a>.</p></li>
<li><p>The velocity, acceleration, jerk, TT-TDB, TCG-TCB or the derivatives of the angles of the librations of the Moon are expressed in seconds if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p></li>
<li><p>The angles of the librations of the Moon are expressed in radians if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_RAD" title="f/_/CALCEPH_UNIT_RAD"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_RAD</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>For example, to get the positions, velocities, accelerations and jerks expressed in kilometers and kilometers/seconds, the unit must be set to <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_KM" title="f/_/CALCEPH_UNIT_KM"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_KM</span></code></a> + <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The following example prints the heliocentric coordinates of Mars at time=2442457.5</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">jd0</span>
<span class="kt">double precision </span><span class="n">dt1</span>
<span class="kt">double precision </span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">PVAJ</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="n">jd0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2442457</span>
<span class="n">dt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D0</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">  </span><span class="c">! compute only the heliocentric position of Mars in km</span>
<span class="w">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_compute_order</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="n">NAIFID_MARS_BARYCENTER</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="n">NAIFID_SUN</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_KM</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">);</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">P</span>

<span class="w">  </span><span class="c">! compute positions, velocities, accelerations and jerks of Mars in km and seconds</span>
<span class="w">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_compute_order</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="n">NAIFID_MARS_BARYCENTER</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="n">NAIFID_SUN</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_KM</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                     </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">PVAJ</span><span class="p">);</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">PVAJ</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-orient-order">
<h3>f90calceph_orient_order<a class="headerlink" href="#menu-calceph-orient-order" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_orient_order">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_orient_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">JD0</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">unit</span></em>, <em class="sig-param"><span class="pre">order</span></em>, <em class="sig-param"><span class="pre">PVAJ</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_orient_order" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>JD0</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Integer part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>time</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Fraction part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>.</div>
<div class="line">If the unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>order</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <p>The order of derivatives.</p>
<blockquote>
<div><ul>
<li><p>= 0 , only the angles is computed. The first three numbers of PVAJ are valid for the results.</p></li>
<li><p>= 1 , only the angles and the first derivative are computed. The first six numbers of PVAJ are valid for the results.</p></li>
<li><p>= 2 , only the angles and the first and second derivatives are computed. The first nine numbers of PVAJ are valid for the results.</p></li>
<li><p>= 3 , the angles and the first, second and third derivatives  are computed. The first twelve numbers of PVAJ are valid for the results.</p></li>
</ul>
</div></blockquote>
<p>If order equals to 1, the behavior of <a class="reference internal" href="#f/_/f90calceph_orient_order" title="f/_/f90calceph_orient_order"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_orient_order()</span></code></a> is the same as <a class="reference internal" href="#f/_/f90calceph_orient_unit" title="f/_/f90calceph_orient_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_orient_unit()</span></code></a>.</p>
</p></li>
<li><p><strong>PVAJ</strong> (12) [REAL(8), intent(out) :: An array to receive the euler angles, or nutation angles, and their derivatives for the orientation of the body.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_orient_order</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function is similar to the function <a class="reference internal" href="#f/_/f90calceph_orient_unit" title="f/_/f90calceph_orient_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_orient_unit()</span></code></a>, except that the order of the computed derivatives is specified.</p>
<p>This function reads, if needed, in the ephemeris file associated to <em>eph</em> and interpolates the orientation of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PVAJ</em>.
The order of the derivatives are specified by <em>order</em>. The ephemeris file associated to <em>eph</em> must have been previously opened with the function <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The returned array <em>PVAJ</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If <em>unit</em> contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_OUTPUT_NUTATIONANGLES" title="f/_/CALCEPH_OUTPUT_NUTATIONANGLES"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_OUTPUT_NUTATIONANGLES</span></code></a>, the array contains the nutation angles and their successive derivatives for the orientation of the body. At the present moment, only the nutation for the earth are supported in the original DE files.</p></li>
<li><p>If <em>unit</em> contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_OUTPUT_EULERANGLES" title="f/_/CALCEPH_OUTPUT_EULERANGLES"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_OUTPUT_EULERANGLES</span></code></a>, or doesnot contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_OUTPUT_NUTATIONANGLES" title="f/_/CALCEPH_OUTPUT_NUTATIONANGLES"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_OUTPUT_NUTATIONANGLES</span></code></a>, the array contains the euler angles and their successive derivatives for the orientation of the body.</p></li>
</ul>
</div></blockquote>
<p>The returned array <em>PVAJ</em> must be large enough to store the results.</p>
<blockquote>
<div><ul class="simple">
<li><p>PVAJ[1:3] contain the angles  and is always valid.</p></li>
<li><p>PVAJ[4:6] contain the first derivative and is only valid if <em>order</em> is greater or equal to 1.</p></li>
<li><p>PVAJ[7:9] contain the second derivative and is only valid if <em>order</em> is greater or equal to 2.</p></li>
<li><p>PVAJ[10:12]  contain the third derivative and is only valid if <em>order</em> is equal to 3.</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PVAJ</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The derivatives of the angles are expressed in days if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_DAY" title="f/_/CALCEPH_UNIT_DAY"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_DAY</span></code></a>.</p></li>
<li><p>The derivatives of the angles are expressed in seconds if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p></li>
<li><p>The angles and their derivatives are expressed in radians if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_RAD" title="f/_/CALCEPH_UNIT_RAD"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_RAD</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>The date (JD0, time) should be expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>The following example prints only the angles of libration of the Moon at time=2442457.5</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">jd0</span>
<span class="kt">double precision </span><span class="n">dt1</span>
<span class="kt">double precision </span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">jd0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2442457</span>
<span class="n">dt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D0</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_orient_order</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span><span class="w"> </span><span class="n">NAIFID_MOON</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_RAD</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">P</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-rotangmom-order">
<h3>f90calceph_rotangmom_order<a class="headerlink" href="#menu-calceph-rotangmom-order" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_rotangmom_order">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_rotangmom_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">JD0</span></em>, <em class="sig-param"><span class="pre">time</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">unit</span></em>, <em class="sig-param"><span class="pre">order</span></em>, <em class="sig-param"><span class="pre">PVAJ</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_rotangmom_order" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>JD0</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Integer part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>time</strong><em> [</em><em>REAL(8), intent(in)</em><em>]</em> :: Fraction part of the Julian date (TDB or TCB)</p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>.</div>
<div class="line">If the unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_USE_NAIFID" title="f/_/CALCEPH_USE_NAIFID"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_USE_NAIFID</span></code></a>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#f/_/f90calceph_compute" title="f/_/f90calceph_compute"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>order</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: <p>The order of derivatives.</p>
<blockquote>
<div><ul>
<li><p>= 0 , only the angular momentum is computed. The first three numbers of PVAJ are valid for the results.</p></li>
<li><p>= 1 , only the angular momentum and the first derivative are computed. The first six numbers of PVAJ are valid for the results.</p></li>
<li><p>= 2 , only the angular momentum and the first and second derivatives are computed. The first nine numbers of PVAJ are valid for the results.</p></li>
<li><p>= 3 , the angular momentum and the first, second and third derivatives  are computed. The first twelve numbers of PVAJ are valid for the results.</p></li>
</ul>
</div></blockquote>
<p>If order equals to 1, the behavior of <a class="reference internal" href="#f/_/f90calceph_rotangmom_order" title="f/_/f90calceph_rotangmom_order"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_rotangmom_order()</span></code></a> is the same as <a class="reference internal" href="#f/_/f90calceph_rotangmom_unit" title="f/_/f90calceph_rotangmom_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_rotangmom_unit()</span></code></a>.</p>
</p></li>
<li><p><strong>PVAJ</strong> (12) [REAL(8), intent(out) :: An array to receive the angular momentum due to its rotation, divided by the product of the mass and of the square of the radius, and their different order of the derivatives, of the body.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_rotangmom_order</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function is similar to the function <a class="reference internal" href="#f/_/f90calceph_orient_unit" title="f/_/f90calceph_orient_unit"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_orient_unit()</span></code></a>, except that the order of the computed derivatives is specified.</p>
<p>This function reads, if needed, in the ephemeris file associated to <em>eph</em> and interpolates the angular momentum vector due to the rotation of the body, divided by the product of the mass <img class="math" src="_images/math/e9bc7da808d33a16a8347f27a519bd067186aa66.png" alt="m"/> and of the square of the radius <img class="math" src="_images/math/1ebe654cc7b8f2a0d8100aa5825cf2b9021adbbc.png" alt="R"/>, of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PVAJ</em>. The angular momentum <img class="math" src="_images/math/19eef1966f7c545af3ac8c0fa486974d873e3c65.png" alt="L"/> , due to the rotation of the body, is defined as the product of the inertia matrix <img class="math" src="_images/math/015755a22b6219b345c36a9a47b091dc56007486.png" alt="I"/> by the angular velocity vector <img class="math" src="_images/math/50933ea18d380a4a0a04d410f57212d1bc68e583.png" alt="{\omega}"/>. So the returned value is <img class="math" src="_images/math/24b9ed6eb21d19417c11c253db92cbb9cd09cf83.png" alt="L/(mR^2)=(I\omega)/(mR^2)"/>
The order of the derivatives are specified by <em>order</em>. The ephemeris file associated to <em>eph</em> must have been previously opened with the function <a class="reference internal" href="#f/_/f90calceph_open" title="f/_/f90calceph_open"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The returned array <em>PVAJ</em> must be large enough to store the results.</p>
<blockquote>
<div><ul class="simple">
<li><p>PVAJ[1:3] contain the angular momentum  and is always valid.</p></li>
<li><p>PVAJ[4:6] contain the first derivative and is only valid if <em>order</em> is greater or equal to 1.</p></li>
<li><p>PVAJ[7:9] contain the second derivative and is only valid if <em>order</em> is greater or equal to 2.</p></li>
<li><p>PVAJ[10:12] contain the third derivative and is only valid if <em>order</em> is equal to 3.</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PVAJ</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The angular momentum and its derivatives are expressed in days if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_DAY" title="f/_/CALCEPH_UNIT_DAY"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_DAY</span></code></a>.</p></li>
<li><p>The angular momentum and its derivatives are expressed in seconds if unit contains <a class="reference internal" href="calceph.interface.html#f/_/CALCEPH_UNIT_SEC" title="f/_/CALCEPH_UNIT_SEC"><code class="xref f f-var docutils literal notranslate"><span class="pre">CALCEPH_UNIT_SEC</span></code></a>.</p></li>
</ul>
</div></blockquote>
<p>The date (JD0, time) should be expressed in the same timescale as the ephemeris files, which can be retrieved using the function <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>The following example prints only the angular momentum, due to its rotation, of the Earth at time=2451419.5</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">jd0</span>
<span class="kt">double precision </span><span class="n">dt1</span>
<span class="kt">double precision </span><span class="n">G</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">jd0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2451419</span>
<span class="n">dt1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5D0</span>
<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example2_rotangmom.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_rotangmom_order</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">jd0</span><span class="p">,</span><span class="w"> </span><span class="n">dt1</span><span class="p">,</span><span class="w"> </span><span class="n">NAIFID_EARTH</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="n">CALCEPH_USE_NAIFID</span><span class="o">+</span><span class="n">CALCEPH_UNIT_SEC</span><span class="p">,</span>
<span class="p">&amp;</span><span class="w">                              </span><span class="n">G</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">G</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getconstant">
<h3>f90calceph_getconstant<a class="headerlink" href="#menu-calceph-getconstant" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getconstant">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getconstant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getconstant" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>name</strong><em> [</em><em>CHARACTER(len=*), intent(in)</em><em>]</em> :: name of the constant</p></li>
<li><p><strong>value</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: first value of the constant</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getconstant</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 0 if an error occurs, otherwise the number of values associated to the constant.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the value associated to the constant <em>name</em> in the header of the ephemeris file associated to <em>eph</em>. Only the first value is returned if multiple values are associated to a constant, such as a list of values.</p>
<p>This function is the same function as <a class="reference internal" href="#f/_/f90calceph_getconstantsd" title="f/_/f90calceph_getconstantsd"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getconstantsd()</span></code></a>.</p>
<p>The following example prints the value of the astronomical unit stored in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">AU</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span><span class="c">! print the value of AU</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f90calceph_getconstant</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;AU&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">AU</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;AU=&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">AU</span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getconstantsd">
<h3>f90calceph_getconstantsd<a class="headerlink" href="#menu-calceph-getconstantsd" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getconstantsd">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getconstantsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getconstantsd" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>name</strong><em> [</em><em>CHARACTER(len=*), intent(in)</em><em>]</em> :: name of the constant</p></li>
<li><p><strong>value</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: first value of the constant</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getconstantsd</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 0 if an error occurs, otherwise the number of values associated to the constant.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns, as a floating-point number, the value associated to the constant <em>name</em> in the header of the ephemeris file associated to <em>eph</em>. Only the first value is returned if multiple values are associated to a constant, such as a list of values. The value must be a floating-point or integer number, otherwise an error is reported.</p>
<p>This function is the same function as <a class="reference internal" href="#f/_/f90calceph_getconstant" title="f/_/f90calceph_getconstant"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getconstant()</span></code></a>.</p>
<p>The following example prints the value of the astronomical unit stored in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">AU</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span><span class="c">! print the value of AU</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f90calceph_getconstantsd</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;AU&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">AU</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;AU=&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">AU</span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getconstantvd">
<h3>f90calceph_getconstantvd<a class="headerlink" href="#menu-calceph-getconstantvd" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getconstantvd">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getconstantvd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">arrayvalue</span></em>, <em class="sig-param"><span class="pre">nvalue</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getconstantvd" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>name</strong><em> [</em><em>CHARACTER(len=*), intent(in)</em><em>]</em> :: name of the constant</p></li>
<li><p><strong>value</strong><em> [</em><em>REAL(8), dimension(1:nvalue), intent(inout)</em><em>]</em> :: array of values for the constant</p></li>
<li><p><strong>nvalue</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: number of elements of the array</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getconstantvd</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 0 if an error occurs, otherwise the number of values associated to the constant.</p>
</dd>
</dl>
</dd></dl>

<p>This function stores, to the array <em>arrayvalue</em> as floating-point numbers, the <em>nvalue</em> first values associated to the constant <em>name</em> in the header of the ephemeris file associated to <em>eph</em>. The integer value returned by the function is equal to the number of valid entries in the <em>arrayvalue</em> if <em>nvalue</em> is greater or equal to that integer value..</p>
<p>The required value <em>nvalue</em> to store all values can be determinated with the previous call to <em>f90calceph_getconstantsd</em>.</p>
<p>The values must be  floating-point or integer numbers, otherwise an error is reported.</p>
<p>The following example prints the body radii of the earth stored in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">nvalue</span>
<span class="kt">double precision</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">radii</span>
<span class="kt">double precision </span><span class="n">svalue</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">     </span><span class="c">! get the number of values</span>
<span class="w">     </span><span class="n">nvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calceph_getconstantsd</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;BODY399_RADII&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">svalue</span><span class="p">)</span>
<span class="w">     </span><span class="c">! fill the array</span>
<span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">radii</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvalue</span><span class="p">))</span>
<span class="w">     </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calceph_getconstantvd</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;BODY399_RADII&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">radii</span><span class="p">,</span><span class="w"> </span><span class="n">nvalue</span><span class="p">)</span>
<span class="w">     </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">radii</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getconstantss">
<h3>f90calceph_getconstantss<a class="headerlink" href="#menu-calceph-getconstantss" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getconstantss">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getconstantss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getconstantss" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>name</strong><em> [</em><em>CHARACTER(len=*), intent(in)</em><em>]</em> :: name of the constant</p></li>
<li><p><strong>value</strong><em> [</em><em>CHARACTER(len=CALCEPH_MAX_CONSTANTNAME), intent(out)</em><em>]</em> :: first value of the constant</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getconstantss</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 0 if an error occurs, otherwise the number of values associated to the constant.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns, as a string of character, the value associated to the constant <em>name</em> in the header of the ephemeris file associated to <em>eph</em>. Only the first value is returned if multiple values are associated to a constant, such as a list of values. The value must be a string, otherwise an error is reported.</p>
<p>Trailing blanks are added to each value.</p>
<p>The following example prints the value of the unit stored in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">CALCEPH_MAX_CONSTANTVALUE</span><span class="p">)</span><span class="w"> </span><span class="n">UNIT</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">   </span><span class="c">! print the value of UNIT</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">f90calceph_getconstantss</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;UNIT&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">UNIT</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;UNIT=&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">UNIT</span><span class="p">)</span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getconstantvs">
<h3>f90calceph_getconstantvs<a class="headerlink" href="#menu-calceph-getconstantvs" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getconstantvs">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getconstantvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">arrayvalue</span></em>, <em class="sig-param"><span class="pre">nvalue</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getconstantvs" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>name</strong><em> [</em><em>CHARACTER(len=*), intent(in)</em><em>]</em> :: name of the constant</p></li>
<li><p><strong>value</strong><em> [</em><em>CHARACTER(len=CALCEPH_MAX_CONSTANTNAME), dimension(1:nvalue), intent(inout)</em><em>]</em> :: array of values for the constant</p></li>
<li><p><strong>nvalue</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: number of elements of the array</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getconstantvs</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 0 if an error occurs, otherwise the number of values associated to the constant.</p>
</dd>
</dl>
</dd></dl>

<p>This function stores, to the array <em>arrayvalue</em> as strings of characters, the <em>nvalue</em> first values associated to the constant <em>name</em> in the header of the ephemeris file associated to <em>eph</em>. The integer value returned by the function is equal to the number of valid entries in the <em>arrayvalue</em> if <em>nvalue</em> is greater or equal to that integer value.</p>
<p>The required value <em>nvalue</em> to store all values can be determinated with the previous call to <em>f90calceph_getconstantss</em>.</p>
<p>The values must be strings, otherwise an error is reported.</p>
<p>Trailing blanks are added to each value.</p>
<p>The following example prints the units of the mission stored in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">nvalue</span>
<span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">CALCEPH_MAX_CONSTANTVALUE</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mission_units</span>
<span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">CALCEPH_MAX_CONSTANTVALUE</span><span class="p">)</span><span class="w"> </span><span class="n">svalue</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">     </span><span class="c">! get the number of values</span>
<span class="w">     </span><span class="n">nvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calceph_getconstantss</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MISSION_UNITS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">svalue</span><span class="p">)</span>
<span class="w">     </span><span class="c">! fill the array</span>
<span class="w">     </span><span class="k">allocate</span><span class="p">(</span><span class="n">mission_units</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nvalue</span><span class="p">))</span>
<span class="w">     </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calceph_getconstantvs</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MISSION_UNITS&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mission_units</span><span class="p">,</span><span class="w"> </span><span class="n">nvalue</span><span class="p">)</span>
<span class="w">     </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">mission_units</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getconstantcount">
<h3>f90calceph_getconstantcount<a class="headerlink" href="#menu-calceph-getconstantcount" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getconstantcount">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getconstantcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getconstantcount" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getconstantcount</strong><em> [</em><em>INTEGER</em><em>]</em> :: number of constants. 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the number of constants available in the header of the ephemeris file associated to <em>eph</em>.</p>
<p>The following example prints the number of available constants stored in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">integer </span><span class="n">n</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getconstantcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;number of constants&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getconstantindex">
<h3>f90calceph_getconstantindex<a class="headerlink" href="#menu-calceph-getconstantindex" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getconstantindex">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getconstantindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">index</span></em>, <em class="sig-param"><span class="pre">name</span></em>, <em class="sig-param"><span class="pre">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getconstantindex" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>index</strong><em> [</em><em>INTEGER, intent(in)</em><em>]</em> :: index of the constant, between 1 and <a class="reference internal" href="#f/_/f90calceph_getconstantcount" title="f/_/f90calceph_getconstantcount"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getconstantcount()</span></code></a></p></li>
<li><p><strong>name</strong><em> [</em><em>CHARACTER(len=CALCEPH_MAX_CONSTANTNAME), intent(out)</em><em>]</em> :: name of the constant</p></li>
<li><p><strong>value</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: first value of the constant</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getconstantindex</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 0 if an error occurs, otherwise the number of values associated to the constant.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the name and its value of the constant available at the specified index in the header of the ephemeris file associated to <em>eph</em>. The value of <em>index</em> must be between 1 and <a class="reference internal" href="#f/_/f90calceph_getconstantcount" title="f/_/f90calceph_getconstantcount"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getconstantcount()</span></code></a>.</p>
<p>Only the first value is returned if multiple values are associated to a constant, such as a list of values. If the first value is not an floating-point number, such as a string, then the function returns 0 without raising an error.</p>
<p>Trailing blanks are added to the name of the constant.</p>
<p>The following example displays the name of the constants, stored in the ephemeris file, and their values</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">integer </span><span class="n">n</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">f90calceph_getconstantcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">     </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getconstantindex</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">nameconstant</span><span class="p">,</span><span class="n">valueconstant</span><span class="p">)</span>
<span class="w">     </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">nameconstant</span><span class="p">,</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="n">valueconstant</span>
<span class="w">  </span><span class="k">enddo</span>
<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getfileversion">
<h3>f90calceph_getfileversion<a class="headerlink" href="#menu-calceph-getfileversion" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getfileversion">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getfileversion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">version</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getfileversion" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>version</strong><em> [</em><em>CHARACTER(len=CALCEPH_MAX_CONSTANTVALUE), intent(out)</em><em>]</em> :: version of the file</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getfileversion</strong><em> [</em><em>INTEGER</em><em>]</em> :: returns 0 if the file version was not found, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the version of the ephemeris file, as a string. For example, the argument version will contain 'INPOP10B', 'EPM2017' or 'DE405', ... .</p>
<p>If the file is an original JPL binary planetary ephemeris, then the version of the file can always be determined.
If the file is a spice kernel, the version of the file is retrieved from the constant <em>INPOP_PCK_VERSION</em>, <em>EPM_PCK_VERSION</em>, or <em>PCK_VERSION</em>.</p>
<p>The following example prints the version of the ephemeris file.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">CALCEPH_MAX_CONSTANTVALUE</span><span class="p">)</span><span class="w"> </span><span class="n">version</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">  </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getfileversion</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;The version of the file is &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-gettimescale">
<h3>f90calceph_gettimescale<a class="headerlink" href="#menu-calceph-gettimescale" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_gettimescale">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_gettimescale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_gettimescale" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_gettimescale</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<dl class="simple">
<dt>This function returns the timescale of the ephemeris file associated to <em>eph</em> :</dt><dd><ul class="simple">
<li><p>1 if the quantities of all bodies are expressed in the TDB time scale.</p></li>
<li><p>2 if the quantities of all bodies are expressed in the TCB time scale.</p></li>
</ul>
</dd>
</dl>
<p>The following example prints the time scale available in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">double precision </span><span class="n">AU</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">  </span><span class="c">! print the time scale</span>
<span class="w">  </span><span class="n">timescale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calceph_gettimescale</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;timescale=&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">timescale</span>

<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-gettimespan">
<h3>f90calceph_gettimespan<a class="headerlink" href="#menu-calceph-gettimespan" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_gettimespan">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_gettimespan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">firsttime</span></em>, <em class="sig-param"><span class="pre">lasttime</span></em>, <em class="sig-param"><span class="pre">continuous</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_gettimespan" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>firsttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the first time</p></li>
<li><p><strong>lasttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the last time</p></li>
<li><p><strong>continuous</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: information about the availability of the quantities over the time span</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_gettimespan</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the first and last time available in the ephemeris file associated to <em>eph</em>. The Julian date for the first and last time are expressed in the time scale returned by  <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>
.</p>
<p>It returns the following value in the parameter <em>continuous</em> :</p>
<blockquote>
<div><ul class="simple">
<li><p>1 if the quantities of all bodies are available for any time between the first and last time.</p></li>
<li><p>2 if the quantities of some bodies are available on discontinuous time intervals between the first and last time.</p></li>
<li><p>3 if the quantities of each body are available on a continuous time interval between the first and last time, but not available for any time between the first and last time.</p></li>
</ul>
</div></blockquote>
<p>The following example prints the first and last time available in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">integer </span><span class="n">continuous</span>
<span class="kt">double precision </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">   if</span><span class="w"> </span><span class="p">(</span><span class="n">f90calceph_gettimespan</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">continuous</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">countinuous</span>
<span class="w">    </span><span class="k">endif</span>

<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getpositionrecordcount">
<h3>f90calceph_getpositionrecordcount<a class="headerlink" href="#menu-calceph-getpositionrecordcount" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getpositionrecordcount">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getpositionrecordcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getpositionrecordcount" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getpositionrecordcount</strong><em> [</em><em>INTEGER</em><em>]</em> :: number of position's records. 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the number of position's records available in the ephemeris file associated to <em>eph</em>.
Usually, the number of records is equal to the number of bodies in the ephemeris file if the timespan is continuous.
If the timespan is discontinuous for the target and center bodies,
then each different timespan is counted as a different record.
If the ephemeris file contain timescale transformations' records, such as <em>TT-TDB</em> or <em>TCG-TCB</em>, then these records are included in the returned value.</p>
<p>The following example prints the number of position's records available in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">integer </span><span class="n">n</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getpositionrecordcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;number of position&#39;s record&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getpositionrecordindex">
<h3>f90calceph_getpositionrecordindex<a class="headerlink" href="#menu-calceph-getpositionrecordindex" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getpositionrecordindex">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getpositionrecordindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">index</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">center</span></em>, <em class="sig-param"><span class="pre">firsttime</span></em>, <em class="sig-param"><span class="pre">lasttime</span></em>, <em class="sig-param"><span class="pre">frame</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getpositionrecordindex" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>index</strong><em> [</em><em>INTEGER, intent(int)</em><em>]</em> :: index of the position's record, between 1 and <a class="reference internal" href="#f/_/f90calceph_getpositionrecordcount" title="f/_/f90calceph_getpositionrecordcount"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getpositionrecordcount()</span></code></a></p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: The target body</p></li>
<li><p><strong>center</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: The origin body</p></li>
<li><p><strong>firsttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the first time</p></li>
<li><p><strong>lasttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the last time</p></li>
<li><p><strong>frame</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: reference frame (see the list, below)</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getpositionrecordindex</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the target and origin bodies, the first and last time, and the reference frame available at the specified index for the position's records of the ephemeris file associated to <em>eph</em>.
The NAIF identification numbering system is used for the target and center integers (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).
The Julian date for the first and last time are expressed in the time scale returned by <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>It returns the following value in the parameter <em>frame</em> :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>ICRF</p></td>
</tr>
</tbody>
</table>
<p>The following example displays the position's records stored in the ephemeris file.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span>
<span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span>
<span class="kt">integer </span><span class="n">res</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">f90calceph_getpositionrecordcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">    </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getpositionrecordindex</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">)</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span>
<span class="w">  </span><span class="k">enddo</span>
<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getpositionrecordindex2">
<h3>f90calceph_getpositionrecordindex2<a class="headerlink" href="#menu-calceph-getpositionrecordindex2" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getpositionrecordindex2">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getpositionrecordindex2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">index</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">center</span></em>, <em class="sig-param"><span class="pre">firsttime</span></em>, <em class="sig-param"><span class="pre">lasttime</span></em>, <em class="sig-param"><span class="pre">frame</span></em>, <em class="sig-param"><span class="pre">segid</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getpositionrecordindex2" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>index</strong><em> [</em><em>INTEGER, intent(int)</em><em>]</em> :: index of the position's record, between 1 and <a class="reference internal" href="#f/_/f90calceph_getpositionrecordcount" title="f/_/f90calceph_getpositionrecordcount"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getpositionrecordcount()</span></code></a></p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: The target body</p></li>
<li><p><strong>center</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: The origin body</p></li>
<li><p><strong>firsttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the first time</p></li>
<li><p><strong>lasttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the last time</p></li>
<li><p><strong>frame</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: reference frame (see the list, below)</p></li>
<li><p><strong>segid</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: type of the segment.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getpositionrecordindex2</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the target and origin bodies, the first and last time, the reference frame, and the segment type available at the specified index for the position's records of the ephemeris file associated to <em>eph</em>.
The NAIF identification numbering system is used for the target and center integers (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).
The Julian date for the first and last time are expressed in the time scale returned by <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>It returns the following value in the parameter <em>frame</em> :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>ICRF</p></td>
</tr>
</tbody>
</table>
<p>It returns in the parameter <em>segid</em> one of the predefined constants <em>CALCEPH_SEGTYPE_...</em> (<a class="reference internal" href="calceph.interface.html#constants"><span class="std std-ref">Constants</span></a>).</p>
<p>The following example displays the position's records stored in the ephemeris file.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">,</span><span class="w"> </span><span class="n">iseg</span>
<span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span>
<span class="kt">integer </span><span class="n">res</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">f90calceph_getpositionrecordcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">    </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getpositionrecordindex2</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">,</span><span class="w"> </span><span class="n">iseg</span><span class="p">)</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">,</span><span class="w"> </span><span class="n">iseg</span>
<span class="w">  </span><span class="k">enddo</span>
<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getorientrecordcount">
<h3>f90calceph_getorientrecordcount<a class="headerlink" href="#menu-calceph-getorientrecordcount" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_getorientrecordcount">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getorientrecordcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_getorientrecordcount" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getorientrecordcount</strong><em> [</em><em>INTEGER</em><em>]</em> :: number of orientation's records. 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the number of orientation's records available in the ephemeris file associated to <em>eph</em>.
Usually, the number of records is equal to the number of bodies in the ephemeris file if the timespan is continuous.
If the timespan is discontinuous for the target body,
then each different timespan is counted as a different record.</p>
<p>The following example prints the number of orientation's records available in the ephemeris file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">res</span>
<span class="kt">integer </span><span class="n">n</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getorientrecordcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;number of orientation&#39;s record&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">  </span><span class="k">call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getorientrecordindex">
<h3>f90calceph_getorientrecordindex<a class="headerlink" href="#menu-calceph-getorientrecordindex" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getpositionrecordindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">index</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">firsttime</span></em>, <em class="sig-param"><span class="pre">lasttime</span></em>, <em class="sig-param"><span class="pre">frame</span></em><span class="sig-paren">)</span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>index</strong><em> [</em><em>INTEGER, intent(int)</em><em>]</em> :: index of the orientation's record, between 1 and <a class="reference internal" href="#f/_/f90calceph_getorientrecordcount" title="f/_/f90calceph_getorientrecordcount"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getorientrecordcount()</span></code></a></p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: The target body</p></li>
<li><p><strong>firsttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the first time</p></li>
<li><p><strong>lasttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the last time</p></li>
<li><p><strong>frame</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: reference frame (see the list, below)</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getorientrecordindex</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the target body, the first and last time, and the reference frame available at the specified index for the orientation's records of the ephemeris file associated to <em>eph</em>.
The NAIF identification numbering system is used for the target body (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).
The Julian date for the first and last time are expressed in the time scale returned by <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>It returns the following value in the parameter <em>frame</em> :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>ICRF</p></td>
</tr>
</tbody>
</table>
<p>The following example displays the orientation's records stored in the ephemeris file.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span>
<span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span>
<span class="kt">integer </span><span class="n">res</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">f90calceph_getorientrecordcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">    </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getorientrecordindex</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">)</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span>
<span class="w">  </span><span class="k">enddo</span>
<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-getorientrecordindex2">
<h3>f90calceph_getorientrecordindex2<a class="headerlink" href="#menu-calceph-getorientrecordindex2" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_getpositionrecordindex2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em>, <em class="sig-param"><span class="pre">index</span></em>, <em class="sig-param"><span class="pre">target</span></em>, <em class="sig-param"><span class="pre">firsttime</span></em>, <em class="sig-param"><span class="pre">lasttime</span></em>, <em class="sig-param"><span class="pre">frame</span></em>, <em class="sig-param"><span class="pre">segid</span></em><span class="sig-paren">)</span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p></li>
<li><p><strong>index</strong><em> [</em><em>INTEGER, intent(int)</em><em>]</em> :: index of the orientation's record, between 1 and <a class="reference internal" href="#f/_/f90calceph_getorientrecordcount" title="f/_/f90calceph_getorientrecordcount"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_getorientrecordcount()</span></code></a></p></li>
<li><p><strong>target</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: The target body</p></li>
<li><p><strong>firsttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the first time</p></li>
<li><p><strong>lasttime</strong><em> [</em><em>REAL(8), intent(out)</em><em>]</em> :: Julian date of the last time</p></li>
<li><p><strong>frame</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: reference frame (see the list, below)</p></li>
<li><p><strong>segid</strong><em> [</em><em>INTEGER, intent(out)</em><em>]</em> :: type of the segment.</p></li>
</ul>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>f90calceph_getorientrecordindex2</strong><em> [</em><em>INTEGER</em><em>]</em> :: 0 if an error occurs, otherwise non-zero value.</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the target body, the first and last time, the reference frame and the segment type available at the specified index for the orientation's records of the ephemeris file associated to <em>eph</em>.
The NAIF identification numbering system is used for the target body (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).
The Julian date for the first and last time are expressed in the time scale returned by <a class="reference internal" href="#f/_/f90calceph_gettimescale" title="f/_/f90calceph_gettimescale"><code class="xref f f-func docutils literal notranslate"><span class="pre">f90calceph_gettimescale()</span></code></a>.</p>
<p>It returns the following value in the parameter <em>frame</em> :</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>ICRF</p></td>
</tr>
</tbody>
</table>
<p>It returns in the parameter <em>segid</em> one of the predefined constants <em>CALCEPH_SEGTYPE_...</em> (<a class="reference internal" href="calceph.interface.html#constants"><span class="std std-ref">Constants</span></a>).</p>
<p>The following example displays the orientation's records stored in the ephemeris file.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="kt">integer</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">peph</span>
<span class="kt">integer </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">,</span><span class="w"> </span><span class="n">iseg</span>
<span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span>
<span class="kt">integer </span><span class="n">res</span>

<span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_open</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;example1.dat&quot;</span><span class="p">)</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">  do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">f90calceph_getorientrecordcount</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="w">    </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f90calceph_getorientrecordindex2</span><span class="p">(</span><span class="n">peph</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">,</span><span class="w"> </span><span class="n">iseg</span><span class="p">)</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">itarget</span><span class="p">,</span><span class="w"> </span><span class="n">firsttime</span><span class="p">,</span><span class="w"> </span><span class="n">lasttime</span><span class="p">,</span><span class="w"> </span><span class="n">iframe</span><span class="p">,</span><span class="w"> </span><span class="n">iseg</span>
<span class="w">  </span><span class="k">enddo</span>
<span class="k">  call </span><span class="n">f90calceph_close</span><span class="p">(</span><span class="n">peph</span><span class="p">)</span>
<span class="k">endif</span>
</pre></div>
</div>
</section>
<section id="menu-calceph-close">
<h3>f90calceph_close<a class="headerlink" href="#menu-calceph-close" title="Permalink to this heading"></a></h3>
<dl>
<dt class="sig sig-object f" id="f/_/f90calceph_close">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-name descname"><span class="pre">f90calceph_close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">eph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/_/f90calceph_close" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eph</strong><em> [</em><em>INTEGER(8), intent(in)</em><em>]</em> :: ephemeris descriptor</p>
</dd>
</dl>
</dd></dl>

<p>This function closes the access associated to the ephemeris descriptor <em>eph</em> and frees allocated memory for it.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="calceph.interface.html" class="btn btn-neutral float-left" title="Library interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="condsingle/calceph.single.html" class="btn btn-neutral float-right" title="Single file access functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, CNRS, Observatoire de Paris, Observatoire de la Côte d&#39;Azur.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>