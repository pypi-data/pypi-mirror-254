"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4242],{88486:function(e,t,n){n.d(t,{Gt:function(){return f},eB:function(){return m},oI:function(){return u}});var s=n(34090),r=n(27378),i=n(6848),a=n(30691),o=n(2458),c=n(24246),l=(0,r.createRef)(),d=(0,r.createRef)(),u=function(){var e=(0,i.T)(),t=(0,i.C)(a.DB),n=(0,r.useCallback)((function(){d.current=void 0,l.current=void 0}),[]),s=(0,r.useCallback)((function(){e((0,a.Mr)()),d.current&&(d.current(!0),n())}),[e,n]),o=(0,r.useCallback)((function(){e((0,a.Mr)()),d.current&&(d.current(!1),n())}),[e,n]);return{attemptAction:(0,r.useCallback)((function(){return t?(e((0,a.h7)()),l.current||(l.current=new Promise((function(e){d.current=e}))),l.current):Promise.resolve(!0)}),[t,e]),onConfirm:s,onClose:o}},f=function(e){var t=e.id,n=e.name,o=(0,s.u6)().dirty,c=(0,i.T)();return(0,r.useEffect)((function(){return c((0,a.Zu)({id:t,name:n})),function(){c((0,a.dz)({id:t}))}}),[c,t,n]),(0,r.useEffect)((function(){c((0,a.$p)({id:t,isDirty:o}))}),[o,c,t]),null},m=function(){var e=u(),t=e.onConfirm,n=e.onClose,s=(0,i.C)(a.uv);return(0,c.jsx)(o.Z,{isOpen:s,onClose:n,onConfirm:t,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},89348:function(e,t,n){n.d(t,{q:function(){return U}});var s=n(62332),r=n(27378),i=n(90849),a=n(55732),o=n(97865),c=n(34707),l=n.n(c),d=n(70409),u=n(21084),f=n(34896),m=n(30794),h=n(29549),y=n(78624),x=n(88486),g=n(91728),j=n(40240),p=n(96156),b=n(34090),v=n(24246),C=function(e){var t=e.systems,n=e.dataFlows,s=e.onDataFlowSystemChange,r=(0,b.u6)().setFieldValue,i=n.map((function(e){return e.fides_key}));return(0,v.jsxs)(j.iA,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,v.jsx)(j.hr,{children:(0,v.jsxs)(j.Tr,{children:[(0,v.jsx)(j.Th,{children:"System"}),(0,v.jsx)(j.Th,{})]})}),(0,v.jsx)(j.p3,{children:t.filter((function(e){return i.includes(e.fides_key)})).map((function(e){return(0,v.jsxs)(j.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,v.jsx)(j.Td,{children:(0,v.jsx)(f.xv,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,v.jsx)(j.Td,{textAlign:"end",children:(0,v.jsx)(h.hU,{background:"gray.50","aria-label":"Unassign data flow from system",icon:(0,v.jsx)(p.l,{}),variant:"outline",size:"sm",onClick:function(){return function(e){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));r("dataFlowSystems",t),s(t)}(e)},"data-testid":"unassign-btn"})})]},e.fides_key)}))})]})},w=n(60530),k=n(92975),S=n(62709),_=n(44845),F=n(13861),z=n(73679),O=function(e){var t=e.allSystems,n=e.dataFlowSystems,s=e.onChange,r=e.flowType,i=(0,b.u6)().setFieldValue,a=function(e){if(!!n.find((function(t){return t.fides_key===e.fides_key}))){var t=n.filter((function(t){return t.fides_key!==e.fides_key}));i("dataFlowSystems",t),s(t)}else{var r=[].concat((0,z.Z)(n),[{fides_key:e.fides_key,type:"system"}]);i("dataFlowSystems",r),s(r)}};return(0,v.jsx)(f.xu,{overflowY:"auto",maxHeight:"300px",children:(0,v.jsxs)(j.iA,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,v.jsx)(j.hr,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,v.jsxs)(j.Tr,{children:[(0,v.jsx)(j.Th,{children:"System"}),(0,v.jsxs)(j.Th,{textAlign:"right",children:["Set as ",r]})]})}),(0,v.jsx)(j.p3,{children:t.map((function(e){var t=!!n.find((function(t){return t.fides_key===e.fides_key}));return(0,v.jsxs)(j.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,v.jsx)(j.Td,{children:(0,v.jsx)(f.xv,{fontSize:"xs",lineHeight:4,fontWeight:"medium",children:e.name})}),(0,v.jsx)(j.Td,{textAlign:"right",children:(0,v.jsx)(S.r,{isChecked:t,onChange:function(){return a(e)},"data-testid":"assign-switch"})})]},e.fides_key)}))})]})})},T=function(e){var t=e.currentSystem,n=e.systems,s=e.isOpen,i=e.onClose,o=e.dataFlowSystems,c=e.onDataFlowSystemChange,d=e.flowType,u=(0,b.u6)().setFieldValue,m=(0,r.useState)(""),y=m[0],x=m[1],g=(0,r.useState)(o),j=g[0],p=g[1],C=function(){var e=(0,a.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(j),i();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=0===n.length,T=(0,r.useMemo)((function(){return n?n.filter((function(e){return e.fides_key!==t.fides_key})).filter((function(e){return(0,F.R)(e,y)})):[]}),[n,t.fides_key,y]),D=(0,r.useMemo)((function(){var e=new Set(j.map((function(e){return e.fides_key})));return T.every((function(t){return e.has(t.fides_key)}))}),[T,j]);return(0,v.jsxs)(w.u_,{isOpen:s,onClose:i,size:"2xl",isCentered:!0,children:[(0,v.jsx)(w.ZA,{}),(0,v.jsxs)(w.hz,{p:8,"data-testid":"confirmation-modal",children:[(0,v.jsxs)(w.xB,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,v.jsxs)(f.xv,{fontSize:"2xl",lineHeight:8,fontWeight:"semibold",children:["Configure ",d.toLocaleLowerCase()," systems"]}),(0,v.jsxs)(f.Ct,{bg:"green.500",color:"white",px:1,children:["Assigned to ",j.length," systems"]})]}),(0,v.jsx)(w.fe,{"data-testid":"assign-systems-modal-body",children:z?(0,v.jsx)(f.xv,{children:"No systems found"}):(0,v.jsxs)(f.Kq,{spacing:4,children:[(0,v.jsxs)(f.kC,{justifyContent:"space-between",children:[(0,v.jsx)(f.xv,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Add or remove destination systems from your data map"}),(0,v.jsx)(f.xu,{children:(0,v.jsxs)(k.NI,{display:"flex",alignItems:"center",children:[(0,v.jsx)(k.lX,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,v.jsx)(S.r,{size:"sm",id:"assign-all-systems",isChecked:D,onChange:function(e){if(e.target.checked&&n){var t=T.map((function(e){return{fides_key:e.fides_key,type:"system"}}));u("dataFlowSystems",t),p(t)}else p([])},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,v.jsx)(_.Z,{search:y,onChange:x,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,v.jsx)(O,{flowType:d,allSystems:T,dataFlowSystems:j,onChange:p})]})}),(0,v.jsx)(w.mz,{justifyContent:"flex-start",children:(0,v.jsxs)(h.hE,{size:"sm",children:[(0,v.jsx)(h.zx,{variant:"outline",mr:2,onClick:i,"data-testid":"cancel-btn",children:"Cancel"}),z?null:(0,v.jsx)(h.zx,{colorScheme:"primary",onClick:C,"data-testid":"confirm-btn",children:"Confirm"})]})})]})]})},D=n(24753),L=n(6848),A=n(48466),E=n(51860);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P={dataFlowSystems:[]},H=function(e){var t=e.system,n=e.isIngress,i=e.isSystemTab,c=(0,d.pm)(),j=n?"Source":"Destination",p="".concat(j,"s"),w=(0,u.qY)(),k=(0,A.qQ)(),S=(0,o.Z)(k,1)[0];(0,A.K3)();var _=(0,L.C)(E.cS),F=(0,r.useMemo)((function(){var e=n?t.ingress:t.egress;e||(e=[]);var s=_?_.map((function(e){return e.fides_key})):[];return e.filter((function(e){return s.includes(e.fides_key)}))}),[n,t,_]),z=(0,r.useState)(F),O=z[0],Z=z[1];(0,r.useEffect)((function(){Z(F)}),[F]);var H=function(){var e=(0,a.Z)(l().mark((function e(s,r){var i,a,o,d;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.dataFlowSystems,a=r.resetForm,o=I(I({},t),{},{ingress:n?i:t.ingress,egress:n?t.egress:i}),e.next=5,S(o);case 5:d=e.sent,(0,y.D4)(d)?c((0,D.Vo)("Failed to update data flows")):c((0,D.t5)("".concat(p," updated"))),a({values:{dataFlowSystems:i}});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return(0,v.jsxs)(s.Qd,{children:[(0,v.jsx)(s.KF,{height:"68px",paddingLeft:i?6:2,"data-testid":"data-flow-button-".concat(j),children:(0,v.jsxs)(f.kC,{alignItems:"center",justifyContent:"start",flex:1,textAlign:"left",children:[(0,v.jsx)(f.xv,{fontSize:"sm",lineHeight:5,fontWeight:"semibold",mr:2,children:p}),(0,v.jsx)(m.Vp,{ml:2,backgroundColor:"primary.400",borderRadius:"6px",color:"white",children:O.length}),(0,v.jsx)(f.LZ,{}),(0,v.jsx)(s.XE,{})]})}),(0,v.jsx)(s.Hk,{backgroundColor:"gray.50",padding:6,"data-testid":"data-flow-panel-".concat(j),children:(0,v.jsx)(f.Kq,{borderRadius:"md",backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:(0,v.jsx)(b.J9,{initialValues:P,onSubmit:H,children:function(e){var n=e.isSubmitting,s=e.dirty,r=e.resetForm;return(0,v.jsxs)(b.l0,{children:[(0,v.jsx)(x.Gt,{id:"".concat(t.fides_key,":").concat(j),name:"".concat(j," Data Flow")}),(0,v.jsx)(h.zx,{colorScheme:"primary",size:"xs",width:"fit-content",onClick:w.onOpen,"data-testid":"assign-systems-btn",rightIcon:(0,v.jsx)(g.A5,{}),marginBottom:4,children:"Configure ".concat(p.toLocaleLowerCase())}),(0,v.jsx)(C,{systems:_,dataFlows:O,onDataFlowSystemChange:Z}),(0,v.jsxs)(h.hE,{marginTop:6,children:[(0,v.jsx)(h.zx,{size:"sm",variant:"outline",disabled:!s&&O===F,onClick:function(){Z(F),r({values:{dataFlowSystems:F}})},children:"Cancel"}),(0,v.jsx)(h.zx,{size:"sm",colorScheme:"primary",type:"submit",isLoading:n,disabled:!s&&O===F,"data-testid":"save-btn",children:"Save"})]}),w.isOpen?(0,v.jsx)(T,{currentSystem:t,systems:_,isOpen:w.isOpen,onClose:w.onClose,dataFlowSystems:O,onDataFlowSystemChange:Z,flowType:j}):null]})}})})})]})},U=function(e){var t=e.system,n=e.isSystemTab;return(0,v.jsxs)(s.UQ,{allowToggle:!0,"data-testid":"data-flow-accordion",children:[(0,v.jsx)(H,{system:t,isIngress:!0,isSystemTab:n}),(0,v.jsx)(H,{system:t,isSystemTab:n})]})}},29073:function(e,t,n){var s=n(34896),r=n(73452),i=n(24246);t.Z=function(e){var t=e.title,n=e.description,a=e.button;return(0,i.jsxs)(s.Ug,{backgroundColor:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",py:4,px:6,"data-testid":"empty-state",children:[(0,i.jsx)(r.ii,{alignSelf:"start",color:"blue.400",mt:.5}),(0,i.jsxs)(s.xu,{flexGrow:1,children:[(0,i.jsx)(s.xv,{fontWeight:"bold",fontSize:"sm",mb:1,children:t}),(0,i.jsx)(s.xv,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:n})]}),a]})}},40397:function(e,t,n){n.d(t,{f:function(){return c}});var s=n(6848),r=n(47134),i=n(75846),a=n(45128),o=n(75523),c=function(e){var t=e.includeDatasets,n=e.includeDisabled,c=(0,o.MO)().isLoading,l=(0,r.te)().isLoading,d=(0,i.fd)().isLoading,u=(0,a.LH)({onlyUnlinkedDatasets:!1},{skip:!t}).isLoading,f=(0,s.C)(o.qb),m=(0,s.C)(o.Bd),h=(0,s.C)(r.ZL),y=(0,s.C)(r.H7),x=(0,s.C)(i.U3),g=(0,s.C)(i.jp),j=(0,s.C)(a.Q4);return{allDataCategories:n?f:m,allDataSubjects:n?h:y,allDataUses:n?x:g,allDatasets:t?j:void 0,isLoading:c||l||d||u}}},33167:function(e,t,n){n.d(t,{isAPIError:function(){return s.Bw},isErrorResult:function(){return s.D4}});var s=n(60041)}}]);