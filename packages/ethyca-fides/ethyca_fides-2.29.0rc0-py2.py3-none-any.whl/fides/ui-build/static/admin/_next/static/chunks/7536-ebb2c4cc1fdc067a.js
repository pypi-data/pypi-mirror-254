"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7536],{44204:function(e,r,t){var n=t(90849),s=t(90089),i=t(20294),a=t(24246),o=["data","border"];function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}r.Z=function(e){var r=e.data,t=e.border,n=void 0===t?"partial":t,l=(0,s.Z)(e,o);return(0,a.jsxs)(i.mQ,c(c({colorScheme:"complimentary"},l),{},{children:[(0,a.jsx)(i.td,{width:"partial"===n?"max-content":void 0,children:r.map((function(e,r){return(0,a.jsx)(i.OK,{"data-testid":"tab-".concat(e.label),_selected:{fontWeight:"600",color:"complimentary.500",borderColor:"complimentary.500"},fontSize:l.fontSize,fontWeight:"500",color:"gray.500",isDisabled:e.isDisabled||!1,children:e.label},r)}))}),(0,a.jsx)(i.nP,{children:r.map((function(e,r){return(0,a.jsx)(i.x4,{px:0,"data-testid":"tab-panel-".concat(e.label),children:e.content},r)}))})]}))}},96156:function(e,r,t){t.d(r,{l:function(){return i}});var n=t(13018),s=t(24246),i=(0,n.IU)({displayName:"TrashCanSolidIcon",viewBox:"0 0 12 15",path:(0,s.jsx)("path",{d:"M8.37857 1.18083C8.23393 0.892838 7.93661 0.710938 7.6125 0.710938H4.3875C4.06339 0.710938 3.76607 0.892838 3.62143 1.18083L3.42857 1.56094H0.857143C0.383036 1.56094 -1.19209e-07 1.94158 -1.19209e-07 2.41094C-1.19209e-07 2.8803 0.383036 3.26094 0.857143 3.26094H11.1429C11.6162 3.26094 12 2.8803 12 2.41094C12 1.94158 11.6162 1.56094 11.1429 1.56094H8.57143L8.37857 1.18083ZM11.167 4.11094H0.857143V12.6109C0.857143 13.5486 1.62589 14.3109 2.57143 14.3109H9.45268C10.3754 14.3109 11.167 13.5486 11.167 12.6109V4.11094ZM9.02411 6.23594V12.1859C9.02411 12.4197 8.80714 12.6109 8.59554 12.6109C8.33571 12.6109 8.16696 12.4197 8.16696 12.1859V6.23594C8.16696 6.00219 8.33571 5.81094 8.59554 5.81094C8.80714 5.81094 9.02411 6.00219 9.02411 6.23594ZM6.45268 6.23594V12.1859C6.45268 12.4197 6.23571 12.6109 6.02411 12.6109C5.76429 12.6109 5.57143 12.4197 5.57143 12.1859V6.23594C5.57143 6.00219 5.76429 5.81094 6.02411 5.81094C6.23571 5.81094 6.45268 6.00219 6.45268 6.23594ZM3.85714 6.23594V12.1859C3.85714 12.4197 3.66429 12.6109 3.42857 12.6109C3.19286 12.6109 3 12.4197 3 12.1859V6.23594C3 6.00219 3.19286 5.81094 3.42857 5.81094C3.66429 5.81094 3.85714 6.00219 3.85714 6.23594Z",fill:"currentColor"})})},63238:function(e,r,t){t.d(r,{Tg:function(){return a}});var n=t(6848),s=t(67788),i=t(24246),a=function(e){return(0,n.C)(s.uu).filter((function(r){return e.includes(r)})).length>0};r.ZP=function(e){var r=e.scopes,t=e.children;return a(r)?(0,i.jsx)(i.Fragment,{children:t}):null}},9408:function(e,r,t){t.d(r,{HK:function(){return i},VY:function(){return n.V}});var n=t(36653),s=t(78624),i=function(){var e=(0,n.V)().errorAlert;return{handleError:function(r){var t="An unexpected error occurred. Please try again.";(0,s.Ot)(r)?t=r.data.detail:(0,s.tB)(r)&&(t=r.data.detail[0].msg),e(t)}}};t(27378)},36653:function(e,r,t){t.d(r,{V:function(){return u}});var n=t(90849),s=t(70409),i=t(23286),a=t(34896),o=t(93235),l=t(24246);function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var u=function(){var e=(0,s.pm)();return{errorAlert:function(r,t,n){var s=d(d({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,l.jsxs)(i.bZ,{alignItems:"normal",status:"error",children:[(0,l.jsx)(i.zM,{}),(0,l.jsxs)(a.xu,{children:[t&&(0,l.jsx)(i.Cd,{children:t}),(0,l.jsx)(i.X,{children:r})]}),(0,l.jsx)(o.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,s):e(s)},successAlert:function(r,t,n){var s=d(d({},n),{},{position:(null===n||void 0===n?void 0:n.position)||"top",render:function(e){var n=e.onClose;return(0,l.jsxs)(i.bZ,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,l.jsx)(i.zM,{}),(0,l.jsxs)(a.xu,{children:[t&&(0,l.jsx)(i.Cd,{children:t}),(0,l.jsx)(i.X,{children:r})]}),(0,l.jsx)(o.P,{onClick:n,position:"relative",right:0,size:"sm",top:-1})]})}});null!==n&&void 0!==n&&n.id&&e.isActive(n.id)?e.update(n.id,s):e(s)}}}},56069:function(e,r,t){var n=t(90849),s=t(90089),i=t(34896),a=t(29549),o=t(73452),l=t(79894),c=t.n(l),d=t(24246),u=["backPath"];function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function p(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?h(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}r.Z=function(e){var r=e.backPath,t=(0,s.Z)(e,u);return(0,d.jsxs)(i.kC,p(p({alignItems:"center",mt:-4,mb:3},t),{},{children:[(0,d.jsx)(c(),{href:r,passHref:!0,children:(0,d.jsx)(a.hU,{"aria-label":"Back",icon:(0,d.jsx)(o.Rp,{}),mr:2,size:"xs",variant:"outline"})}),(0,d.jsx)(c(),{href:r,passHref:!0,children:(0,d.jsx)(i.xv,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})})]}))}},78098:function(e,r,t){var n=t(90089),s=t(55732),i=t(97865),a=t(34707),o=t.n(a),l=t(70409),c=t(60530),d=t(23286),u=t(34896),h=t(29549),p=t(34090),f=t(86677),m=(t(27378),t(68301)),x=t(6848),j=t(43139),b=t(78624),g=t(60709),y=t(24753),v=t(30002),w=t(24246),O=["user"],C={username:"",usernameConfirmation:""};r.Z=function(e){var r=e.user,t=(0,n.Z)(e,O),a=t.isOpen,P=t.onClose,S=function(e){var r=e.id,t=e.username,n=e.onClose,a=(0,l.pm)(),c=(0,f.useRouter)(),d=(0,x.T)(),u=(0,v.I1)(),h=(0,i.Z)(u,1)[0],p=function(){var e=(0,s.Z)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(r);case 2:t=e.sent,(0,b.D4)(t)?a((0,y.Vo)((0,b.e$)(t.error))):(a((0,y.t5)("Successfully deleted user")),n()),d((0,v.Vv)(void 0)),c.push(g.e3);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{handleDeleteUser:p,validationSchema:m.Ry().shape({usernameConfirmation:m.Z_().required().oneOf([t],"Confirmation input must match the username").label("Username confirmation")})}}({id:r.id,username:r.username,onClose:P}),k=S.handleDeleteUser,z=S.validationSchema;return(0,w.jsxs)(c.u_,{isCentered:!0,isOpen:a,onClose:P,children:[(0,w.jsx)(c.ZA,{}),(0,w.jsx)(c.hz,{"data-testid":"delete-user-modal",children:(0,w.jsx)(p.J9,{initialValues:C,validationSchema:z,onSubmit:k,children:function(e){var t=e.isSubmitting,n=e.dirty,s=e.isValid;return(0,w.jsxs)(p.l0,{children:[(0,w.jsx)(c.xB,{children:"Delete User"}),(0,w.jsx)(c.ol,{}),(0,w.jsxs)(c.fe,{children:[(0,w.jsxs)(d.bZ,{status:"warning",overflow:"visible",children:[(0,w.jsx)(d.zM,{}),(0,w.jsxs)(d.X,{children:[(0,w.jsx)(u.xv,{as:"span",mb:2,children:"You are about to delete the user\xa0"}),(0,w.jsxs)(u.xv,{as:"span",mb:2,fontStyle:"italic",fontWeight:"semibold",children:[r.username,"."]}),(0,w.jsx)(u.xv,{mb:2,children:"This action cannot be undone. To confirm, please enter the user\u2019s username below."})]})]}),(0,w.jsx)(u.Kq,{direction:"column",spacing:4,children:(0,w.jsx)(j.j0,{name:"usernameConfirmation",label:"Confirm username",placeholder:"Type the username to delete"})})]}),(0,w.jsx)(c.mz,{children:(0,w.jsxs)(h.hE,{size:"sm",spacing:"2",width:"100%",children:[(0,w.jsx)(h.zx,{onClick:P,variant:"outline",width:"50%",children:"Cancel"}),(0,w.jsx)(h.zx,{colorScheme:"primary",disabled:!n||!s,isLoading:t,type:"submit",width:"50%","data-testid":"submit-btn",children:"Delete User"})]})})]})}})})]})}},72086:function(e,r,t){var n=t(34896),s=(t(27378),t(51471)),i=t(56069),a=t(60709),o=t(24246);r.Z=function(e){var r=e.children;return(0,o.jsxs)(s.Z,{title:"User Management",children:[(0,o.jsx)(i.Z,{backPath:a.e3}),(0,o.jsx)(n.X6,{fontSize:"2xl",fontWeight:"semibold",children:"User Management"}),r]})}},44127:function(e,r,t){t.d(r,{Z:function(){return ge}});var n=t(90849),s=t(90089),i=t(34896),a=t(75834),o=t(24246),l=function(){return(0,o.jsxs)(i.xu,{children:[(0,o.jsx)(i.xu,{pb:4,fontSize:"18px",fontWeight:"semibold",children:"Role Description"}),(0,o.jsx)(i.gC,{spacing:4,children:a.K.map((function(e){return(0,o.jsxs)(i.xu,{width:"100%",padding:4,borderRadius:"md",backgroundColor:"blue.50",fontSize:"14px",children:[(0,o.jsx)(i.xu,{fontWeight:"semibold",children:e.label}),(0,o.jsx)(i.xu,{color:"gray.500",children:e.description})]},e.roleKey)}))})]})},c=t(6848),d=t(44204),u=t(20324),h=t(63238),p=t(55732),f=t(97865),m=t(34707),x=t.n(m),j=t(70409),b=t(21084),g=t(83125),y=t(29549),v=t(34090),w=t(79894),O=t.n(w),C=t(27378),P=t(78624),S=t(2458),k=t(60709),z=t(38687),Z=t(24753),_=t(5008),A=t(60530),D=t(92975),E=t(62709),V=t(44845),R=t(48466),I=t(13861),U=t(73679),K=t(40240),T=t(96156),q=t(30002),W=function(e){var r=e.assignedSystems,t=e.onAssignedSystemChange,n=(0,c.C)(q.Ux);if((0,q.d6)(n,{skip:!n}),0===r.length)return null;return(0,o.jsxs)(K.iA,{size:"sm","data-testid":"assign-systems-delete-table",children:[(0,o.jsx)(K.hr,{children:(0,o.jsxs)(K.Tr,{children:[(0,o.jsx)(K.Th,{children:"System"}),(0,o.jsx)(K.Th,{})]})}),(0,o.jsx)(K.p3,{children:r.map((function(e){return(0,o.jsxs)(K.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,o.jsx)(K.Td,{children:e.name}),(0,o.jsx)(K.Td,{textAlign:"end",children:(0,o.jsx)(y.hU,{background:"gray.50","aria-label":"Unassign system from user",icon:(0,o.jsx)(T.l,{}),variant:"outline",size:"sm",onClick:function(){return function(e){t(r.filter((function(r){return r.fides_key!==e.fides_key})))}(e)},"data-testid":"unassign-btn"})})]},e.fides_key)}))})]})},N=function(e){var r=e.allSystems,t=e.assignedSystems,n=e.onChange,s=function(e){var r=!!t.find((function(r){return r.fides_key===e.fides_key}));n(r?t.filter((function(r){return r.fides_key!==e.fides_key})):[].concat((0,U.Z)(t),[e]))};return(0,o.jsx)(i.xu,{overflowY:"auto",maxHeight:"300px",children:(0,o.jsxs)(K.iA,{size:"sm","data-testid":"assign-systems-table",maxHeight:"50vh",overflowY:"scroll",children:[(0,o.jsx)(K.hr,{position:"sticky",top:0,background:"white",zIndex:1,children:(0,o.jsxs)(K.Tr,{children:[(0,o.jsx)(K.Th,{children:"System"}),(0,o.jsx)(K.Th,{children:"Assign"})]})}),(0,o.jsx)(K.p3,{children:r.map((function(e){var r=!!t.find((function(r){return r.fides_key===e.fides_key}));return(0,o.jsxs)(K.Tr,{_hover:{bg:"gray.50"},"data-testid":"row-".concat(e.fides_key),children:[(0,o.jsx)(K.Td,{children:e.name}),(0,o.jsx)(K.Td,{children:(0,o.jsx)(E.r,{isChecked:r,onChange:function(){return s(e)},"data-testid":"assign-switch"})})]},e.fides_key)}))})]})})},M=function(e){var r=e.isOpen,t=e.onClose,n=e.assignedSystems,s=e.onAssignedSystemChange,a=(0,R.K3)().data,l=(0,C.useState)(""),c=l[0],d=l[1],u=(0,C.useState)(n),h=u[0],f=u[1],m=function(){var e=(0,p.Z)(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(h),t();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=!a||0===a.length,b=(0,C.useMemo)((function(){return a?a.filter((function(e){return(0,I.R)(e,c)})):[]}),[a,c]),g=(0,C.useMemo)((function(){var e=new Set(h.map((function(e){return e.fides_key})));return b.every((function(r){return e.has(r.fides_key)}))}),[b,h]);return(0,o.jsxs)(A.u_,{isOpen:r,onClose:t,size:"2xl",children:[(0,o.jsx)(A.ZA,{}),(0,o.jsxs)(A.hz,{p:8,"data-testid":"confirmation-modal",children:[(0,o.jsxs)(A.xB,{fontWeight:"medium",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,o.jsx)(i.xv,{children:"Assign systems"}),(0,o.jsxs)(i.Ct,{bg:"green.500",color:"white",px:1,children:["Assigned to ",n.length," systems"]})]}),(0,o.jsx)(A.fe,{"data-testid":"assign-systems-modal-body",children:j?(0,o.jsx)(i.xv,{children:"No systems found"}):(0,o.jsxs)(i.Kq,{spacing:4,children:[(0,o.jsxs)(i.kC,{justifyContent:"space-between",children:[(0,o.jsx)(i.xv,{fontSize:"sm",flexGrow:1,fontWeight:"medium",children:"Assign systems in your organization to this user"}),(0,o.jsx)(i.xu,{children:(0,o.jsxs)(D.NI,{display:"flex",alignItems:"center",children:[(0,o.jsx)(D.lX,{fontSize:"sm",htmlFor:"assign-all-systems",mb:"0",children:"Assign all systems"}),(0,o.jsx)(E.r,{size:"sm",id:"assign-all-systems",isChecked:g,onChange:function(e){if(e.target.checked&&a)f(b);else{var r=a?a.filter((function(e){return!b.includes(e)})):[];f(r)}},"data-testid":"assign-all-systems-toggle"})]})})]}),(0,o.jsx)(V.Z,{search:c,onChange:d,placeholder:"Search for systems","data-testid":"system-search",withIcon:!0}),(0,o.jsx)(N,{allSystems:b,assignedSystems:h,onChange:f})]})}),(0,o.jsx)(A.mz,{justifyContent:"flex-start",children:(0,o.jsxs)(y.hE,{size:"sm",children:[(0,o.jsx)(y.zx,{variant:"outline",mr:2,onClick:t,"data-testid":"cancel-btn",children:"Cancel"}),j?null:(0,o.jsx)(y.zx,{colorScheme:"primary",onClick:m,"data-testid":"confirm-btn",children:"Confirm"})]})})]})]})},H=function(e){var r=e.label,t=e.roleKey,n=e.isSelected,s=e.isDisabled,a=e.assignedSystems,l=e.onAssignedSystemChange,c=(0,v.u6)().setFieldValue,d=(0,b.qY)(),h=s?"You do not have sufficient permissions to assign this role.":void 0;return n?(0,o.jsxs)(i.Kq,{borderRadius:"md",border:"1px solid",borderColor:"gray.200",p:4,backgroundColor:"gray.50","aria-selected":"true",spacing:4,"data-testid":"selected",children:[(0,o.jsxs)(i.kC,{alignItems:"center",justifyContent:"space-between",children:[(0,o.jsx)(i.xv,{fontSize:"md",fontWeight:"semibold",children:r}),(0,o.jsx)(_.St,{})]}),t!==u.A7.APPROVER?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.kC,{alignItems:"center",children:[(0,o.jsx)(i.xv,{fontSize:"sm",fontWeight:"semibold",mr:1,children:"Assigned systems"}),(0,o.jsx)(z.Z,{label:"Assigned systems refer to those systems that have been specifically allocated to a user for management purposes. Users assigned to a system possess full edit permissions and are listed as the Data Steward for the respective system."})]}),(0,o.jsx)(y.zx,{disabled:s,title:h,colorScheme:"primary",size:"xs",width:"fit-content",onClick:d.onOpen,"data-testid":"assign-systems-btn",children:"Assign systems +"}),(0,o.jsx)(W,{assignedSystems:a,onAssignedSystemChange:l}),d.isOpen?(0,o.jsx)(M,{isOpen:d.isOpen,onClose:d.onClose,assignedSystems:a,onAssignedSystemChange:l}):null]}):null]}):(0,o.jsx)(y.zx,{onClick:function(){c("roles",[t])},justifyContent:"start",variant:"outline",height:"inherit",p:4,"data-testid":"role-option-".concat(r),title:h,disabled:s,children:r})};function L(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}var Y={roles:[]},B=function(){var e,r=(0,j.pm)(),t=(0,c.C)(q.Ux);(0,q.d6)(t,{skip:!t});var s=(0,b.qY)(),l=s.isOpen,d=s.onOpen,m=s.onClose,w=(0,c.C)(q.R$),_=(0,C.useState)(w),A=_[0],D=_[1],E=(0,q.G$)(),V=(0,f.Z)(E,1)[0];(0,C.useEffect)((function(){D(w)}),[w]);var R=(0,q.gU)(null!==t&&void 0!==t?t:"",{skip:!t}),I=R.data,U=R.isLoading,K=(0,q.lD)(),T=(0,f.Z)(K,1)[0],W=function(){var e=(0,p.Z)(x().mark((function e(n){var s,i,a,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l&&m(),t){e.next=3;break}return e.abrupt("return");case 3:return s=n.roles.includes(u.A7.APPROVER),e.next=6,T({user_id:t,payload:{roles:n.roles}});case 6:if(i=e.sent,!(0,P.D4)(i)){e.next=10;break}return r((0,Z.Vo)((0,P.e$)(i.error))),e.abrupt("return");case 10:if(s){e.next=18;break}return a=A.map((function(e){return e.fides_key})),e.next=14,V({userId:t,fidesKeys:a});case 14:if(o=e.sent,!(0,P.D4)(o)){e.next=18;break}return r((0,Z.Vo)((0,P.e$)(o.error))),e.abrupt("return");case 18:r((0,Z.t5)("Permissions updated"));case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),N=function(){var e=(0,p.Z)(x().mark((function e(r){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(!(A.length>0&&r.roles.includes(u.A7.APPROVER))){e.next=6;break}d(),e.next=8;break;case 6:return e.next=8,W(r);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),M=(0,h.Tg)([u.Sh.USER_PERMISSION_ASSIGN_OWNERS]);if(!t)return null;if(U)return(0,o.jsx)(g.$,{});if(!M&&null!==I&&void 0!==I&&null!==(e=I.roles)&&void 0!==e&&e.includes(u.A7.OWNER))return(0,o.jsx)(i.xv,{"data-testid":"insufficient-access",children:"You do not have sufficient access to change this user's permissions."});var B=null!==I&&void 0!==I&&I.roles?{roles:I.roles}:Y;return(0,o.jsx)(v.J9,{onSubmit:N,initialValues:B,enableReinitialize:!0,children:function(e){var r=e.values,t=e.isSubmitting,s=e.dirty;return(0,o.jsxs)(v.l0,{children:[(0,o.jsxs)(i.Kq,{spacing:7,children:[(0,o.jsxs)(i.Kq,{spacing:3,"data-testid":"role-options",children:[(0,o.jsxs)(i.kC,{alignItems:"center",children:[(0,o.jsx)(i.xv,{fontSize:"sm",fontWeight:"semibold",mr:1,children:"User role"}),(0,o.jsx)(z.Z,{label:"A user's role in the organization determines what parts of the UI they can access and which functions are available to them."})]}),a.K.map((function(e){var t=r.roles.indexOf(e.roleKey)>=0;return(0,o.jsx)(H,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?L(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({isSelected:t,isDisabled:e.roleKey===u.A7.OWNER&&!M,assignedSystems:A,onAssignedSystemChange:D},e),e.roleKey)}))]}),(0,o.jsxs)(y.hE,{size:"sm",children:[(0,o.jsx)(O(),{href:k.e3,passHref:!0,children:(0,o.jsx)(y.zx,{variant:"outline",children:"Cancel"})}),(0,o.jsx)(y.zx,{colorScheme:"primary",type:"submit",isLoading:t,disabled:!s&&A===w,"data-testid":"save-btn",children:"Save"})]})]}),(0,o.jsx)(S.Z,{isOpen:l,onClose:m,onConfirm:function(){return W(r)},title:"Change role to Approver",testId:"downgrade-to-approver-confirmation-modal",continueButtonText:"Yes",message:(0,o.jsx)(i.xv,{children:"Switching to an approver role will remove all assigned systems. Do you wish to proceed?"})})]})}})},F=t(9408),$=t(78098),X=t(68301),J=t(43139),G=X.Z_().required().min(8,"Password must have at least eight characters.").matches(/[0-9]/,"Password must have at least one number.").matches(/[A-Z]/,"Password must have at least one capital letter.").matches(/[a-z]/,"Password must have at least one lowercase letter.").matches(/[\W_]/,"Password must have at least one symbol."),Q=t(45802),ee=t(33167);function re(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function te(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?re(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ne=X.Ry().shape({password:G.label("Password"),passwordConfirmation:X.Z_().required().oneOf([X.iH("password")],"Passwords must match").label("Password confirmation")}),se={password:"",passwordConfirmation:""},ie=function(e){var r=function(e){var r=(0,b.qY)(),t=(0,j.pm)(),n=(0,q.ls)(),s=(0,f.Z)(n,1)[0],i=function(){var n=(0,p.Z)(x().mark((function n(i){var a;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s({id:e,new_password:i.password});case 2:a=n.sent,(0,ee.isErrorResult)(a)?t((0,Z.Vo)((0,P.e$)(a.error))):(t((0,Z.t5)("Successfully reset user's password. Please inform the user of their new password.")),r.onClose());case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return te(te({},r),{},{handleResetPassword:i})}(e.id),t=r.handleResetPassword,n=r.isOpen,s=r.onClose,a=r.onOpen;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.zx,{variant:"outline",size:"sm",onClick:a,"data-testid":"reset-password-btn",children:"Reset password"}),(0,o.jsxs)(A.u_,{isCentered:!0,isOpen:n,onClose:s,children:[(0,o.jsx)(A.ZA,{}),(0,o.jsx)(A.hz,{children:(0,o.jsx)(v.J9,{initialValues:se,validationSchema:ne,onSubmit:t,children:function(e){var r=e.isSubmitting,t=e.dirty,n=e.isValid;return(0,o.jsxs)(v.l0,{children:[(0,o.jsx)(A.xB,{children:"Reset Password"}),(0,o.jsx)(A.ol,{}),(0,o.jsx)(A.fe,{children:(0,o.jsxs)(i.Kq,{direction:"column",spacing:4,children:[(0,o.jsx)(i.xv,{mb:2,children:"Choose a new password for this user."}),(0,o.jsx)(J.j0,{name:"password",label:"Password",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol."}),(0,o.jsx)(J.j0,{name:"passwordConfirmation",label:"Confirm Password",placeholder:"********",type:"password",tooltip:"Must match above password."})]})}),(0,o.jsx)(A.mz,{children:(0,o.jsxs)(y.hE,{size:"sm",spacing:"2",width:"100%",children:[(0,o.jsx)(y.zx,{onClick:s,variant:"outline",width:"50%",children:"Cancel"}),(0,o.jsx)(y.zx,{colorScheme:"primary",disabled:!t||!n,isLoading:r,type:"submit",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})})]})}})})]})]})},ae=t(32751);function oe(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function le(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?oe(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oe(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ce=function(e){var r=function(e){var r=(0,b.qY)(),t=(0,j.pm)(),n=(0,C.useState)(""),s=n[0],i=n[1],a=(0,C.useState)(""),o=a[0],l=a[1],c=(0,q.ev)(),d=(0,f.Z)(c,2),u=d[0],h=d[1].isLoading,m=!!(e&&o&&s),g=function(){var n=(0,p.Z)(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:m&&u({id:e,old_password:s,new_password:o}).unwrap().then((function(){t((0,Z.t5)("Password updated")),r.onClose()}));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return le(le({},r),{},{changePasswordValidation:m,handleChange:function(e){"oldPassword"===e.target.name?i(e.target.value):l(e.target.value)},handleChangePassword:g,isLoading:h,newPasswordValue:o,oldPasswordValue:s})}(e.id),t=r.changePasswordValidation,n=r.handleChange,s=r.handleChangePassword,a=r.isLoading,l=r.isOpen,c=r.newPasswordValue,d=r.oldPasswordValue,u=r.onClose,h=r.onOpen;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y.zx,{variant:"outline",size:"sm",onClick:h,"data-testid":"update-password-btn",children:"Update password"}),(0,o.jsxs)(A.u_,{isCentered:!0,isOpen:l,onClose:u,children:[(0,o.jsx)(A.ZA,{}),(0,o.jsxs)(A.hz,{children:[(0,o.jsx)(A.xB,{children:"Update Password"}),(0,o.jsx)(A.ol,{}),(0,o.jsx)(A.fe,{pb:6,children:(0,o.jsxs)(i.Kq,{direction:"column",spacing:"15px",children:[(0,o.jsx)(D.NI,{children:(0,o.jsx)(ae.II,{isRequired:!0,name:"oldPassword",onChange:n,placeholder:"Old Password",type:"password",value:d,"data-testid":"input-oldPassword"})}),(0,o.jsx)(D.NI,{children:(0,o.jsx)(ae.II,{isRequired:!0,name:"newPassword",onChange:n,placeholder:"New Password",type:"password",value:c,"data-testid":"input-newPassword"})})]})}),(0,o.jsxs)(A.mz,{children:[(0,o.jsx)(y.zx,{bg:"white",marginRight:"10px",onClick:u,size:"sm",variant:"solid",width:"50%",children:"Cancel"}),(0,o.jsx)(y.zx,{bg:"primary.800",color:"white",disabled:!t,isLoading:a,mr:3,onClick:s,size:"sm",type:"submit",variant:"solid",width:"50%","data-testid":"submit-btn",children:"Change Password"})]})]})]})]})},de=function(){var e=(0,c.C)(q.Ux),r=(0,c.C)(Q.dy),t=!!r&&r.id===e;return(0,o.jsx)(i.xu,{children:e?(0,o.jsxs)(i.Ug,{children:[t?(0,o.jsx)(ce,{id:e}):null,(0,o.jsx)(h.ZP,{scopes:[u.Sh.USER_PASSWORD_RESET],children:(0,o.jsx)(ie,{id:e})})]}):null})};function ue(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function he(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ue(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ue(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var pe={username:"",first_name:"",last_name:"",password:""},fe=X.Ry().shape({username:X.Z_().required().label("Username"),first_name:X.Z_().label("First name"),last_name:X.Z_().label("Last name"),password:G.label("Password")}),me=function(e){var r=e.onSubmit,t=e.initialValues,n=e.canEditNames,s=(0,j.pm)(),a=(0,c.T)(),l=(0,b.qY)(),d=(0,F.HK)().handleError,u=(0,c.C)(q.ZC),h=!u,f=!h&&!n,m=function(){var e=(0,p.Z)(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t);case 2:if(!(n=e.sent)||!("error"in n)){e.next=6;break}return d(n.error),e.abrupt("return");case 6:s((0,Z.t5)("".concat(h?"User created. By default, new users are set to the Viewer role. To change the role, please go to the Permissions tab.":"User updated."))),n&&n.data&&a((0,q.Vv)(n.data.id));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),g=h?fe:fe.omit(["password"]);return(0,o.jsx)(v.J9,{onSubmit:m,initialValues:null!==t&&void 0!==t?t:pe,validationSchema:g,children:function(e){var r=e.dirty,t=e.isSubmitting,n=e.isValid;return(0,o.jsx)(v.l0,{children:(0,o.jsxs)(i.Kq,{maxW:["xs","xs","100%"],width:"100%",spacing:7,children:[(0,o.jsxs)(i.Kq,{spacing:6,maxWidth:"55%",children:[(0,o.jsxs)(i.kC,{children:[(0,o.jsx)(i.xv,{display:"flex",alignItems:"center",fontSize:"sm",fontWeight:"semibold",children:"Profile"}),(0,o.jsx)(i.xu,{marginLeft:"auto",children:(0,o.jsxs)(i.Ug,{children:[(0,o.jsx)(de,{}),h?null:(0,o.jsxs)(i.xu,{children:[(0,o.jsx)(y.hU,{"aria-label":"delete",icon:(0,o.jsx)(T.l,{}),variant:"outline",size:"sm",onClick:l.onOpen,"data-testid":"delete-user-btn"}),(0,o.jsx)($.Z,he({user:u},l))]})]})})]}),(0,o.jsx)(J.j0,{name:"username",label:"Username",variant:"block",placeholder:"Enter new username",disabled:!h,isRequired:!0}),(0,o.jsx)(J.j0,{name:"first_name",label:"First Name",variant:"block",placeholder:"Enter first name of user",disabled:f}),(0,o.jsx)(J.j0,{name:"last_name",label:"Last Name",variant:"block",placeholder:"Enter last name of user",disabled:f}),u?null:(0,o.jsx)(J.j0,{name:"password",label:"Password",variant:"block",placeholder:"********",type:"password",tooltip:"Password must contain at least 8 characters, 1 number, 1 capital letter, 1 lowercase letter, and at least 1 symbol.",isRequired:!0})]}),(0,o.jsxs)(y.hE,{size:"sm",children:[(0,o.jsx)(O(),{href:k.e3,passHref:!0,children:(0,o.jsx)(y.zx,{variant:"outline",mr:3,children:"Cancel"})}),(0,o.jsx)(y.zx,{type:"submit",bg:"primary.800",_hover:{bg:"primary.400"},_active:{bg:"primary.500"},colorScheme:"primary",disabled:!r||!n,isLoading:t,"data-testid":"save-user-btn",children:"Save"})]})]})})}})},xe=["onSubmit","initialValues"];function je(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function be(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?je(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):je(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ge=function(e){var r=e.onSubmit,t=e.initialValues,n=(0,s.Z)(e,xe),a=(0,c.C)(q.Ux);(0,q.Fk)(a,{skip:!a});var p=(0,h.Tg)([u.Sh.USER_PERMISSION_UPDATE]),f=!a||!p,m=[{label:"Profile",content:(0,o.jsx)(me,be({onSubmit:r,initialValues:t},n))},{label:"Permissions",content:(0,o.jsxs)(i.kC,{gap:"97px",children:[(0,o.jsx)(i.xu,{w:{base:"100%",md:"50%",xl:"50%"},children:(0,o.jsx)(B,{})}),(0,o.jsx)(i.xu,{position:"absolute",top:"96px",right:6,height:"calc(100% + 100px)",overflowY:"scroll",padding:6,w:"35%",borderLeftWidth:"1px",children:(0,o.jsx)(l,{})})]}),isDisabled:f}];return(0,o.jsx)(d.Z,{data:m})}},75834:function(e,r,t){t.d(r,{K:function(){return s}});var n=t(20324),s=[{label:"Owner",permissions_label:"Owner",roleKey:n.A7.OWNER,description:"Owners have view and edit access to the whole organization and can create new users"},{label:"Contributor",permissions_label:"Contributor",roleKey:n.A7.CONTRIBUTOR,description:"Contributors can create new users and have view and edit access to the whole organization apart from configuring storage and messaging"},{label:"Viewer",permissions_label:"Viewer",roleKey:n.A7.VIEWER,description:"Viewers have view access to the Data Map and all systems"},{label:"Viewer & Approver",permissions_label:"Viewer & Approver",roleKey:n.A7.VIEWER_AND_APPROVER,description:"Viewer & Approvers have view access to the Data Map but can also manage Privacy Requests"},{label:"Approver",permissions_label:"Approver",roleKey:n.A7.APPROVER,description:"Approvers can only access the Privacy Requests portal to manage requests"}]},33167:function(e,r,t){t.d(r,{isAPIError:function(){return n.Bw},isErrorResult:function(){return n.D4}});var n=t(60041)}}]);