var Mo=Object.defineProperty;var Lo=(e,t,l)=>t in e?Mo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;var J=(e,t,l)=>(Lo(e,typeof t!="symbol"?t+"":t,l),l),Dt=(e,t,l)=>{if(!t.has(e))throw TypeError("Cannot "+l)};var c=(e,t,l)=>(Dt(e,t,"read from private field"),l?l.call(e):t.get(e)),A=(e,t,l)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,l)},S=(e,t,l,o)=>(Dt(e,t,"write to private field"),o?o.call(e,l):t.set(e,l),l);var wt=(e,t,l,o)=>({set _(i){S(e,t,i,l)},get _(){return c(e,t,o)}}),T=(e,t,l)=>(Dt(e,t,"access private method"),l);import{x as _t,$ as Oo,C as _o,F as Ho,M as jo}from"./@vavt-nbmepBNB.js";import{d as W,i as O,c as d,r as ae,a as G,w as I,o as P,b as nt,e as Vt,f as me,n as Pe,h as Bo,F as Ht,p as Ee,t as ze,s as it,g as Do}from"./@vue-NNSWgvKg.js";import{m as No}from"./codemirror-thLcTxEQ.js";import{_ as zo,E as Ue,H as ho,s as mo,k as Po,i as Ro,m as Vo,u as Wo,r as Uo,f as Fe,g as Nt,j as qo,p as Go,C as Tt,l as Ko,n as Zo,S as Xo,o as Jo}from"./@codemirror-1Oy-9S_E.js";import{a as y}from"./@lezer-zO5nUykE.js";import{T as Yo}from"./medium-zoom-UI1A0slP.js";import{_ as Qo}from"./copy-to-clipboard-ebbzfRrE.js";import{F as ei}from"./markdown-it-Hr5Sq5Da.js";import{r as ti}from"./markdown-it-image-figures-56d0Cn7e.js";import{M as li}from"./markdown-it-task-lists-ssNXB4M9.js";const u="md-editor",oi="md-editor-v3",ii="https://at.alicdn.com/t/c/font_2605852_prouiefeic.js",ni="https://at.alicdn.com/t/c/font_2605852_prouiefeic.css",N="https://cdnjs.cloudflare.com/ajax/libs",ai=`${N}/highlight.js/11.9.0/highlight.min.js`,Nl={main:`${N}/prettier/2.8.0/standalone.js`,markdown:`${N}/prettier/2.8.0/parser-markdown.js`},zl={css:`${N}/cropperjs/1.5.13/cropper.min.css`,js:`${N}/cropperjs/1.5.13/cropper.min.js`},si=`${N}/screenfull.js/5.2.0/screenfull.min.js`,po=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","htmlPreview","catalog","github"],fo=["markdownTotal","=","scrollSwitch"],Pl={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Word Count",scrollAuto:"Scroll Auto"}}},ri=`${N}/mermaid/10.6.1/mermaid.esm.min.mjs`,Rl={js:`${N}/KaTeX/0.16.9/katex.min.js`,css:`${N}/KaTeX/0.16.9/katex.min.css`},Vl={a11y:{light:`${N}/highlight.js/11.9.0/styles/a11y-light.min.css`,dark:`${N}/highlight.js/11.9.0/styles/a11y-dark.min.css`},atom:{light:`${N}/highlight.js/11.9.0/styles/atom-one-light.min.css`,dark:`${N}/highlight.js/11.9.0/styles/atom-one-dark.min.css`},github:{light:`${N}/highlight.js/11.9.0/styles/github.min.css`,dark:`${N}/highlight.js/11.9.0/styles/github-dark.min.css`},gradient:{light:`${N}/highlight.js/11.9.0/styles/gradient-light.min.css`,dark:`${N}/highlight.js/11.9.0/styles/gradient-dark.min.css`},kimbie:{light:`${N}/highlight.js/11.9.0/styles/kimbie-light.min.css`,dark:`${N}/highlight.js/11.9.0/styles/kimbie-dark.min.css`},paraiso:{light:`${N}/highlight.js/11.9.0/styles/paraiso-light.min.css`,dark:`${N}/highlight.js/11.9.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${N}/highlight.js/11.9.0/styles/qtcreator-light.min.css`,dark:`${N}/highlight.js/11.9.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${N}/highlight.js/11.9.0/styles/stackoverflow-light.min.css`,dark:`${N}/highlight.js/11.9.0/styles/stackoverflow-dark.min.css`}},U={editorExtensions:{},editorConfig:{},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{},markdownItPlugins:e=>e,iconfontType:"svg",mermaidConfig:e=>e},$t=170,ge=({instance:e,ctx:t,props:l={}},o="default")=>{const i=(e==null?void 0:e.$slots[o])||(t==null?void 0:t.slots[o]);return(i?i(e):"")||l[o]},ci={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"}},Je=W({props:ci,setup(e,t){const l=`${u}-dropdown-hidden`,o=ae({overlayClass:[l],overlayStyle:{},triggerHover:!1,overlayHover:!1}),i=G(),n=G(),r=()=>{var s;o.triggerHover=!0;const f=i.value,w=n.value;if(!f||!w)return;const v=f.getBoundingClientRect(),g=f.offsetTop,p=f.offsetLeft,b=v.height,k=v.width,C=((s=document.querySelector(e.relative))==null?void 0:s.scrollLeft)||0;o.overlayStyle={...o.overlayStyle,top:g+b+"px",left:p-w.offsetWidth/2+k/2-C+"px"},e.onChange(!0)},h=()=>{o.overlayHover=!0};I(()=>e.visible,s=>{s?o.overlayClass=o.overlayClass.filter(f=>f!==l):o.overlayClass.push(l)});let m=-1;const a=s=>{i.value===s.target?o.triggerHover=!1:o.overlayHover=!1,clearTimeout(m),m=window.setTimeout(()=>{!o.overlayHover&&!o.triggerHover&&e.onChange(!1)},10)};return P(()=>{i.value.addEventListener("mouseenter",r),i.value.addEventListener("mouseleave",a),n.value.addEventListener("mouseenter",h),n.value.addEventListener("mouseleave",a)}),nt(()=>{i.value.removeEventListener("mouseenter",r),i.value.removeEventListener("mouseleave",a),n.value.removeEventListener("mouseenter",h),n.value.removeEventListener("mouseleave",a)}),()=>{const s=ge({ctx:t}),f=ge({props:e,ctx:t},"overlay"),w=Vt(s instanceof Array?s[0]:s,{ref:i}),v=d("div",{class:[`${u}-dropdown`,o.overlayClass],style:o.overlayStyle,ref:n},[d("div",{class:`${u}-dropdown-overlay`},[f instanceof Array?f[0]:f])]);return[w,v]}}}),di={title:{type:String,default:""},visible:{type:Boolean},trigger:{type:[String,Object]},onChange:{type:Function},overlay:{type:[String,Object]},insert:{type:Function},language:{type:String},theme:{type:String},default:{type:[String,Object]}},xt=W({name:"DropdownToolbar",props:di,emits:["onChange"],setup(e,t){const l=O("editorId");return()=>{const o=ge({props:e,ctx:t},"trigger"),i=ge({props:e,ctx:t},"overlay"),n=ge({props:e,ctx:t});return d(Je,{relative:`#${l}-toolbar-wrapper`,visible:e.visible,onChange:r=>{e.onChange instanceof Function?e.onChange(r):t.emit("onChange",r)},overlay:i},{default:()=>[d("div",{class:`${u}-toolbar-item`,title:e.title||""},[o,n])]})}}});xt.install=e=>(e.component(xt.name,xt),e);var ui=Object.defineProperty,hi=(e,t,l)=>t in e?ui(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,mi=(e,t,l)=>(hi(e,typeof t!="symbol"?t+"":t,l),l);let pi=class{constructor(){mi(this,"pools",{})}remove(t,l,o){const i=this.pools[t]&&this.pools[t][l];i&&(this.pools[t][l]=i.filter(n=>n!==o))}clear(t){this.pools[t]={}}on(t,l){return this.pools[t]||(this.pools[t]={}),this.pools[t][l.name]||(this.pools[t][l.name]=[]),this.pools[t][l.name].push(l.callback),this.pools[t][l.name].includes(l.callback)}emit(t,l,...o){this.pools[t]||(this.pools[t]={});const i=this.pools[t][l];i&&i.forEach(n=>{try{n(...o)}catch(r){console.error(`${l} monitor event exception！`,r)}})}};const $=new pi,jt="onSave",Jt="changeCatalogVisible",go="changeFullscreen",Wl="pageFullscreenChanged",Ul="fullscreenChanged",ql="previewChanged",Gl="htmlPreviewChanged",Kl="catalogVisibleChanged",vo="textareaFocus",St="buildFinished",Ze="errorCatcher",D="replace",Bt="uploadImage",Wt="openModals",bo="ctrlZ",yo="ctrlShiftZ",Ut="catalogChanged",ko="pushCatalog",fi=(e,t="image.png")=>{const l=e.split(","),o=l[0].match(/:(.*?);/);if(o){const i=o[1],n=atob(l[1]);let r=n.length;const h=new Uint8Array(r);for(;r--;)h[r]=n.charCodeAt(r);return new File([h],t,{type:i})}return null},gi=e=>{if(!e)return e;const t=e.split(`
`),l=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{l.push("<span></span>")}),l.push("</span>"),`<span class="code-block">${e}</span>${l.join("")}`},vi=(e,t)=>{if(!e||!t)return 0;const l=e==null?void 0:e.getBoundingClientRect();if(t===document.documentElement)return l.top-t.clientTop;const o=t==null?void 0:t.getBoundingClientRect();return l.top-o.top},bi=()=>`${Date.now().toString(36)}${Math.random().toString(36).substring(2)}`,Zl=(e,t)=>{const l=o=>{const i=e.parentElement||document.body,n=i.offsetWidth,r=i.offsetHeight,{clientWidth:h}=document.documentElement,{clientHeight:m}=document.documentElement,a=o.offsetX,s=o.offsetY,f=v=>{let g=v.x+document.body.scrollLeft-document.body.clientLeft-a,p=v.y+document.body.scrollTop-document.body.clientTop-s;g=g<1?1:g<h-n-1?g:h-n-1,p=p<1?1:p<m-r-1?p:m-r-1,t?t(g,p):(i.style.left=`${g}px`,i.style.top=`${p}px`)};document.addEventListener("mousemove",f);const w=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",w)};document.addEventListener("mouseup",w)};return e.addEventListener("mousedown",l),()=>{e.removeEventListener("mousedown",l)}},fe=(e,t="")=>{const l=document.getElementById(e.id),o=e.onload;e.onload=null;const i=function(n){typeof o=="function"&&o.bind(this)(n),e.removeEventListener("load",i)};l?t!==""&&(l.addEventListener("load",i),Reflect.get(window,t)&&l.dispatchEvent(new Event("load"))):(e.addEventListener("load",i),document.head.appendChild(e))},yi=_t((e,t,l)=>{const o=document.getElementById(e);o&&o.setAttribute(t,l)},10),ki=W({props:{name:{type:String,default:""}},setup(e){return()=>U.iconfontType==="svg"?d("svg",{class:`${u}-icon`,"aria-hidden":"true"},[d("use",{"xlink:href":`#${u}-icon-${e.name}`},null)]):d("i",{class:`${u}-iconfont ${u}-icon-${e.name}`},null)}}),M=W({props:{name:{type:String,default:""}},setup(e){const t=O("customIcon");return()=>{const l=t.value[e.name];return typeof l=="object"?typeof l.component=="object"?Bo(l.component,l.props):d("span",{innerHTML:l.component},null):d(ki,{name:e.name},null)}}}),wi={title:{type:String,default:""},visible:{type:Boolean,default:!1},width:{type:String,default:"auto"},height:{type:String,default:"auto"},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function,default:()=>{}}},Ye=W({name:"MdModal",props:wi,emits:["onClose"],setup(e,t){const l=G(e.visible),o=G([`${u}-modal`]),i=G(),n=G();let r=()=>{};const h=ae({initPos:{left:"0px",top:"0px"},historyPos:{left:"0px",top:"0px"}}),m=me(()=>e.isFullscreen?{width:"100%",height:"100%"}:{width:e.width,height:e.height});return P(()=>{r=Zl(n.value,(a,s)=>{h.initPos.left=a+"px",h.initPos.top=s+"px"})}),nt(()=>{r()}),I(()=>e.isFullscreen,a=>{a?r():r=Zl(n.value,(s,f)=>{h.initPos.left=s+"px",h.initPos.top=f+"px"})}),I(()=>e.visible,a=>{a?(o.value.push("zoom-in"),l.value=a,Pe(()=>{const s=i.value.offsetWidth/2,f=i.value.offsetHeight/2,w=document.documentElement.clientWidth/2,v=document.documentElement.clientHeight/2;h.initPos.left=w-s+"px",h.initPos.top=v-f+"px"}),setTimeout(()=>{o.value=o.value.filter(s=>s!=="zoom-in")},140)):(o.value.push("zoom-out"),setTimeout(()=>{o.value=o.value.filter(s=>s!=="zoom-out"),l.value=a},130))}),()=>{const a=ge({ctx:t}),s=ge({props:e,ctx:t},"title");return d("div",{style:{display:l.value?"block":"none"}},[d("div",{class:`${u}-modal-mask`,onClick:()=>{e.onClose?e.onClose():t.emit("onClose")}},null),d("div",{class:o.value,style:{...h.initPos,...m.value},ref:i},[d("div",{class:`${u}-modal-header`,ref:n},[s||""]),d("div",{class:`${u}-modal-body`},[a]),d("div",{class:`${u}-modal-func`},[e.showAdjust&&d("div",{class:`${u}-modal-adjust`,onClick:f=>{f.stopPropagation(),e.isFullscreen?h.initPos=h.historyPos:(h.historyPos=h.initPos,h.initPos={left:"0",top:"0"}),e.onAdjust(!e.isFullscreen)}},[d(M,{name:e.isFullscreen?"suoxiao":"fangda"},null)]),d("div",{class:`${u}-modal-close`,onClick:f=>{f.stopPropagation(),e.onClose?e.onClose():t.emit("onClose")}},[d(M,{name:"close"},null)])])])])}}});Ye.install=e=>(e.component(Ye.name,Ye),e);const ct=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,wo=new Set,$i=(e,t,l,o)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(e,t,l,o):console.error(`[${l}] ${t}: ${e}`)},Ci=e=>!wo.has(e),je=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),$o=e=>je(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Et:null:null;class Et extends Array{constructor(t){super(t),this.fill(0)}}var Qe;const We=class We{constructor(t,l){J(this,"heap");J(this,"length");if(!c(We,Qe))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new l(t),this.length=0}static create(t){const l=$o(t);if(!l)return[];S(We,Qe,!0);const o=new We(t,l);return S(We,Qe,!1),o}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}};Qe=new WeakMap,A(We,Qe,!1);let qt=We;var be,de,Ce,ye,et,K,ke,Z,B,F,oe,ue,ee,Y,we,Q,Ae,Ie,$e,Te,Ne,ne,pt,Kt,qe,Me,ft,he,Ot,Co,Ge,tt,gt,xe,Be,Se,De,vt,Zt,lt,Ft,ot,At,j,z,bt,Xt,Ke,dt;const Yt=class Yt{constructor(t){A(this,pt);A(this,Ot);A(this,xe);A(this,Se);A(this,vt);A(this,lt);A(this,ot);A(this,j);A(this,bt);A(this,Ke);A(this,be,void 0);A(this,de,void 0);A(this,Ce,void 0);A(this,ye,void 0);A(this,et,void 0);J(this,"ttl");J(this,"ttlResolution");J(this,"ttlAutopurge");J(this,"updateAgeOnGet");J(this,"updateAgeOnHas");J(this,"allowStale");J(this,"noDisposeOnSet");J(this,"noUpdateTTL");J(this,"maxEntrySize");J(this,"sizeCalculation");J(this,"noDeleteOnFetchRejection");J(this,"noDeleteOnStaleGet");J(this,"allowStaleOnFetchAbort");J(this,"allowStaleOnFetchRejection");J(this,"ignoreFetchAbort");A(this,K,void 0);A(this,ke,void 0);A(this,Z,void 0);A(this,B,void 0);A(this,F,void 0);A(this,oe,void 0);A(this,ue,void 0);A(this,ee,void 0);A(this,Y,void 0);A(this,we,void 0);A(this,Q,void 0);A(this,Ae,void 0);A(this,Ie,void 0);A(this,$e,void 0);A(this,Te,void 0);A(this,Ne,void 0);A(this,ne,void 0);A(this,qe,()=>{});A(this,Me,()=>{});A(this,ft,()=>{});A(this,he,()=>!1);A(this,Ge,t=>{});A(this,tt,(t,l,o)=>{});A(this,gt,(t,l,o,i)=>{if(o||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});const{max:l=0,ttl:o,ttlResolution:i=1,ttlAutopurge:n,updateAgeOnGet:r,updateAgeOnHas:h,allowStale:m,dispose:a,disposeAfter:s,noDisposeOnSet:f,noUpdateTTL:w,maxSize:v=0,maxEntrySize:g=0,sizeCalculation:p,fetchMethod:b,noDeleteOnFetchRejection:k,noDeleteOnStaleGet:C,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:E,ignoreFetchAbort:_}=t;if(l!==0&&!je(l))throw new TypeError("max option must be a nonnegative integer");const H=l?$o(l):Array;if(!H)throw new Error("invalid max value: "+l);if(S(this,be,l),S(this,de,v),this.maxEntrySize=g||c(this,de),this.sizeCalculation=p,this.sizeCalculation){if(!c(this,de)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(b!==void 0&&typeof b!="function")throw new TypeError("fetchMethod must be a function if specified");if(S(this,et,b),S(this,Ne,!!b),S(this,Z,new Map),S(this,B,new Array(l).fill(void 0)),S(this,F,new Array(l).fill(void 0)),S(this,oe,new H(l)),S(this,ue,new H(l)),S(this,ee,0),S(this,Y,0),S(this,we,qt.create(l)),S(this,K,0),S(this,ke,0),typeof a=="function"&&S(this,Ce,a),typeof s=="function"?(S(this,ye,s),S(this,Q,[])):(S(this,ye,void 0),S(this,Q,void 0)),S(this,Te,!!c(this,Ce)),S(this,ne,!!c(this,ye)),this.noDisposeOnSet=!!f,this.noUpdateTTL=!!w,this.noDeleteOnFetchRejection=!!k,this.allowStaleOnFetchRejection=!!x,this.allowStaleOnFetchAbort=!!E,this.ignoreFetchAbort=!!_,this.maxEntrySize!==0){if(c(this,de)!==0&&!je(c(this,de)))throw new TypeError("maxSize must be a positive integer if specified");if(!je(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");T(this,Ot,Co).call(this)}if(this.allowStale=!!m,this.noDeleteOnStaleGet=!!C,this.updateAgeOnGet=!!r,this.updateAgeOnHas=!!h,this.ttlResolution=je(i)||i===0?i:1,this.ttlAutopurge=!!n,this.ttl=o||0,this.ttl){if(!je(this.ttl))throw new TypeError("ttl must be a positive integer if specified");T(this,pt,Kt).call(this)}if(c(this,be)===0&&this.ttl===0&&c(this,de)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!c(this,be)&&!c(this,de)){const q="LRU_CACHE_UNBOUNDED";Ci(q)&&(wo.add(q),$i("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",q,Yt))}}static unsafeExposeInternals(t){return{starts:c(t,Ie),ttls:c(t,$e),sizes:c(t,Ae),keyMap:c(t,Z),keyList:c(t,B),valList:c(t,F),next:c(t,oe),prev:c(t,ue),get head(){return c(t,ee)},get tail(){return c(t,Y)},free:c(t,we),isBackgroundFetch:l=>{var o;return T(o=t,j,z).call(o,l)},backgroundFetch:(l,o,i,n)=>{var r;return T(r=t,ot,At).call(r,l,o,i,n)},moveToTail:l=>{var o;return T(o=t,Ke,dt).call(o,l)},indexes:l=>{var o;return T(o=t,xe,Be).call(o,l)},rindexes:l=>{var o;return T(o=t,Se,De).call(o,l)},isStale:l=>{var o;return c(o=t,he).call(o,l)}}}get max(){return c(this,be)}get maxSize(){return c(this,de)}get calculatedSize(){return c(this,ke)}get size(){return c(this,K)}get fetchMethod(){return c(this,et)}get dispose(){return c(this,Ce)}get disposeAfter(){return c(this,ye)}getRemainingTTL(t){return c(this,Z).has(t)?1/0:0}*entries(){for(const t of T(this,xe,Be).call(this))c(this,F)[t]!==void 0&&c(this,B)[t]!==void 0&&!T(this,j,z).call(this,c(this,F)[t])&&(yield[c(this,B)[t],c(this,F)[t]])}*rentries(){for(const t of T(this,Se,De).call(this))c(this,F)[t]!==void 0&&c(this,B)[t]!==void 0&&!T(this,j,z).call(this,c(this,F)[t])&&(yield[c(this,B)[t],c(this,F)[t]])}*keys(){for(const t of T(this,xe,Be).call(this)){const l=c(this,B)[t];l!==void 0&&!T(this,j,z).call(this,c(this,F)[t])&&(yield l)}}*rkeys(){for(const t of T(this,Se,De).call(this)){const l=c(this,B)[t];l!==void 0&&!T(this,j,z).call(this,c(this,F)[t])&&(yield l)}}*values(){for(const t of T(this,xe,Be).call(this))c(this,F)[t]!==void 0&&!T(this,j,z).call(this,c(this,F)[t])&&(yield c(this,F)[t])}*rvalues(){for(const t of T(this,Se,De).call(this))c(this,F)[t]!==void 0&&!T(this,j,z).call(this,c(this,F)[t])&&(yield c(this,F)[t])}[Symbol.iterator](){return this.entries()}find(t,l={}){for(const o of T(this,xe,Be).call(this)){const i=c(this,F)[o],n=T(this,j,z).call(this,i)?i.__staleWhileFetching:i;if(n!==void 0&&t(n,c(this,B)[o],this))return this.get(c(this,B)[o],l)}}forEach(t,l=this){for(const o of T(this,xe,Be).call(this)){const i=c(this,F)[o],n=T(this,j,z).call(this,i)?i.__staleWhileFetching:i;n!==void 0&&t.call(l,n,c(this,B)[o],this)}}rforEach(t,l=this){for(const o of T(this,Se,De).call(this)){const i=c(this,F)[o],n=T(this,j,z).call(this,i)?i.__staleWhileFetching:i;n!==void 0&&t.call(l,n,c(this,B)[o],this)}}purgeStale(){let t=!1;for(const l of T(this,Se,De).call(this,{allowStale:!0}))c(this,he).call(this,l)&&(this.delete(c(this,B)[l]),t=!0);return t}dump(){const t=[];for(const l of T(this,xe,Be).call(this,{allowStale:!0})){const o=c(this,B)[l],i=c(this,F)[l],n=T(this,j,z).call(this,i)?i.__staleWhileFetching:i;if(n===void 0||o===void 0)continue;const r={value:n};if(c(this,$e)&&c(this,Ie)){r.ttl=c(this,$e)[l];const h=ct.now()-c(this,Ie)[l];r.start=Math.floor(Date.now()-h)}c(this,Ae)&&(r.size=c(this,Ae)[l]),t.unshift([o,r])}return t}load(t){this.clear();for(const[l,o]of t){if(o.start){const i=Date.now()-o.start;o.start=ct.now()-i}this.set(l,o.value,o)}}set(t,l,o={}){var w,v,g;const{ttl:i=this.ttl,start:n,noDisposeOnSet:r=this.noDisposeOnSet,sizeCalculation:h=this.sizeCalculation,status:m}=o;let{noUpdateTTL:a=this.noUpdateTTL}=o;const s=c(this,gt).call(this,t,l,o.size||0,h);if(this.maxEntrySize&&s>this.maxEntrySize)return m&&(m.set="miss",m.maxEntrySizeExceeded=!0),this.delete(t),this;let f=c(this,K)===0?void 0:c(this,Z).get(t);if(f===void 0)f=c(this,K)===0?c(this,Y):c(this,we).length!==0?c(this,we).pop():c(this,K)===c(this,be)?T(this,lt,Ft).call(this,!1):c(this,K),c(this,B)[f]=t,c(this,F)[f]=l,c(this,Z).set(t,f),c(this,oe)[c(this,Y)]=f,c(this,ue)[f]=c(this,Y),S(this,Y,f),wt(this,K)._++,c(this,tt).call(this,f,s,m),m&&(m.set="add"),a=!1;else{T(this,Ke,dt).call(this,f);const p=c(this,F)[f];if(l!==p){if(c(this,Ne)&&T(this,j,z).call(this,p)?p.__abortController.abort(new Error("replaced")):r||(c(this,Te)&&((w=c(this,Ce))==null||w.call(this,p,t,"set")),c(this,ne)&&((v=c(this,Q))==null||v.push([p,t,"set"]))),c(this,Ge).call(this,f),c(this,tt).call(this,f,s,m),c(this,F)[f]=l,m){m.set="replace";const b=p&&T(this,j,z).call(this,p)?p.__staleWhileFetching:p;b!==void 0&&(m.oldValue=b)}}else m&&(m.set="update")}if(i!==0&&!c(this,$e)&&T(this,pt,Kt).call(this),c(this,$e)&&(a||c(this,ft).call(this,f,i,n),m&&c(this,Me).call(this,m,f)),!r&&c(this,ne)&&c(this,Q)){const p=c(this,Q);let b;for(;b=p==null?void 0:p.shift();)(g=c(this,ye))==null||g.call(this,...b)}return this}pop(){var t;try{for(;c(this,K);){const l=c(this,F)[c(this,ee)];if(T(this,lt,Ft).call(this,!0),T(this,j,z).call(this,l)){if(l.__staleWhileFetching)return l.__staleWhileFetching}else if(l!==void 0)return l}}finally{if(c(this,ne)&&c(this,Q)){const l=c(this,Q);let o;for(;o=l==null?void 0:l.shift();)(t=c(this,ye))==null||t.call(this,...o)}}}has(t,l={}){const{updateAgeOnHas:o=this.updateAgeOnHas,status:i}=l,n=c(this,Z).get(t);if(n!==void 0){const r=c(this,F)[n];if(T(this,j,z).call(this,r)&&r.__staleWhileFetching===void 0)return!1;if(c(this,he).call(this,n))i&&(i.has="stale",c(this,Me).call(this,i,n));else return o&&c(this,qe).call(this,n),i&&(i.has="hit",c(this,Me).call(this,i,n)),!0}else i&&(i.has="miss");return!1}peek(t,l={}){const{allowStale:o=this.allowStale}=l,i=c(this,Z).get(t);if(i!==void 0&&(o||!c(this,he).call(this,i))){const n=c(this,F)[i];return T(this,j,z).call(this,n)?n.__staleWhileFetching:n}}async fetch(t,l={}){const{allowStale:o=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:r=this.ttl,noDisposeOnSet:h=this.noDisposeOnSet,size:m=0,sizeCalculation:a=this.sizeCalculation,noUpdateTTL:s=this.noUpdateTTL,noDeleteOnFetchRejection:f=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:w=this.allowStaleOnFetchRejection,ignoreFetchAbort:v=this.ignoreFetchAbort,allowStaleOnFetchAbort:g=this.allowStaleOnFetchAbort,context:p,forceRefresh:b=!1,status:k,signal:C}=l;if(!c(this,Ne))return k&&(k.fetch="get"),this.get(t,{allowStale:o,updateAgeOnGet:i,noDeleteOnStaleGet:n,status:k});const x={allowStale:o,updateAgeOnGet:i,noDeleteOnStaleGet:n,ttl:r,noDisposeOnSet:h,size:m,sizeCalculation:a,noUpdateTTL:s,noDeleteOnFetchRejection:f,allowStaleOnFetchRejection:w,allowStaleOnFetchAbort:g,ignoreFetchAbort:v,status:k,signal:C};let E=c(this,Z).get(t);if(E===void 0){k&&(k.fetch="miss");const _=T(this,ot,At).call(this,t,E,x,p);return _.__returned=_}else{const _=c(this,F)[E];if(T(this,j,z).call(this,_)){const se=o&&_.__staleWhileFetching!==void 0;return k&&(k.fetch="inflight",se&&(k.returnedStale=!0)),se?_.__staleWhileFetching:_.__returned=_}const H=c(this,he).call(this,E);if(!b&&!H)return k&&(k.fetch="hit"),T(this,Ke,dt).call(this,E),i&&c(this,qe).call(this,E),k&&c(this,Me).call(this,k,E),_;const q=T(this,ot,At).call(this,t,E,x,p),V=q.__staleWhileFetching!==void 0&&o;return k&&(k.fetch=H?"stale":"refresh",V&&H&&(k.returnedStale=!0)),V?q.__staleWhileFetching:q.__returned=q}}get(t,l={}){const{allowStale:o=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:r}=l,h=c(this,Z).get(t);if(h!==void 0){const m=c(this,F)[h],a=T(this,j,z).call(this,m);return r&&c(this,Me).call(this,r,h),c(this,he).call(this,h)?(r&&(r.get="stale"),a?(r&&o&&m.__staleWhileFetching!==void 0&&(r.returnedStale=!0),o?m.__staleWhileFetching:void 0):(n||this.delete(t),r&&o&&(r.returnedStale=!0),o?m:void 0)):(r&&(r.get="hit"),a?m.__staleWhileFetching:(T(this,Ke,dt).call(this,h),i&&c(this,qe).call(this,h),m))}else r&&(r.get="miss")}delete(t){var o,i,n,r;let l=!1;if(c(this,K)!==0){const h=c(this,Z).get(t);if(h!==void 0)if(l=!0,c(this,K)===1)this.clear();else{c(this,Ge).call(this,h);const m=c(this,F)[h];T(this,j,z).call(this,m)?m.__abortController.abort(new Error("deleted")):(c(this,Te)||c(this,ne))&&(c(this,Te)&&((o=c(this,Ce))==null||o.call(this,m,t,"delete")),c(this,ne)&&((i=c(this,Q))==null||i.push([m,t,"delete"]))),c(this,Z).delete(t),c(this,B)[h]=void 0,c(this,F)[h]=void 0,h===c(this,Y)?S(this,Y,c(this,ue)[h]):h===c(this,ee)?S(this,ee,c(this,oe)[h]):(c(this,oe)[c(this,ue)[h]]=c(this,oe)[h],c(this,ue)[c(this,oe)[h]]=c(this,ue)[h]),wt(this,K)._--,c(this,we).push(h)}}if(c(this,ne)&&((n=c(this,Q))!=null&&n.length)){const h=c(this,Q);let m;for(;m=h==null?void 0:h.shift();)(r=c(this,ye))==null||r.call(this,...m)}return l}clear(){var t,l,o;for(const i of T(this,Se,De).call(this,{allowStale:!0})){const n=c(this,F)[i];if(T(this,j,z).call(this,n))n.__abortController.abort(new Error("deleted"));else{const r=c(this,B)[i];c(this,Te)&&((t=c(this,Ce))==null||t.call(this,n,r,"delete")),c(this,ne)&&((l=c(this,Q))==null||l.push([n,r,"delete"]))}}if(c(this,Z).clear(),c(this,F).fill(void 0),c(this,B).fill(void 0),c(this,$e)&&c(this,Ie)&&(c(this,$e).fill(0),c(this,Ie).fill(0)),c(this,Ae)&&c(this,Ae).fill(0),S(this,ee,0),S(this,Y,0),c(this,we).length=0,S(this,ke,0),S(this,K,0),c(this,ne)&&c(this,Q)){const i=c(this,Q);let n;for(;n=i==null?void 0:i.shift();)(o=c(this,ye))==null||o.call(this,...n)}}};be=new WeakMap,de=new WeakMap,Ce=new WeakMap,ye=new WeakMap,et=new WeakMap,K=new WeakMap,ke=new WeakMap,Z=new WeakMap,B=new WeakMap,F=new WeakMap,oe=new WeakMap,ue=new WeakMap,ee=new WeakMap,Y=new WeakMap,we=new WeakMap,Q=new WeakMap,Ae=new WeakMap,Ie=new WeakMap,$e=new WeakMap,Te=new WeakMap,Ne=new WeakMap,ne=new WeakMap,pt=new WeakSet,Kt=function(){const t=new Et(c(this,be)),l=new Et(c(this,be));S(this,$e,t),S(this,Ie,l),S(this,ft,(n,r,h=ct.now())=>{if(l[n]=r!==0?h:0,t[n]=r,r!==0&&this.ttlAutopurge){const m=setTimeout(()=>{c(this,he).call(this,n)&&this.delete(c(this,B)[n])},r+1);m.unref&&m.unref()}}),S(this,qe,n=>{l[n]=t[n]!==0?ct.now():0}),S(this,Me,(n,r)=>{if(t[r]){const h=t[r],m=l[r];n.ttl=h,n.start=m,n.now=o||i(),n.remainingTTL=n.now+h-m}});let o=0;const i=()=>{const n=ct.now();if(this.ttlResolution>0){o=n;const r=setTimeout(()=>o=0,this.ttlResolution);r.unref&&r.unref()}return n};this.getRemainingTTL=n=>{const r=c(this,Z).get(n);return r===void 0?0:t[r]===0||l[r]===0?1/0:l[r]+t[r]-(o||i())},S(this,he,n=>t[n]!==0&&l[n]!==0&&(o||i())-l[n]>t[n])},qe=new WeakMap,Me=new WeakMap,ft=new WeakMap,he=new WeakMap,Ot=new WeakSet,Co=function(){const t=new Et(c(this,be));S(this,ke,0),S(this,Ae,t),S(this,Ge,l=>{S(this,ke,c(this,ke)-t[l]),t[l]=0}),S(this,gt,(l,o,i,n)=>{if(T(this,j,z).call(this,o))return 0;if(!je(i))if(n){if(typeof n!="function")throw new TypeError("sizeCalculation must be a function");if(i=n(o,l),!je(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i}),S(this,tt,(l,o,i)=>{if(t[l]=o,c(this,de)){const n=c(this,de)-t[l];for(;c(this,ke)>n;)T(this,lt,Ft).call(this,!0)}S(this,ke,c(this,ke)+t[l]),i&&(i.entrySize=o,i.totalCalculatedSize=c(this,ke))})},Ge=new WeakMap,tt=new WeakMap,gt=new WeakMap,xe=new WeakSet,Be=function*({allowStale:t=this.allowStale}={}){if(c(this,K))for(let l=c(this,Y);!(!T(this,vt,Zt).call(this,l)||((t||!c(this,he).call(this,l))&&(yield l),l===c(this,ee)));)l=c(this,ue)[l]},Se=new WeakSet,De=function*({allowStale:t=this.allowStale}={}){if(c(this,K))for(let l=c(this,ee);!(!T(this,vt,Zt).call(this,l)||((t||!c(this,he).call(this,l))&&(yield l),l===c(this,Y)));)l=c(this,oe)[l]},vt=new WeakSet,Zt=function(t){return t!==void 0&&c(this,Z).get(c(this,B)[t])===t},lt=new WeakSet,Ft=function(t){var n,r;const l=c(this,ee),o=c(this,B)[l],i=c(this,F)[l];return c(this,Ne)&&T(this,j,z).call(this,i)?i.__abortController.abort(new Error("evicted")):(c(this,Te)||c(this,ne))&&(c(this,Te)&&((n=c(this,Ce))==null||n.call(this,i,o,"evict")),c(this,ne)&&((r=c(this,Q))==null||r.push([i,o,"evict"]))),c(this,Ge).call(this,l),t&&(c(this,B)[l]=void 0,c(this,F)[l]=void 0,c(this,we).push(l)),c(this,K)===1?(S(this,ee,S(this,Y,0)),c(this,we).length=0):S(this,ee,c(this,oe)[l]),c(this,Z).delete(o),wt(this,K)._--,l},ot=new WeakSet,At=function(t,l,o,i){const n=l===void 0?void 0:c(this,F)[l];if(T(this,j,z).call(this,n))return n;const r=new AbortController,{signal:h}=o;h==null||h.addEventListener("abort",()=>r.abort(h.reason),{signal:r.signal});const m={signal:r.signal,options:o,context:i},a=(p,b=!1)=>{const{aborted:k}=r.signal,C=o.ignoreFetchAbort&&p!==void 0;if(o.status&&(k&&!b?(o.status.fetchAborted=!0,o.status.fetchError=r.signal.reason,C&&(o.status.fetchAbortIgnored=!0)):o.status.fetchResolved=!0),k&&!C&&!b)return f(r.signal.reason);const x=v;return c(this,F)[l]===v&&(p===void 0?x.__staleWhileFetching?c(this,F)[l]=x.__staleWhileFetching:this.delete(t):(o.status&&(o.status.fetchUpdated=!0),this.set(t,p,m.options))),p},s=p=>(o.status&&(o.status.fetchRejected=!0,o.status.fetchError=p),f(p)),f=p=>{const{aborted:b}=r.signal,k=b&&o.allowStaleOnFetchAbort,C=k||o.allowStaleOnFetchRejection,x=C||o.noDeleteOnFetchRejection,E=v;if(c(this,F)[l]===v&&(!x||E.__staleWhileFetching===void 0?this.delete(t):k||(c(this,F)[l]=E.__staleWhileFetching)),C)return o.status&&E.__staleWhileFetching!==void 0&&(o.status.returnedStale=!0),E.__staleWhileFetching;if(E.__returned===E)throw p},w=(p,b)=>{var C;const k=(C=c(this,et))==null?void 0:C.call(this,t,n,m);k&&k instanceof Promise&&k.then(x=>p(x),b),r.signal.addEventListener("abort",()=>{(!o.ignoreFetchAbort||o.allowStaleOnFetchAbort)&&(p(),o.allowStaleOnFetchAbort&&(p=x=>a(x,!0)))})};o.status&&(o.status.fetchDispatched=!0);const v=new Promise(w).then(a,s),g=Object.assign(v,{__abortController:r,__staleWhileFetching:n,__returned:void 0});return l===void 0?(this.set(t,g,{...m.options,status:void 0}),l=c(this,Z).get(t)):c(this,F)[l]=g,g},j=new WeakSet,z=function(t){if(!c(this,Ne))return!1;const l=t;return!!l&&l instanceof Promise&&l.hasOwnProperty("__staleWhileFetching")&&l.__abortController instanceof AbortController},bt=new WeakSet,Xt=function(t,l){c(this,ue)[l]=t,c(this,oe)[t]=l},Ke=new WeakSet,dt=function(t){t!==c(this,Y)&&(t===c(this,ee)?S(this,ee,c(this,oe)[t]):T(this,bt,Xt).call(this,c(this,ue)[t],c(this,oe)[t]),T(this,bt,Xt).call(this,c(this,Y),t),S(this,Y,t))};let Gt=Yt;const Ti=(e,t)=>{const l=O("editorId"),{noImgZoomIn:o}=e,i=_t(()=>{const n=document.querySelectorAll(`#${l}-preview img`);n.length!==0&&Yo(n,{background:"#00000073"})});P(()=>{!o&&i()}),I([t,ze(e.setting,"preview")],()=>{!o&&i()})},xi=Ti,Si=(e,t)=>{if(typeof t[e]=="string")return t[e];const l=`<i class="${u}-iconfont ${u}-icon-${e}"></i>`;switch(U.iconfontType){case"svg":return`<svg class="${u}-icon" aria-hidden="true"><use xlink:href="#${u}-icon-${e}"></use></svg>`;default:return l}},Ei=(e,t)=>{const l=O("editorId"),o=O("usedLanguageText"),i=O("customIcon"),n=()=>{document.querySelectorAll(`#${l}-preview pre`).forEach(m=>{var a,s;let f=-1;(a=m.querySelector(".copy-button"))==null||a.remove();const w=((s=o.value.copyCode)==null?void 0:s.text)||"复制代码",v=document.createElement("span");v.setAttribute("class","copy-button"),v.dataset.tips=w,v.innerHTML=Si("copy",i.value),v.addEventListener("click",()=>{var g,p;clearTimeout(f);const b=m.querySelector("code").innerText,k=Qo(e.formatCopiedText(b)),C=((g=o.value.copyCode)==null?void 0:g.successTips)||"已复制！",x=((p=o.value.copyCode)==null?void 0:p.failTips)||"已复制！";v.dataset.tips=k?C:x,f=window.setTimeout(()=>{v.dataset.tips=w},1500)}),m.appendChild(v)})},r=()=>{Pe(n)},h=m=>{m&&Pe(n)};I(()=>t.value,r),I(()=>e.setting.preview,h),I(()=>e.setting.htmlPreview,h),I(()=>o.value,n),P(n)},Fi=Ei,Ai=e=>{var t;const l=(t=U.editorExtensions)==null?void 0:t.highlight,o=l==null?void 0:l.instance,i=O("highlight"),n=it(o);return P(()=>{if(!e.noHighlight&&!n.value){const r=document.createElement("script");r.src=i.value.js,r.onload=()=>{n.value=window.hljs},r.id=`${u}-hljs`,fe(r,"hljs");const h=document.createElement("link");h.rel="stylesheet",h.href=i.value.css,h.id=`${u}-hlCss`,fe(h)}}),I(()=>i.value.css,r=>{yi(`${u}-hlCss`,"href",r)}),n},Ii=Ai,Mi=e=>{const t=O("theme"),{editorExtensions:l,mermaidConfig:o}=U,i=l==null?void 0:l.mermaid,n=it(i==null?void 0:i.instance),r=it(-1),h=new Gt({max:1e3,ttl:6e5}),m=()=>{const a=n.value;!e.noMermaid&&a&&(a.initialize(o({startOnLoad:!1,theme:t.value==="dark"?"dark":"default"})),r.value=r.value+1)};return I(()=>t.value,()=>{h.clear(),m()}),P(()=>{if(!e.noMermaid&&!(i!=null&&i.instance)){const a=(i==null?void 0:i.js)||ri;if(/\.mjs/.test(a))zo(()=>import(a),__vite__mapDeps([])).then(s=>{n.value=s.default,m()});else{const s=document.createElement("script");s.id=`${u}-mermaid`,s.src=a,s.onload=()=>{n.value=window.mermaid,m()},fe(s,"mermaid")}}}),{mermaidRef:n,reRenderRef:r,replaceMermaid:()=>{Pe(()=>{if(!e.noMermaid&&n.value){const a=document.querySelectorAll(`div.${u}-mermaid`),s=document.createElement("div");s.style.width=document.body.offsetWidth+"px",s.style.height=document.body.offsetHeight+"px",s.style.position="fixed",s.style.zIndex="-10000",s.style.top="-10000";let f=a.length;f>0&&document.body.appendChild(s),a.forEach(async w=>{let v=h.get(w.innerText);if(!v){const p=bi(),b=n.value.renderAsync||n.value.render;let k="";try{k=await b(p,w.innerText,s)}catch{}v=await e.sanitizeMermaid(typeof k=="string"?k:k.svg),h.set(w.innerText,v)}const g=document.createElement("p");g.className=`${u}-mermaid`,g.setAttribute("data-processed",""),g.innerHTML=v,w.dataset.line!==void 0&&(g.dataset.line=w.dataset.line),w.replaceWith(g),--f===0&&s.remove()})}})}}},Li=Mi,Oi=e=>{var t;const l=(t=U.editorExtensions)==null?void 0:t.katex,o=l==null?void 0:l.instance,i=it(o);return P(()=>{if(!e.noKatex&&!i.value){const n=document.createElement("script");n.src=(l==null?void 0:l.js)||Rl.js,n.onload=()=>{i.value=window.katex},n.id=`${u}-katex`;const r=document.createElement("link");r.rel="stylesheet",r.href=(l==null?void 0:l.css)||Rl.css,r.id=`${u}-katexCss`,fe(n,"katex"),fe(r)}}),i},_i=Oi,Hi=(e,t)=>{const l=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(o,i,n,r,h)=>{const m=o[i],a=m.content.trim();if(m.info==="mermaid"){let s;return o[i].map&&o[i].level===0&&(s=o[i].map[0],o[i].attrSet("data-line",String(s))),`<div class="${u}-mermaid" ${s!==void 0?"data-line="+s:""} data-mermaid-theme=${t.themeRef.value}>${a}</div>`}return l(o,i,n,r,h)}},ji=Hi,Xl=(e,t)=>{let l=!0,o=!0;const i=e.posMax,n=t>0?e.src.charCodeAt(t-1):-1,r=t+1<=i?e.src.charCodeAt(t+1):-1;return(n===32||n===9||r>=48&&r<=57)&&(o=!1),(r===32||r===9)&&(l=!1),{can_open:l,can_close:o}},Bi=(e,t)=>{let l,o,i,n;if(e.src[e.pos]!=="$")return!1;if(i=Xl(e,e.pos),!i.can_open)return t||(e.pending+="$"),e.pos+=1,!0;const r=e.pos+1;for(l=r;(l=e.src.indexOf("$",l))!==-1;){for(n=l-1;e.src[n]==="\\";)n-=1;if((l-n)%2==1)break;l+=1}return l===-1?(t||(e.pending+="$"),e.pos=r,!0):l-r===0?(t||(e.pending+="$$"),e.pos=r+1,!0):(i=Xl(e,l),i.can_close?(t||(o=e.push("math_inline","math",0),o.markup="$",o.content=e.src.slice(r,l)),e.pos=l+1,!0):(t||(e.pending+="$"),e.pos=r,!0))},Di=(e,t,l,o)=>{let i,n,r,h,m=!1,a=e.bMarks[t]+e.tShift[t],s=e.eMarks[t];if(a+2>s||e.src.slice(a,a+2)!=="$$")return!1;if(a+=2,i=e.src.slice(a,s),o)return!0;for(i.trim().slice(-2)==="$$"&&(i=i.trim().slice(0,-2),m=!0),r=t;!m&&(r++,!(r>=l||(a=e.bMarks[r]+e.tShift[r],s=e.eMarks[r],a<s&&e.tShift[r]<e.blkIndent)));)e.src.slice(a,s).trim().slice(-2)==="$$"&&(h=e.src.slice(0,s).lastIndexOf("$$"),n=e.src.slice(a,h),m=!0);e.line=r+1;const f=e.push("math_block","math",0);return f.block=!0,f.content=(i&&i.trim()?i+`
`:"")+e.getLines(t+1,r,e.tShift[t],!0)+(n&&n.trim()?n:""),f.map=[t,e.line],f.markup="$$",!0},Ni=(e,t)=>{const l=i=>{if(t.katexRef.value){const n=t.katexRef.value.renderToString(i,{throwOnError:!1});return`<span class="${u}-katex-inline" data-processed>${n}</span>`}else return`<span class="${u}-katex-inline">${i}</span>`},o=(i,n)=>{if(t.katexRef.value){const r=t.katexRef.value.renderToString(i,{throwOnError:!1,displayMode:!0});return`<p class="${u}-katex-block" data-line=${n} data-processed>${r}</p>`}else return`<p class="${u}-katex-block" data-line=${n}>${i}</p>`};e.inline.ruler.after("escape","math_inline",Bi),e.block.ruler.after("blockquote","math_block",Di,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=(i,n)=>l(i[n].content),e.renderer.rules.math_block=(i,n)=>o(i[n].content,i[n].map[0])+`
`},zi=Ni,Pi=(e,t)=>{t=t||{};const l=3,o=t.marker||"!",i=o.charCodeAt(0),n=o.length;let r="",h="";const m=(s,f,w,v,g)=>{const p=s[f];return p.type==="admonition_open"?(s[f].attrPush(["class",`${u}-admonition ${u}-admonition-${p.info}`]),s[f].attrSet("data-line",String(s[f].map[0]))):p.type==="admonition_title_open"&&s[f].attrPush(["class",`${u}-admonition-title`]),g.renderToken(s,f,w)},a=s=>{const f=s.trim().split(" ",2);h="",r=f[0],f.length>1&&(h=s.substring(r.length+2)),(h===""||!h)&&(h=r)};e.block.ruler.before("code","admonition",(s,f,w,v)=>{let g,p,b,k=!1,C=s.bMarks[f]+s.tShift[f],x=s.eMarks[f];if(i!==s.src.charCodeAt(C))return!1;for(g=C+1;g<=x&&o[(g-C)%n]===s.src[g];g++);const E=Math.floor((g-C)/n);if(E!==l)return!1;g-=(g-C)%n;const _=s.src.slice(C,g),H=s.src.slice(g,x);if(a(H),v)return!0;for(p=f;p++,!(p>=w||(C=s.bMarks[p]+s.tShift[p],x=s.eMarks[p],C<x&&s.sCount[p]<s.blkIndent));)if(i===s.src.charCodeAt(C)&&!(s.sCount[p]-s.blkIndent>=4)){for(g=C+1;g<=x&&o[(g-C)%n]===s.src[g];g++);if(!(Math.floor((g-C)/n)<E)&&(g-=(g-C)%n,g=s.skipSpaces(g),!(g<x))){k=!0;break}}const q=s.parentType,R=s.lineMax;return s.parentType="root",s.lineMax=p,b=s.push("admonition_open","div",1),b.markup=_,b.block=!0,b.info=r,b.map=[f,p],b=s.push("admonition_title_open","p",1),b.markup=_+" "+r,b.map=[f,p],b=s.push("inline","",0),b.content=h,b.map=[f,s.line-1],b.children=[],b=s.push("admonition_title_close","p",-1),b.markup=_+" "+r,s.md.block.tokenize(s,f+1,p),b=s.push("admonition_close","div",-1),b.markup=s.src.slice(C,g),b.block=!0,s.parentType=q,s.lineMax=R,s.line=p+(k?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=m,e.renderer.rules.admonition_title_open=m,e.renderer.rules.admonition_title_close=m,e.renderer.rules.admonition_close=m},Ri=Pi,Vi=(e,t)=>{e.renderer.rules.heading_open=(l,o)=>{var i;const n=l[o],r=((i=l[o+1].children)==null?void 0:i.reduce((m,a)=>m+(a.content||""),""))||"",h=n.markup.length;return t.headsRef.value.push({text:r,level:h}),n.map&&n.level===0&&(n.attrSet("data-line",String(n.map[0])),n.attrSet("id",t.mdHeadingId(r,h,t.headsRef.value.length))),e.renderer.renderToken(l,o,t)},e.renderer.rules.heading_close=(l,o,i,n,r)=>r.renderToken(l,o,i)},Wi=Vi,Ui=(e,t)=>{const l=e.renderer.rules.fence,o=e.utils.unescapeAll,i=/\[(\w*)(?::([\w ]*))?\]/;function n(a){return a.info?o(a.info).trim():""}function r(a){const s=n(a),[f=null,w=""]=(i.exec(s)||[]).slice(1);return[f,w]}function h(a){const s=n(a);return s?s.split(/(\s+)/g)[0]:""}const m=(a,s,f,w,v)=>{if(a[s].hidden)return"";const[g,p]=r(a[s]);if(g===null)return l(a,s,f,w,v);let b,k,C,x,E="",_="";for(let H=s;H<a.length&&(b=a[H],[k,C]=r(b),k===g);H++)b.info=b.info.replace(i,""),b.hidden=!0,x=H-s>0?"":" checked",E+=`<li><input type="radio" name="label-group-${t.editorId}-${s}"${x}><label for="group-${t.editorId}-${s}-tab-${H-s}" onclick="this.previousElementSibling.click()">${C||h(b)}</label></li>
`,_+=`<input type="radio" id="group-${t.editorId}-${s}-tab-${H-s}" name="group-${t.editorId}-${s}"${x}>
`+l(a,H,f,w,v);return`<div class="code-tabs">
<ul>
`+E+`</ul>
`+_+"</div>"};e.renderer.rules.fence=m},qi=Ui,Gi=e=>{["paragraph_open","table_open","ordered_list_open","bullet_list_open","blockquote_open","hr","html_block","fence"].forEach(t=>{const l=e.renderer.rules[t];l?e.renderer.rules[t]=(o,i,n,r,h)=>{let m;const a=l(o,i,n,r,h);return o[i].map&&o[i].level===0&&!/^<!--/.test(a)?(m=o[i].map[0],a.replace(/^(<[^>]*)/,`$1 data-line="${m}"`)):a}:e.renderer.rules[t]=(o,i,n,r,h)=>{let m;return o[i].map&&o[i].level===0&&(m=o[i].map[0],o[i].attrSet("data-line",String(m))),h.renderToken(o,i,n)}})},Ki=(e,t)=>{const{editorConfig:l,markdownItConfig:o,markdownItPlugins:i}=U,n=O("editorId"),r=O("showCodeRowNumber"),h=O("theme"),m=G([]),a=Ii(e),s=_i(e),{reRenderRef:f,replaceMermaid:w}=Li(e),v=ei({html:!0,breaks:!0});o(v,{editorId:n});const g=[{type:"katex",plugin:zi,options:{katexRef:s}},{type:"image",plugin:ti,options:{figcaption:!0,classes:"md-zoom"}},{type:"admonition",plugin:Ri,options:{}},{type:"taskList",plugin:li,options:{}},{type:"heading",plugin:Wi,options:{mdHeadingId:e.mdHeadingId,headsRef:m}},{type:"codeTabs",plugin:qi,options:{editorId:n}}];e.noMermaid||g.push({type:"mermaid",plugin:ji,options:{themeRef:h}}),i(g,{editorId:n}).forEach(E=>{v.use(E.plugin,E.options)});const p=v.options.highlight;v.set({highlight:(E,_,H)=>{if(p){const V=p(E,_,H);if(V)return V}let q;!e.noHighlight&&a.value?a.value.getLanguage(_)?q=a.value.highlight(E,{language:_,ignoreIllegals:!0}).value:q=a.value.highlightAuto(E).value:q=v.utils.escapeHtml(E);const R=r?gi(q.replace(/^\n+|\n+$/g,"")):`<span class="code-block">${q.replace(/^\n+|\n+$/g,"")}</span>`;return`<pre><code class="language-${_}" language=${_}>${R}</code></pre>`}}),Gi(v);const b=G(e.sanitize(v.render(e.modelValue))),k=()=>{$.emit(n,St,b.value),e.onHtmlChanged(b.value),e.onGetCatalog(m.value),$.emit(n,Ut,m.value),w()};P(k);const C=_t(async()=>{m.value=[],b.value=e.sanitize(v.render(e.modelValue)),k()},(l==null?void 0:l.renderDelay)!==void 0?l==null?void 0:l.renderDelay:t?0:500),x=me(()=>(e.noKatex||s.value)&&(e.noHighlight||a.value));return I([ze(e,"modelValue"),x,f],C),P(()=>{$.on(n,{name:ko,callback(){$.emit(n,Ut,m.value)}})}),{html:b}},Zi=Ki,To={modelValue:{type:String,default:""},setting:{type:Object,default:()=>({})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean},sanitizeMermaid:{type:Function}},Xi={...To,onChange:{type:Function,default:()=>{}},placeholder:{type:String,default:""},scrollAuto:{type:Boolean},autofocus:{type:Boolean},disabled:{type:Boolean},readonly:{type:Boolean},maxlength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function,default:()=>{}},onFocus:{type:Function,default:()=>{}},noPrettier:{type:Boolean},completions:{type:Array},catalogVisible:{type:Boolean},theme:{type:String,default:"light"},onInput:{type:Function},onDrop:{type:Function,default:()=>{}},inputBoxWitdh:{type:String},onInputBoxWitdhChange:{type:Function}},xo=W({name:"ContentPreview",props:To,setup(e){const t=O("editorId"),l=O("previewTheme"),o=O("showCodeRowNumber"),{html:i}=Zi(e,e.previewOnly);return Fi(e,i),xi(e,i),()=>d(Ht,null,[d("div",{id:`${t}-preview-wrapper`,class:`${u}-preview-wrapper`,"data-show":e.setting.preview,key:"content-preview-wrapper"},[d("article",{id:`${t}-preview`,class:[`${u}-preview`,`${l==null?void 0:l.value}-theme`,o&&`${u}-scrn`],innerHTML:i.value},null)]),!e.previewOnly&&d("div",{id:`${t}-html-wrapper`,class:`${u}-preview-wrapper`,"data-show":e.setting.htmlPreview,key:"html-preview-wrapper"},[d("div",{class:`${u}-html`},[i.value])])])}}),Ji=(e,t)=>{const{editorId:l}=e,o=ae({buildFinished:!1,html:""});I(()=>e.modelValue,()=>{o.buildFinished=!1}),P(()=>{$.on(l,{name:St,callback(i){o.buildFinished=!0,o.html=i}}),$.on(l,{name:jt,callback(){const i=new Promise(n=>{if(o.buildFinished)n(o.html);else{const r=h=>{n(h),$.remove(l,St,r)};$.on(l,{name:St,callback:r})}});e.onSave?e.onSave(e.modelValue,i):t.emit("onSave",e.modelValue,i)}})})},So=e=>{var t,l;const{editorId:o}=e,i=(l=(t=U)==null?void 0:t.editorExtensions)==null?void 0:l.highlight;Ee("editorId",o),Ee("theme",me(()=>e.theme)),Ee("language",me(()=>e.language)),Ee("highlight",me(()=>{const r={...Vl,...i==null?void 0:i.css},h=e.codeStyleReverse&&e.codeStyleReverseList.includes(e.previewTheme)?"dark":e.theme;return{js:(i==null?void 0:i.js)||ai,css:r[e.codeTheme]?r[e.codeTheme][h]:Vl.atom[h]}})),Ee("showCodeRowNumber",e.showCodeRowNumber);const n=me(()=>{var r,h;const m={...Pl,...(h=(r=U)==null?void 0:r.editorConfig)==null?void 0:h.languageUserDefined};return m[e.language]?m[e.language]:Pl["zh-CN"]});Ee("usedLanguageText",n),Ee("previewTheme",me(()=>e.previewTheme)),Ee("customIcon",me(()=>e.customIcon))},Yi=e=>{So(e),Ee("tabWidth",e.tabWidth)},Eo=e=>{P(()=>{var t,l;if(!e.noIconfont)if(U.iconfontType==="svg"){const o=document.createElement("script");o.src=((t=U.editorExtensions)==null?void 0:t.iconfont)||ii,o.id=`${u}-icon`,fe(o)}else{const o=document.createElement("link");o.rel="stylesheet",o.href=((l=U.editorExtensions)==null?void 0:l.iconfontClass)||ni,o.id=`${u}-icon-class`,fe(o)}})},Qi=e=>{var t,l,o,i,n,r;const{noPrettier:h,noUploadImg:m}=e,{editorExtensions:a}=U,s=h||!!((l=(t=U.editorExtensions)==null?void 0:t.prettier)!=null&&l.prettierInstance),f=h||!!((i=(o=U.editorExtensions)==null?void 0:o.prettier)!=null&&i.parserMarkdownInstance),w=m||!!((r=(n=U.editorExtensions)==null?void 0:n.cropper)!=null&&r.instance);P(()=>{var v,g,p,b;const k=document.createElement("script"),C=document.createElement("script");k.src=((v=a==null?void 0:a.prettier)==null?void 0:v.standaloneJs)||Nl.main,k.id=`${u}-prettier`,C.src=((g=a==null?void 0:a.prettier)==null?void 0:g.parserMarkdownJs)||Nl.markdown,C.id=`${u}-prettierMD`;const x=document.createElement("link");x.rel="stylesheet",x.href=((p=a==null?void 0:a.cropper)==null?void 0:p.css)||zl.css,x.id=`${u}-cropperCss`;const E=document.createElement("script");E.src=((b=a==null?void 0:a.cropper)==null?void 0:b.js)||zl.js,E.id=`${u}-cropper`,w||(fe(x),fe(E)),s||fe(k),f||fe(C)}),Eo(e)},en=(e,t)=>{const{editorId:l}=e;P(()=>{$.on(l,{name:Ze,callback:o=>{e.onError instanceof Function?e.onError(o):t.emit("onError",o)}})})},tn=(e,t)=>{const{editorId:l}=e,o=ae({pageFullscreen:e.pageFullscreen,fullscreen:!1,preview:e.preview,htmlPreview:e.preview?!1:e.htmlPreview}),i=(h,m)=>{o[h]=m===void 0?!o[h]:m,h==="preview"&&o.preview?o.htmlPreview=!1:h==="htmlPreview"&&o.htmlPreview&&(o.preview=!1)};let n="";const r=()=>{o.pageFullscreen||o.fullscreen?document.body.style.overflow="hidden":document.body.style.overflow=n};return I(()=>[o.pageFullscreen,o.fullscreen],r),P(()=>{$.on(l,{name:Bt,callback(h,m){const a=s=>{$.emit(l,D,"image",{desc:"",urls:s}),m&&m()};e.onUploadImg?e.onUploadImg(h,a):t.emit("onUploadImg",h,a)}}),n=document.body.style.overflow,r()}),[o,i]},ln=e=>{const{editorId:t}=e,l=G(!1);return P(()=>{$.on(t,{name:Jt,callback:o=>{o===void 0?l.value=!l.value:l.value=o}})}),me(()=>!e.toolbarsExclude.includes("catalog")&&e.toolbars.includes("catalog")&&l.value)},on=(e,t,l,o,i)=>{const{editorId:n}=e;I(()=>o.pageFullscreen,h=>{$.emit(n,Wl,h)}),I(()=>o.fullscreen,h=>{$.emit(n,Ul,h)}),I(()=>o.preview,h=>{$.emit(n,ql,h)}),I(()=>o.htmlPreview,h=>{$.emit(n,Gl,h)}),I(l,h=>{$.emit(n,Kl,h)});const r={on(h,m){switch(h){case"pageFullscreen":{$.on(n,{name:Wl,callback(a){m(a)}});break}case"fullscreen":{$.on(n,{name:Ul,callback(a){m(a)}});break}case"preview":{$.on(n,{name:ql,callback(a){m(a)}});break}case"htmlPreview":{$.on(n,{name:Gl,callback(a){m(a)}});break}case"catalog":{$.on(n,{name:Kl,callback(a){m(a)}});break}}},togglePageFullscreen(h){i("pageFullscreen",h)},toggleFullscreen(h){$.emit(n,go,h)},togglePreview(h){i("preview",h)},toggleHtmlPreview(h){i("htmlPreview",h)},toggleCatalog(h){$.emit(n,Jt,h)},triggerSave(){$.emit(n,jt)},insert(h){$.emit(n,D,"universal",{generate:h})},focus(h){$.emit(n,vo,h)}};t.expose(r)},nn=e=>e,Fo={modelValue:{type:String,default:""},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:oi},showCodeRowNumber:{type:Boolean,default:!1},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:nn},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1},noImgZoomIn:{type:Boolean,default:!1},customIcon:{type:Object,default:{}},sanitizeMermaid:{type:Function,default:e=>Promise.resolve(e)}},an={...Fo,onChange:{type:Function},onSave:{type:Function},onUploadImg:{type:Function},pageFullscreen:{type:Boolean,default:!1},preview:{type:Boolean,default:!0},htmlPreview:{type:Boolean,default:!1},toolbars:{type:Array,default:po},toolbarsExclude:{type:Array,default:[]},noPrettier:{type:Boolean,default:!1},tabWidth:{type:Number,default:2},tableShape:{type:Array,default:()=>[6,4]},placeholder:{type:String,default:""},defToolbars:{type:[String,Object]},onError:{type:Function},footers:{type:Array,default:fo},scrollAuto:{type:Boolean,default:!0},defFooters:{type:[String,Object]},noUploadImg:{type:Boolean},autoFocus:{type:Boolean},disabled:{type:Boolean},readOnly:{type:Boolean},maxLength:{type:Number},autoDetectCode:{type:Boolean},onBlur:{type:Function},onFocus:{type:Function},completions:{type:Array},showToolbarName:{type:Boolean,default:!1},onInput:{type:Function},onDrop:{type:Function},inputBoxWitdh:{type:String,default:"50%"},onInputBoxWitdhChange:{type:Function}},Ao=["onHtmlChanged","onGetCatalog"],sn=[...Ao,"onChange","onSave","onUploadImg","onError","update:modelValue","onBlur","onFocus","onInput","onDrop","onInputBoxWitdhChange"],rn=W({name:"MdPreview",props:Fo,emits:Ao,setup(e,t){const{editorId:l,noKatex:o,noMermaid:i,noHighlight:n}=e;return So(e),Eo(e),nt(()=>{$.clear(l)}),()=>d("div",{id:l,class:[u,e.class,e.theme==="dark"&&`${u}-dark`,`${u}-previewOnly`],style:e.style},[d(xo,{modelValue:e.modelValue,onHtmlChanged:r=>{e.onHtmlChanged?e.onHtmlChanged(r):t.emit("onHtmlChanged",r)},onGetCatalog:r=>{e.onGetCatalog?e.onGetCatalog(r):t.emit("onGetCatalog",r)},mdHeadingId:e.mdHeadingId,noMermaid:i,sanitize:e.sanitize,noKatex:o,formatCopiedText:e.formatCopiedText,noHighlight:n,noImgZoomIn:e.noImgZoomIn,previewOnly:!0,sanitizeMermaid:e.sanitizeMermaid},null)])}}),It=rn;It.install=e=>(e.component(It.name,It),e);const cn={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},scrollElement:{type:[String,Object],default:""},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},Io=W({props:cn,setup(e){return()=>{const{tocItem:t,mdHeadingId:l,scrollElement:o,onClick:i,scrollElementOffsetTop:n}=e;return d("div",{class:[`${u}-catalog-link`,t.active&&`${u}-catalog-active`],onClick:r=>{i(r,t),r.stopPropagation();const h=l(t.text,t.level,t.index),m=document.getElementById(h),a=o instanceof Element?o:document.querySelector(o);if(m&&a){let s=m.offsetParent,f=m.offsetTop;if(a.contains(s))for(;s&&a!=s;)f+=s==null?void 0:s.offsetTop,s=s==null?void 0:s.offsetParent;a==null||a.scrollTo({top:f-n,behavior:"smooth"})}}},[d("span",{title:t.text},[t.text]),d("div",{class:`${u}-catalog-wrapper`},[t.children&&t.children.map(r=>d(Io,{mdHeadingId:l,key:`${t.text}-link-${r.level}-${r.text}`,tocItem:r,scrollElement:o,onClick:i,scrollElementOffsetTop:n},null))])])}}}),dn=Io,un={editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function},onActive:{type:Function}},hn=W({name:"MdCatalog",props:un,emits:["onClick","onActive"],setup(e,t){const l=e.editorId,o=ae({list:[],show:!1,scrollElement:e.scrollElement||`#${l}-preview-wrapper`}),i=it(),n=me(()=>{const a=[];return o.list.forEach((s,f)=>{const{text:w,level:v}=s,g={level:v,text:w,index:f+1,active:i.value===s};if(a.length===0)a.push(g);else{let p=a[a.length-1];if(g.level>p.level)for(let b=p.level+1;b<=6;b++){const{children:k}=p;if(!k){p.children=[g];break}if(p=k[k.length-1],g.level<=p.level){k.push(g);break}}else a.push(g)}}),a}),r=()=>o.scrollElement instanceof HTMLElement?o.scrollElement:document.querySelector(o.scrollElement),h=a=>{if(a.length===0)return o.list=[],!1;const{activeHead:s}=a.reduce((f,w,v)=>{const g=document.getElementById(e.mdHeadingId(w.text,w.level,v+1));if(g instanceof HTMLElement){const p=r(),b=vi(g,p);if(b<e.offsetTop&&b>f.minTop)return{activeHead:w,minTop:b}}return f},{activeHead:a[0],minTop:Number.MIN_SAFE_INTEGER});i.value=s,o.list=a},m=()=>{h(o.list)};return I(()=>i.value,a=>{const s=a?{...a}:void 0;e.onActive?e.onActive(s):t.emit("onActive",s)}),P(()=>{const a=r(),s=a===document.documentElement?window:a;s==null||s.addEventListener("scroll",m),$.on(l,{name:Ut,callback:f=>{s==null||s.removeEventListener("scroll",m),h(f),s==null||s.addEventListener("scroll",m)}}),$.emit(l,ko)}),nt(()=>{var a;const s=r();(a=s===document.documentElement?window:s)==null||a.removeEventListener("scroll",m)}),()=>d("div",{class:`${u}-catalog${e.theme==="dark"?"-dark":""} ${e.class}`},[n.value.map(a=>d(dn,{mdHeadingId:e.mdHeadingId,tocItem:a,key:`link-${a.level}-${a.text}`,scrollElement:o.scrollElement,onClick:(s,f)=>{e.onClick?e.onClick(s,f):t.emit("onClick",s,f)},scrollElementOffsetTop:e.scrollElementOffsetTop},null))])}}),mt=hn;mt.install=e=>(e.component(mt.name,mt),e);const mn={title:{type:String,default:""},trigger:{type:[String,Object]},onClick:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},Mt=W({name:"NormalToolbar",props:mn,emits:["onClick"],setup(e,t){return()=>{const l=ge({props:e,ctx:t},"trigger");return d("div",{class:`${u}-toolbar-item`,title:e.title,onClick:o=>{e.onClick instanceof Function?e.onClick(o):t.emit("onClick",o)}},[l])}}});Mt.install=e=>(e.component(Mt.name,Mt),e);function pn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Do(e)}const fn={title:{type:String,default:""},modalTitle:{type:String,default:""},visible:{type:Boolean},width:{type:String,default:"auto"},height:{type:String,default:"auto"},trigger:{type:[String,Object]},onClick:{type:Function},onClose:{type:Function},showAdjust:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1},onAdjust:{type:Function},insert:{type:Function},language:{type:String},theme:{type:String}},Lt=W({name:"ModalToolbar",props:fn,emits:["onClick","onClose","onAdjust"],setup(e,t){return()=>{const l=ge({props:e,ctx:t},"trigger"),o=ge({props:e,ctx:t},"default");return d(Ht,null,[d("div",{class:`${u}-toolbar-item`,title:e.title,onClick:()=>{e.onClick instanceof Function?e.onClick():t.emit("onClick")}},[l]),d(Ye,{width:e.width,height:e.height,title:e.modalTitle,visible:e.visible,onClose:()=>{e.onClose instanceof Function?e.onClose():t.emit("onClose")},showAdjust:e.showAdjust,isFullscreen:e.isFullscreen,onAdjust:i=>{e.onAdjust instanceof Function?e.onAdjust(i):t.emit("onAdjust",i)}},pn(o)?o:{default:()=>[o]})])}}});Lt.install=e=>(e.component(Lt.name,Lt),e);var gn=Object.defineProperty,vn=(e,t,l)=>t in e?gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,He=(e,t,l)=>(vn(e,typeof t!="symbol"?t+"":t,l),l);const bn=W({setup(){return()=>d("div",{class:`${u}-divider`},null)}}),yn={noPrettier:{type:Boolean},toolbars:{type:Array,default:()=>[]},toolbarsExclude:{type:Array,default:()=>[]},setting:{type:Object,default:()=>({})},screenfull:{type:Object,default:null},screenfullJs:{type:String,default:""},updateSetting:{type:Function,default:()=>{}},tableShape:{type:Array,default:()=>[6,4]},defToolbars:{type:Object},noUploadImg:{type:Boolean},showToolbarName:{type:Boolean}},kn=e=>{var t,l,o,i;const n=O("editorId");let r=(l=(t=U.editorExtensions)==null?void 0:t.screenfull)==null?void 0:l.instance;const h=(i=(o=U.editorExtensions)==null?void 0:o.screenfull)==null?void 0:i.js,m=G(!1),a=w=>{if(!r){$.emit(n,Ze,{name:"fullscreen",message:"fullscreen is undefined"});return}r.isEnabled?(m.value=!0,(w===void 0?!r.isFullscreen:w)?r.request():r.exit()):console.error("browser does not support screenfull!")},s=()=>{r&&r.isEnabled&&r.on("change",()=>{(m.value||e.setting.fullscreen)&&(m.value=!1,e.updateSetting("fullscreen"))})},f=()=>{r=window.screenfull,s()};return P(()=>{if(s(),!r){const w=document.createElement("script");w.src=h||si,w.onload=f,w.id=`${u}-screenfull`,fe(w,"screenfull")}}),P(()=>{$.on(n,{name:go,callback:a})}),{fullscreenHandler:a}},wn={tableShape:{type:Array,default:()=>[6,4]},onSelected:{type:Function,default:()=>{}}},$n=W({name:"TableShape",props:wn,setup(e){const t=ae({x:-1,y:-1});return()=>d("div",{class:`${u}-table-shape`,onMouseleave:()=>{t.x=-1,t.y=-1}},[new Array(e.tableShape[1]).fill("").map((l,o)=>d("div",{class:`${u}-table-shape-row`,key:`table-shape-row-${o}`},[new Array(e.tableShape[0]).fill("").map((i,n)=>d("div",{class:`${u}-table-shape-col`,key:`table-shape-col-${n}`,onMouseenter:()=>{t.x=o,t.y=n},onClick:()=>{e.onSelected(t)}},[d("div",{class:[`${u}-table-shape-col-default`,o<=t.x&&n<=t.y&&`${u}-table-shape-col-include`]},null)]))]))])}}),Cn=$n,Tn={type:{type:String,default:"link"},visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},xn=W({props:Tn,setup(e){const t=O("usedLanguageText"),l=O("editorId"),o=me(()=>{var n,r;switch(e.type){case"link":return(n=t.value.linkModalTips)==null?void 0:n.linkTitle;case"image":return(r=t.value.linkModalTips)==null?void 0:r.imageTitle;default:return""}}),i=ae({desc:"",url:""});return I(()=>e.visible,n=>{n||setTimeout(()=>{i.desc="",i.url=""},200)}),()=>d(Ye,{title:o.value,visible:e.visible,onClose:e.onCancel},{default:()=>{var n,r,h,m,a;return[d("div",{class:`${u}-form-item`},[d("label",{class:`${u}-label`,for:`link-desc-${l}`},[(n=t.value.linkModalTips)==null?void 0:n.descLabel]),d("input",{placeholder:(r=t.value.linkModalTips)==null?void 0:r.descLabelPlaceHolder,class:`${u}-input`,id:`link-desc-${l}`,type:"text",value:i.desc,onChange:s=>{i.desc=s.target.value},autocomplete:"off"},null)]),d("div",{class:`${u}-form-item`},[d("label",{class:`${u}-label`,for:`link-url-${l}`},[(h=t.value.linkModalTips)==null?void 0:h.urlLabel]),d("input",{placeholder:(m=t.value.linkModalTips)==null?void 0:m.urlLabelPlaceHolder,class:`${u}-input`,id:`link-url-${l}`,type:"text",value:i.url,onChange:s=>{i.url=s.target.value},autocomplete:"off"},null)]),d("div",{class:`${u}-form-item`},[d("button",{class:[`${u}-btn`,`${u}-btn-row`],type:"button",onClick:()=>{e.onOk(i),i.desc="",i.url=""}},[(a=t.value.linkModalTips)==null?void 0:a.buttonOK])])]}})}}),Sn={visible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},En=W({props:Sn,setup(e){var t,l,o;const i=O("usedLanguageText"),n=O("editorId");let r=(o=(l=(t=U)==null?void 0:t.editorExtensions)==null?void 0:l.cropper)==null?void 0:o.instance;const h=G(),m=G(),a=G(),s=ae({cropperInited:!1,imgSelected:!1,imgSrc:"",isFullscreen:!1});let f=null;I(()=>e.visible,()=>{e.visible&&!s.cropperInited&&(r=r||window.Cropper,h.value.onchange=()=>{if(!r){$.emit(n,Ze,{name:"Cropper",message:"Cropper is undefined"});return}const v=h.value.files||[];if(s.imgSelected=!0,(v==null?void 0:v.length)>0){const g=new FileReader;g.onload=p=>{s.imgSrc=p.target.result,Pe(()=>{f=new r(m.value,{viewMode:2,preview:`.${u}-clip-preview-target`})})},g.readAsDataURL(v[0])}})}),I(()=>[s.imgSelected],()=>{a.value.style=""}),I(()=>s.isFullscreen,()=>{Pe(()=>{f==null||f.destroy(),a.value.style="",m.value&&(f=new r(m.value,{viewMode:2,preview:`.${u}-clip-preview-target`}))})});const w=()=>{f.clear(),f.destroy(),f=null,h.value.value="",s.imgSelected=!1};return()=>{var v;return d(Ye,{class:`${u}-modal-clip`,title:(v=i.value.clipModalTips)==null?void 0:v.title,visible:e.visible,onClose:e.onCancel,showAdjust:!0,isFullscreen:s.isFullscreen,onAdjust:g=>{s.isFullscreen=g},width:"668px",height:"421px"},{default:()=>{var g,p;return[d("div",{class:`${u}-form-item ${u}-clip`},[d("div",{class:`${u}-clip-main`},[s.imgSelected?d("div",{class:`${u}-clip-cropper`},[d("img",{src:s.imgSrc,ref:m,style:{display:"none"},alt:""},null),d("div",{class:`${u}-clip-delete`,onClick:w},[d(M,{name:"delete"},null)])]):d("div",{class:`${u}-clip-upload`,onClick:()=>{h.value.click()}},[d(M,{name:"upload"},null)])]),d("div",{class:`${u}-clip-preview`},[d("div",{class:`${u}-clip-preview-target`,ref:a},null)])]),d("div",{class:`${u}-form-item`},[d("button",{class:`${u}-btn`,type:"button",onClick:()=>{if(f){const b=f.getCroppedCanvas();$.emit(n,Bt,[fi(b.toDataURL("image/png"))],e.onOk),w()}}},[((g=i.value.clipModalTips)==null?void 0:g.buttonUpload)||((p=i.value.linkModalTips)==null?void 0:p.buttonOK)])]),d("input",{ref:h,accept:"image/*",type:"file",multiple:!1,style:{display:"none"}},null)]}})}}}),Fn={type:{type:String,default:"link"},linkVisible:{type:Boolean,default:!1},clipVisible:{type:Boolean,default:!1},onCancel:{type:Function,default:()=>{}},onOk:{type:Function,default:()=>{}}},An=W({props:Fn,setup(e){return()=>d(Ht,null,[d(xn,{type:e.type,visible:e.linkVisible,onOk:e.onOk,onCancel:e.onCancel},null),d(En,{visible:e.clipVisible,onOk:e.onOk,onCancel:e.onCancel},null)])}}),In=W({name:"MDEditorToolbar",props:yn,setup(e){const t=O("editorId"),l=O("usedLanguageText"),o=O("theme"),i=O("language"),{fullscreenHandler:n}=kn(e),r=`${t}-toolbar-wrapper`,h=G(),m=ae({title:!1,catalog:!1,image:!1,table:!1,mermaid:!1,katex:!1}),a=(b,k)=>{$.emit(t,D,b,k)},s=ae({type:"link",linkVisible:!1,clipVisible:!1}),f=G();P(()=>{$.on(t,{name:Wt,callback(b){s.type=b,s.linkVisible=!0}})});const w=me(()=>{const b=e.toolbars.filter(E=>!e.toolbarsExclude.includes(E)),k=b.indexOf("="),C=k===-1?b:b.slice(0,k+1),x=k===-1?[]:b.slice(k,Number.MAX_SAFE_INTEGER);return[C,x]}),v=G(),g=()=>{$.emit(t,Bt,Array.from(v.value.files||[])),v.value.value=""};P(()=>{v.value.addEventListener("change",g)});const p=b=>{var k,C,x,E,_,H,q,R,V,se,ve,ie,te,le,re,Le,Re,yt,at,Ve,Oe,st,_e,ce,pe,rt,kt,Qt,el,tl,ll,ol,il,nl,al,sl,rl,cl,dl,ul,hl,ml,pl,fl,gl,vl,bl,yl,kl,wl,$l,Cl,Tl,xl,Sl,El,Fl,Al,Il,Ml,Ll,Ol,_l,Hl,jl,Bl,Dl;if(po.includes(b))switch(b){case"-":return d(bn,null,null);case"bold":return d("div",{class:`${u}-toolbar-item`,title:(k=l.value.toolbarTips)==null?void 0:k.bold,onClick:()=>{a("bold")}},[d(M,{name:"bold"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(C=l.value.toolbarTips)==null?void 0:C.bold])]);case"underline":return d("div",{class:`${u}-toolbar-item`,title:(x=l.value.toolbarTips)==null?void 0:x.underline,onClick:()=>{a("underline")}},[d(M,{name:"underline"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(E=l.value.toolbarTips)==null?void 0:E.underline])]);case"italic":return d("div",{class:`${u}-toolbar-item`,title:(_=l.value.toolbarTips)==null?void 0:_.italic,onClick:()=>{a("italic")}},[d(M,{name:"italic"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(H=l.value.toolbarTips)==null?void 0:H.italic])]);case"strikeThrough":return d("div",{class:`${u}-toolbar-item`,title:(q=l.value.toolbarTips)==null?void 0:q.strikeThrough,onClick:()=>{a("strikeThrough")}},[d(M,{name:"strike-through"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(R=l.value.toolbarTips)==null?void 0:R.strikeThrough])]);case"title":return d(Je,{relative:`#${r}`,visible:m.title,onChange:L=>{m.title=L},overlay:d("ul",{class:`${u}-menu`,onClick:()=>{m.title=!1}},[d("li",{class:`${u}-menu-item ${u}-menu-item-title`,onClick:()=>{a("h1")}},[(V=l.value.titleItem)==null?void 0:V.h1]),d("li",{class:`${u}-menu-item ${u}-menu-item-title`,onClick:()=>{a("h2")}},[(se=l.value.titleItem)==null?void 0:se.h2]),d("li",{class:`${u}-menu-item ${u}-menu-item-title`,onClick:()=>{a("h3")}},[(ve=l.value.titleItem)==null?void 0:ve.h3]),d("li",{class:`${u}-menu-item ${u}-menu-item-title`,onClick:()=>{a("h4")}},[(ie=l.value.titleItem)==null?void 0:ie.h4]),d("li",{class:`${u}-menu-item ${u}-menu-item-title`,onClick:()=>{a("h5")}},[(te=l.value.titleItem)==null?void 0:te.h5]),d("li",{class:`${u}-menu-item ${u}-menu-item-title`,onClick:()=>{a("h6")}},[(le=l.value.titleItem)==null?void 0:le.h6])])},{default:()=>{var L,X;return[d("div",{class:`${u}-toolbar-item`,title:(L=l.value.toolbarTips)==null?void 0:L.title},[d(M,{name:"title"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(X=l.value.toolbarTips)==null?void 0:X.title])])]}});case"sub":return d("div",{class:`${u}-toolbar-item`,title:(re=l.value.toolbarTips)==null?void 0:re.sub,onClick:()=>{a("sub")}},[d(M,{name:"sub"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(Le=l.value.toolbarTips)==null?void 0:Le.sub])]);case"sup":return d("div",{class:`${u}-toolbar-item`,title:(Re=l.value.toolbarTips)==null?void 0:Re.sup,onClick:()=>{a("sup")}},[d(M,{name:"sup"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(yt=l.value.toolbarTips)==null?void 0:yt.sup])]);case"quote":return d("div",{class:`${u}-toolbar-item`,title:(at=l.value.toolbarTips)==null?void 0:at.quote,onClick:()=>{a("quote")}},[d(M,{name:"quote"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(Ve=l.value.toolbarTips)==null?void 0:Ve.quote])]);case"unorderedList":return d("div",{class:`${u}-toolbar-item`,title:(Oe=l.value.toolbarTips)==null?void 0:Oe.unorderedList,onClick:()=>{a("unorderedList")}},[d(M,{name:"unordered-list"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(st=l.value.toolbarTips)==null?void 0:st.unorderedList])]);case"orderedList":return d("div",{class:`${u}-toolbar-item`,title:(_e=l.value.toolbarTips)==null?void 0:_e.orderedList,onClick:()=>{a("orderedList")}},[d(M,{name:"ordered-list"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(ce=l.value.toolbarTips)==null?void 0:ce.orderedList])]);case"task":return d("div",{class:`${u}-toolbar-item`,title:(pe=l.value.toolbarTips)==null?void 0:pe.task,onClick:()=>{a("task")}},[d(M,{name:"task"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(rt=l.value.toolbarTips)==null?void 0:rt.task])]);case"codeRow":return d("div",{class:`${u}-toolbar-item`,title:(kt=l.value.toolbarTips)==null?void 0:kt.codeRow,onClick:()=>{a("codeRow")}},[d(M,{name:"code-row"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(Qt=l.value.toolbarTips)==null?void 0:Qt.codeRow])]);case"code":return d("div",{class:`${u}-toolbar-item`,title:(el=l.value.toolbarTips)==null?void 0:el.code,onClick:()=>{a("code")}},[d(M,{name:"code"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(tl=l.value.toolbarTips)==null?void 0:tl.code])]);case"link":return d("div",{class:`${u}-toolbar-item`,title:(ll=l.value.toolbarTips)==null?void 0:ll.link,onClick:()=>{s.type="link",s.linkVisible=!0}},[d(M,{name:"link"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(ol=l.value.toolbarTips)==null?void 0:ol.link])]);case"image":return e.noUploadImg?d("div",{class:`${u}-toolbar-item`,title:(il=l.value.toolbarTips)==null?void 0:il.image,onClick:()=>{s.type="image",s.linkVisible=!0}},[d(M,{name:"image"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(nl=l.value.toolbarTips)==null?void 0:nl.image])]):d(Je,{relative:`#${r}`,visible:m.image,onChange:L=>{m.image=L},overlay:d("ul",{class:`${u}-menu`,onClick:()=>{m.title=!1}},[d("li",{class:`${u}-menu-item ${u}-menu-item-image`,onClick:()=>{s.type="image",s.linkVisible=!0}},[(al=l.value.imgTitleItem)==null?void 0:al.link]),d("li",{class:`${u}-menu-item ${u}-menu-item-image`,onClick:()=>{v.value.click()}},[(sl=l.value.imgTitleItem)==null?void 0:sl.upload]),d("li",{class:`${u}-menu-item ${u}-menu-item-image`,onClick:()=>{s.clipVisible=!0}},[(rl=l.value.imgTitleItem)==null?void 0:rl.clip2upload])])},{default:()=>{var L,X;return[d("div",{class:`${u}-toolbar-item`,title:(L=l.value.toolbarTips)==null?void 0:L.image},[d(M,{name:"image"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(X=l.value.toolbarTips)==null?void 0:X.image])])]}});case"table":return d(Je,{relative:`#${r}`,visible:m.table,onChange:L=>{m.table=L},key:"bar-table",overlay:d(Cn,{tableShape:e.tableShape,onSelected:L=>{a("table",{selectedShape:L})}},null)},{default:()=>{var L,X;return[d("div",{class:`${u}-toolbar-item`,title:(L=l.value.toolbarTips)==null?void 0:L.table},[d(M,{name:"table"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(X=l.value.toolbarTips)==null?void 0:X.table])])]}});case"revoke":return d("div",{class:`${u}-toolbar-item`,title:(cl=l.value.toolbarTips)==null?void 0:cl.revoke,onClick:()=>{$.emit(t,bo)}},[d(M,{name:"revoke"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(dl=l.value.toolbarTips)==null?void 0:dl.revoke])]);case"next":return d("div",{class:`${u}-toolbar-item`,title:(ul=l.value.toolbarTips)==null?void 0:ul.next,onClick:()=>{$.emit(t,yo)}},[d(M,{name:"next"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(hl=l.value.toolbarTips)==null?void 0:hl.next])]);case"save":return d("div",{class:`${u}-toolbar-item`,title:(ml=l.value.toolbarTips)==null?void 0:ml.save,onClick:()=>{$.emit(t,jt)}},[d(M,{name:"baocun"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(pl=l.value.toolbarTips)==null?void 0:pl.save])]);case"prettier":return e.noPrettier?"":d("div",{class:`${u}-toolbar-item`,title:(fl=l.value.toolbarTips)==null?void 0:fl.prettier,onClick:()=>{a("prettier")}},[d(M,{name:"prettier"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(gl=l.value.toolbarTips)==null?void 0:gl.prettier])]);case"pageFullscreen":return!e.setting.fullscreen&&d("div",{class:`${u}-toolbar-item`,title:(vl=l.value.toolbarTips)==null?void 0:vl.pageFullscreen,onClick:()=>{e.updateSetting("pageFullscreen")}},[d(M,{name:e.setting.pageFullscreen?"suoxiao":"fangda"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(bl=l.value.toolbarTips)==null?void 0:bl.pageFullscreen])]);case"fullscreen":return d("div",{class:`${u}-toolbar-item`,title:(yl=l.value.toolbarTips)==null?void 0:yl.fullscreen,onClick:()=>{n()}},[d(M,{name:e.setting.fullscreen?"fullscreen-exit":"fullscreen"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(kl=l.value.toolbarTips)==null?void 0:kl.fullscreen])]);case"preview":return d("div",{class:`${u}-toolbar-item`,title:(wl=l.value.toolbarTips)==null?void 0:wl.preview,onClick:()=>{e.updateSetting("preview")}},[d(M,{name:"preview"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[($l=l.value.toolbarTips)==null?void 0:$l.preview])]);case"htmlPreview":return d("div",{class:`${u}-toolbar-item`,title:(Cl=l.value.toolbarTips)==null?void 0:Cl.htmlPreview,onClick:()=>{e.updateSetting("htmlPreview")}},[d(M,{name:"coding"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(Tl=l.value.toolbarTips)==null?void 0:Tl.htmlPreview])]);case"catalog":return d("div",{class:`${u}-toolbar-item`,title:(xl=l.value.toolbarTips)==null?void 0:xl.catalog,onClick:()=>{$.emit(t,Jt)},key:"bar-catalog"},[d(M,{name:"catalog"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(Sl=l.value.toolbarTips)==null?void 0:Sl.catalog])]);case"github":return d("div",{class:`${u}-toolbar-item`,title:(El=l.value.toolbarTips)==null?void 0:El.github,onClick:()=>_o("https://github.com/imzbf/md-editor-v3")},[d(M,{name:"github"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(Fl=l.value.toolbarTips)==null?void 0:Fl.github])]);case"mermaid":return d(Je,{relative:`#${r}`,visible:m.mermaid,onChange:L=>{m.mermaid=L},overlay:d("ul",{class:`${u}-menu`,onClick:()=>{m.mermaid=!1}},[d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("flow")}},[(Al=l.value.mermaid)==null?void 0:Al.flow]),d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("sequence")}},[(Il=l.value.mermaid)==null?void 0:Il.sequence]),d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("gantt")}},[(Ml=l.value.mermaid)==null?void 0:Ml.gantt]),d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("class")}},[(Ll=l.value.mermaid)==null?void 0:Ll.class]),d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("state")}},[(Ol=l.value.mermaid)==null?void 0:Ol.state]),d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("pie")}},[(_l=l.value.mermaid)==null?void 0:_l.pie]),d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("relationship")}},[(Hl=l.value.mermaid)==null?void 0:Hl.relationship]),d("li",{class:`${u}-menu-item ${u}-menu-item-mermaid`,onClick:()=>{a("journey")}},[(jl=l.value.mermaid)==null?void 0:jl.journey])]),key:"bar-mermaid"},{default:()=>{var L,X;return[d("div",{class:`${u}-toolbar-item`,title:(L=l.value.toolbarTips)==null?void 0:L.mermaid},[d(M,{name:"mermaid"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(X=l.value.toolbarTips)==null?void 0:X.mermaid])])]}});case"katex":return d(Je,{relative:`#${r}`,visible:m.katex,onChange:L=>{m.katex=L},overlay:d("ul",{class:`${u}-menu`,onClick:()=>{m.katex=!1}},[d("li",{class:`${u}-menu-item ${u}-menu-item-katex`,onClick:()=>{a("katexInline")}},[(Bl=l.value.katex)==null?void 0:Bl.inline]),d("li",{class:`${u}-menu-item ${u}-menu-item-katex`,onClick:()=>{a("katexBlock")}},[(Dl=l.value.katex)==null?void 0:Dl.block])]),key:"bar-katex"},{default:()=>{var L,X;return[d("div",{class:`${u}-toolbar-item`,title:(L=l.value.toolbarTips)==null?void 0:L.katex},[d(M,{name:"formula"},null),e.showToolbarName&&d("div",{class:`${u}-toolbar-item-name`},[(X=l.value.toolbarTips)==null?void 0:X.katex])])]}})}else if(e.defToolbars instanceof Array){const L=e.defToolbars[b];return L?Vt(L,{theme:o.value,language:i.value,insert(X){$.emit(t,D,"universal",{generate:X})}}):""}else if(e.defToolbars&&e.defToolbars.children instanceof Array){const L=e.defToolbars.children[b];return L?Vt(L,{theme:o.value,language:i.value,insert(X){$.emit(t,D,"universal",{generate:X})}}):""}else return""};return I(()=>e.toolbars,()=>{Pe(()=>{h.value&&Oo(h.value)})},{immediate:!0}),()=>{const b=w.value[0].map(C=>p(C)),k=w.value[1].map(C=>p(C));return d(Ht,null,[e.toolbars.length>0&&d("div",{class:`${u}-toolbar-wrapper`,ref:h,id:r},[d("div",{class:[`${u}-toolbar`,e.showToolbarName&&`${u}-stn`]},[d("div",{class:`${u}-toolbar-left`,ref:f},[b]),d("div",{class:`${u}-toolbar-right`},[k])])]),d("input",{ref:v,accept:"image/*",type:"file",multiple:!0,style:{display:"none"}},null),d(An,{linkVisible:s.linkVisible,clipVisible:s.clipVisible,type:s.type,onCancel:()=>{s.linkVisible=!1,s.clipVisible=!1},onOk:C=>{C&&a(s.type,{desc:C.desc,url:C.url}),s.linkVisible=!1,s.clipVisible=!1}},null)])}}}),Mn=(e,t)=>{const l=_t(()=>{e.removeEventListener("scroll",o),e.addEventListener("scroll",o),t.removeEventListener("scroll",o),t.addEventListener("scroll",o)},50),o=i=>{const n=e.clientHeight,r=t.clientHeight,h=e.scrollHeight,m=t.scrollHeight,a=(h-n)/(m-r);i.target===e?(t.removeEventListener("scroll",o),t.scrollTo({top:e.scrollTop/a}),l()):(e.removeEventListener("scroll",o),e.scrollTo({top:t.scrollTop*a}),l())};return[()=>{l().finally(()=>{e.dispatchEvent(new Event("scroll"))})},()=>{e.removeEventListener("scroll",o),t.removeEventListener("scroll",o)}]},Ln=(e,t,l)=>{const{view:o}=l,i=jo(),n=w=>o.lineBlockAt(o.state.doc.line(w).from).top,r=w=>o.lineBlockAt(o.state.doc.line(w).from).height;let h=[];const m=()=>{h=[];const w=Array.from(t.querySelectorAll("[data-line]")).map(b=>Number(b.dataset.line)+1),{lines:v}=o.state.doc;let g=1,p=w.shift()??v;for(let b=1;b<=v;b++)b===p&&(g=b,p=w.shift()||v+1),h.push({start:g,end:p-1})};let a=0,s=0;const f=Ho(w=>{var v,g,p,b,k,C,x;if(!((v=t.firstElementChild)!=null&&v.firstElementChild))return;const E=o.lineBlockAtHeight(o.scrollDOM.scrollTop),{number:_}=o.state.doc.lineAt(E.from);if(_>h.length||o.state.doc.lines<h[h.length-1].end)return;let H=+getComputedStyle(t).paddingTop.replace("px","");const q=+getComputedStyle(t).paddingBottom.replace("px","");if(w.target===e){if(s!==0)return;a++;const R=h[_-1];let V=n(R.end)+r(R.end),se=0;const ve=n(R.start),ie=t.querySelector(`[data-line="${R.start-1}"]`)||((g=t.firstElementChild)==null?void 0:g.firstElementChild),te=t.querySelector(`[data-line="${R.end}"]`)||((p=t.lastElementChild)==null?void 0:p.lastElementChild);let le=0,re=0;ve===0?ie===te?(H=0,V=o.contentDOM.offsetHeight-o.scrollDOM.offsetHeight,se=o.scrollDOM.scrollTop/V,le=te.offsetTop+te.offsetHeight-t.clientHeight):(se=o.scrollDOM.scrollTop/V,le=te.offsetTop):V>o.scrollDOM.scrollHeight-o.scrollDOM.clientHeight?(se=(o.scrollDOM.scrollTop-ve)/(o.scrollDOM.scrollHeight-o.scrollDOM.clientHeight-ve),re=ie.offsetTop,le=t.scrollHeight-t.clientHeight-re+10):(se=(o.scrollDOM.scrollTop-ve)/(V-ve),re=ie.offsetTop,le=te.offsetTop-re);const Le=re-H+le*se;i(t,Le,()=>{a--})}else{if(a!==0)return;s++;const R=Array.from(t.querySelectorAll("[data-line]")),V=t.scrollTop,se=t.scrollHeight;let ve=R.length===0?1:Math.ceil(Number(R[R.length-1].dataset.line)*(V/se)),ie=(b=t.firstElementChild)==null?void 0:b.firstElementChild;for(let ce=ve;ce>=0;ce--){const pe=t.querySelector(`[data-line="${ce}"]`);if(pe&&pe.offsetTop<=V){ie=pe,ve=ce;break}}let te=(k=t.firstElementChild)==null?void 0:k.firstElementChild,le=(C=t.firstElementChild)==null?void 0:C.lastElementChild;for(;R.length>0;){const ce=R.indexOf(ie);if(ce+1>=R.length)break;const pe=R[ce+1];if(ce===-1){le=pe;break}const rt=ie.offsetTop;if(rt>V){if(ce===0){te=ie,le=pe;break}ie=R[ce-1];continue}const kt=pe.offsetTop;if(rt<=V&&kt>V){te=ie,le=pe;break}ie=pe}const re=te.offsetTop;let Le=le.offsetTop,Re=0;const{start:yt,end:at}=h[Number(te.dataset.line||0)],Ve=n(yt);let Oe=n(at);const st=r(at);let _e=0;te===((x=t.firstElementChild)==null?void 0:x.firstElementChild)?(te===le?(Le=le.offsetHeight-t.offsetHeight+H+q,_e=o.contentDOM.offsetHeight-o.scrollDOM.offsetHeight):_e=Oe+st-Ve,Re=Math.max(V/Le,0)):Oe>o.scrollDOM.scrollHeight-o.scrollDOM.clientHeight?(Re=Math.max((V-re)/(t.scrollHeight-re-t.clientHeight),0),Oe=n(o.state.doc.lines)+r(o.state.doc.lines),_e=8+Oe-Ve-e.clientHeight):(Re=Math.max((V-re)/(Le-re),0),_e=Oe+st-Ve),i(e,Ve+_e*Re,()=>{s--})}},10);return[()=>{m(),e.addEventListener("scroll",f),t.addEventListener("scroll",f),e.dispatchEvent(new Event("scroll"))},()=>{h=[],e.removeEventListener("scroll",f),t.removeEventListener("scroll",f)}]},On=(e,t,l)=>{const o=O("editorId");let i=()=>{},n=()=>{};const r=()=>{i();const h=document.querySelector(`#${o} .cm-scroller`),m=document.querySelector(`[id="${o}-preview-wrapper"][data-show="true"]`),a=document.querySelector(`[id="${o}-html-wrapper"][data-show="true"]`);(m||a)&&([n,i]=(m?Ln:Mn)(h,m||a,l.value)),e.scrollAuto&&n()};I([t,ze(e.setting,"preview"),ze(e.setting,"htmlPreview"),ze(e.setting,"fullscreen"),ze(e.setting,"pageFullscreen")],()=>{Pe(r)}),I(()=>e.scrollAuto,h=>{h?n():i()}),P(r)},_n=On,Hn=(e,t,l)=>{var o,i,n,r,h,m;let a="",s=0,f=0,w=!0,v=!1;const g=t.getSelectedText(),p=(o=U.editorConfig)==null?void 0:o.mermaidTemplate;if(/^h[1-6]{1}$/.test(e)){const b=e.replace(/^h(\d)/,(k,C)=>new Array(Number(C)).fill("#",0,C).join(""));a=`${b} ${g}`,s=b.length+1}else if(e==="prettier"){const b=window.prettier||((n=(i=U.editorExtensions)==null?void 0:i.prettier)==null?void 0:n.prettierInstance),k=[((r=window.prettierPlugins)==null?void 0:r.markdown)||((m=(h=U.editorExtensions)==null?void 0:h.prettier)==null?void 0:m.parserMarkdownInstance)];!b||k[0]===void 0?($.emit(l.editorId,Ze,{name:"prettier",message:"prettier is undefined"}),a=t.getValue()):a=b.format(t.getValue(),{parser:"markdown",plugins:k}),w=!1,v=!0}else switch(e){case"bold":{a=`**${g}**`,s=2,f=-2;break}case"underline":{a=`<u>${g}</u>`,s=3,f=-4;break}case"italic":{a=`*${g}*`,s=1,f=-1;break}case"strikeThrough":{a=`~~${g}~~`,s=2,f=-2;break}case"sub":{a=`<sub>${g}</sub>`,s=5,f=-6;break}case"sup":{a=`<sup>${g}</sup>`,s=5,f=-6;break}case"codeRow":{a="`"+g+"`",s=1,f=-1;break}case"quote":{a=`> ${g}`,s=2;break}case"orderedList":{a=`1. ${g}`,s=3;break}case"unorderedList":{a=`- ${g}`,s=2;break}case"task":{a=`- [ ] ${g}`,s=6;break}case"code":{const b=l.text||g||"",k=l.mode||"language";a=`\`\`\`${k}
${b}
\`\`\`
`,s=3,f=3+k.length-a.length;break}case"table":{a="|";const{selectedShape:b={x:1,y:1}}=l,{x:k,y:C}=b;for(let x=0;x<=C;x++)a+=" col |";a+=`
|`;for(let x=0;x<=C;x++)a+=" - |";for(let x=0;x<=k;x++){a+=`
|`;for(let E=0;E<=C;E++)a+=" content |"}s=2,f=5-a.length;break}case"link":{const{desc:b,url:k}=l;a=`[${b}](${k})`,w=!1;break}case"image":{const{desc:b,url:k,urls:C}=l;C instanceof Array?a=C.reduce((x,E)=>x+`![${b}](${E})
`,""):a=`![${b}](${k})
`,w=!1;break}case"flow":{a=`\`\`\`mermaid
${(p==null?void 0:p.flow)||`flowchart TD 
  Start --> Stop`}
\`\`\`
`,s=3,f=10-a.length;break}case"sequence":{a=`\`\`\`mermaid
${(p==null?void 0:p.sequence)||`sequenceDiagram
  A->>B: hello!
  B-->>A: hi!
  A-)B: bye!`}
\`\`\`
`,s=3,f=10-a.length;break}case"gantt":{a=`\`\`\`mermaid
${(p==null?void 0:p.gantt)||`gantt
title A Gantt Diagram
dateFormat  YYYY-MM-DD
section Section
A task  :a1, 2014-01-01, 30d
Another task  :after a1, 20d`}
\`\`\`
`,s=3,f=10-a.length;break}case"class":{a=`\`\`\`mermaid
${(p==null?void 0:p.class)||`classDiagram
  class Animal
  Vehicle <|-- Car`}
\`\`\`
`,s=3,f=10-a.length;break}case"state":{a=`\`\`\`mermaid
${(p==null?void 0:p.state)||`stateDiagram-v2
  s1 --> s2`}
\`\`\`
`,s=3,f=10-a.length;break}case"pie":{a=`\`\`\`mermaid
${(p==null?void 0:p.pie)||`pie title Pets adopted by volunteers
  "Dogs" : 386
  "Cats" : 85
  "Rats" : 15`}
\`\`\`
`,s=3,f=10-a.length;break}case"relationship":{a=`\`\`\`mermaid
${(p==null?void 0:p.relationship)||`erDiagram
  CAR ||--o{ NAMED-DRIVER : allows
  PERSON ||--o{ NAMED-DRIVER : is`}
\`\`\`
`,s=3,f=10-a.length;break}case"journey":{a=`\`\`\`mermaid
${(p==null?void 0:p.journey)||`journey
  title My working day
  section Go to work
    Make tea: 5: Me
    Go upstairs: 3: Me
    Do work: 1: Me, Cat
  section Go home
    Go downstairs: 5: Me
    Sit down: 5: Me`}
\`\`\`
`,s=3,f=10-a.length;break}case"katexInline":{a="$$",s=1,f=-1;break}case"katexBlock":{a=`$$

$$
`,s=3,f=-4;break}case"universal":{const{generate:b}=l,k=b(g);a=k.targetValue,w=k.select||!0,s=k.deviationStart||0,f=k.deviationEnd||0}}return{text:a,options:{select:w,deviationStart:s,deviationEnd:f,replaceAll:v}}},jn="#e5c07b",Jl="var(--md-color)",Bn="#56b6c2",Dn="#ffffff",ut="var(--md-color)",Yl="#e5c07b",Nn="#e5c07b",zn="var(--md-color)",Ql="#d19a66",Pn="#c678dd",Rn="#21252b",Vn="#2c313a",eo="var(--md-bk-color)",zt="var(--md-bk-color)",Wn="#ceedfa33",to="#528bff",Un=Ue.theme({"&":{color:ut,backgroundColor:eo},".cm-content":{caretColor:to},".cm-cursor, .cm-dropCursor":{borderLeftColor:to},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Wn},".cm-panels":{backgroundColor:Rn,color:ut},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:eo,color:ut,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:Vn},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:zt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:zt,borderBottomColor:zt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:ut}}},{dark:!0}),qn=ho.define([{tag:y.keyword,color:Pn},{tag:[y.name,y.deleted,y.character,y.propertyName,y.macroName],color:Jl},{tag:[y.function(y.variableName),y.labelName],color:Nn},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:Ql},{tag:[y.definition(y.name),y.separator],color:ut},{tag:[y.typeName,y.className,y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:jn},{tag:[y.operator,y.operatorKeyword,y.url,y.escape,y.regexp,y.link,y.special(y.string)],color:Bn},{tag:[y.meta,y.comment],color:Yl},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.link,color:Yl,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:Jl},{tag:[y.atom,y.bool,y.special(y.variableName)],color:Ql},{tag:[y.processingInstruction,y.string,y.inserted],color:zn},{tag:y.invalid,color:Dn}]),lo=[Un,mo(qn)],Gn="#e5c07b",oo="#3f4a54",Kn="#56b6c2",Zn="#fff",ht="#3f4a54",io="#2d8cf0",Xn="#2d8cf0",Jn="#3f4a54",no="#d19a66",Yn="#c678dd",Qn="#21252b",ea="#ceedfa33",ao="var(--md-bk-color)",Pt="var(--md-bk-color)",ta="#bad5fa",so="#3f4a54",la=Ue.theme({"&":{color:ht,backgroundColor:ao},".cm-content":{caretColor:so},".cm-cursor, .cm-dropCursor":{borderLeftColor:so},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ta},".cm-panels":{backgroundColor:Qn,color:ht},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#ceedfa33"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:ao,color:ht,borderRight:"1px solid",borderColor:"var(--md-border-color)"},".cm-activeLineGutter":{backgroundColor:ea},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"1px solid var(--md-border-color)",backgroundColor:Pt},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Pt,borderBottomColor:Pt},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{color:ht}}}),oa=ho.define([{tag:y.keyword,color:Yn},{tag:[y.name,y.deleted,y.character,y.propertyName,y.macroName],color:oo},{tag:[y.function(y.variableName),y.labelName],color:Xn},{tag:[y.color,y.constant(y.name),y.standard(y.name)],color:no},{tag:[y.definition(y.name),y.separator],color:ht},{tag:[y.typeName,y.className,y.number,y.changed,y.annotation,y.modifier,y.self,y.namespace],color:Gn},{tag:[y.operator,y.operatorKeyword,y.url,y.escape,y.regexp,y.link,y.special(y.string)],color:Kn},{tag:[y.meta,y.comment],color:io},{tag:y.strong,fontWeight:"bold"},{tag:y.emphasis,fontStyle:"italic"},{tag:y.strikethrough,textDecoration:"line-through"},{tag:y.link,color:io,textDecoration:"underline"},{tag:y.heading,fontWeight:"bold",color:oo},{tag:[y.atom,y.bool,y.special(y.variableName)],color:no},{tag:[y.processingInstruction,y.string,y.inserted],color:Jn},{tag:y.invalid,color:Zn}]),ro=[la,mo(oa)],Ct=(e,t,l,o,i)=>(n,r,h,m)=>{const a=`${e}${t}`.slice(m-h);n.dispatch(n.state.replaceSelection(`${a}${l}${o}`));const s=h+r.label.length+(i==="title"?l.length:0);n.dispatch({selection:Fe.create([Fe.range(h+r.label.length+(i==="title"?1:-t.length),s),Fe.cursor(s)],1)}),n.focus()},co=e=>(t,l,o,i)=>{const n=e.slice(i-o);t.dispatch(t.state.replaceSelection(`${n} `))},ia=e=>{const t=l=>{const o=l.matchBefore(/^#+|^-\s*\[*\s*\]*|`+|\[|!\[*|^\|\s?\|?|^\$\$?|!+\s*\w*/);return o===null||o.from==o.to&&l.explicit?null:{from:o.from,options:[...["h1","h2","h3","h4","h5","h6"].map((i,n)=>{const r=new Array(n+1).fill("#").join("");return{label:r,type:"text",apply:co(r)}}),...["unchecked","checked"].map(i=>{const n=i==="checked"?"- [x]":"- [ ]";return{label:n,type:"text",apply:co(n)}}),...[["`",""],["```","language"],["```mermaid\n",""]].map(i=>({label:`${i[0]}${i[1]}`,type:"text",apply:Ct(i[0],i[1],"",i[0]==="`"?"`":"\n```","type")})),{label:"[]()",type:"text"},{label:"![]()",type:"text"},{label:"| |",type:"text",detail:"table",apply:`| col | col | col |
| - | - | - |
| content | content | content |
| content | content | content |`},{label:"$",type:"text",apply:Ct("$","","","$","type")},{label:"$$",type:"text",apply:Ct("$$","",`
`,`
$$`,"title")},...["note","abstract","info","tip","success","question","warning","failure","danger","bug","example","quote","hint","caution","error","attention"].map(i=>({label:`!!! ${i}`,type:"text",apply:Ct("!!!",` ${i}`," Title",`

!!!`,"title")}))]}};return Zo({override:e?[t,...e]:[t]})},uo=ia,Xe=e=>{const t=new Tt;return l=>(t.get(e.state)?e.dispatch({effects:t.reconfigure(l)}):e.dispatch({effects:Xo.appendConfig.of(t.of(l))}),!0)};class na{constructor(t){He(this,"view"),He(this,"maxLength",Number.MAX_SAFE_INTEGER),He(this,"toggleTabSize"),He(this,"togglePlaceholder"),He(this,"setExtensions"),He(this,"toggleDisabled"),He(this,"toggleReadOnly"),He(this,"toggleMaxlength"),this.view=t,this.toggleTabSize=Xe(this.view),this.togglePlaceholder=Xe(this.view),this.setExtensions=Xe(this.view),this.toggleDisabled=Xe(this.view),this.toggleReadOnly=Xe(this.view),this.toggleMaxlength=Xe(this.view)}getValue(){return this.view.state.doc.toString()}setValue(t,l=0,o=this.view.state.doc.length){this.view.dispatch({changes:{from:l,to:o,insert:t}})}getSelectedText(){const{from:t,to:l}=this.view.state.selection.main;return this.view.state.sliceDoc(t,l)}replaceSelectedText(t,l={select:!0,deviationStart:0,deviationEnd:0,replaceAll:!1},o){try{if(l.replaceAll){if(this.setValue(t),t.length>this.maxLength)throw new Error("The input text is too long");return}if(this.view.state.doc.length-this.getSelectedText().length+t.length>this.maxLength)throw new Error("The input text is too long");const{from:i}=this.view.state.selection.main;if(this.view.dispatch(this.view.state.replaceSelection(t)),l.select){const n=i+t.length+l.deviationEnd;this.view.dispatch({selection:Fe.create([Fe.range(i+l.deviationStart,n),Fe.cursor(n)],1)})}this.view.focus()}catch(i){if(i.message==="The input text is too long")$.emit(o,Ze,{name:"overlength",message:i.message,data:t});else throw i}}setTabSize(t){this.toggleTabSize([Nt.tabSize.of(t),qo.of(" ".repeat(t))])}setPlaceholder(t){this.togglePlaceholder(Go(t))}focus(t){if(this.view.focus(),!t)return;let l=0,o=0,i=0;switch(t){case"start":break;case"end":{l=o=i=this.getValue().length;break}default:l=t.rangeAnchor||t.cursorPos,o=t.rangeHead||t.cursorPos,i=t.cursorPos}this.view.dispatch({scrollIntoView:!0,selection:Fe.create([Fe.range(l,o),Fe.cursor(i)],1)})}setDisabled(t){this.toggleDisabled([Ue.editable.of(!t)])}setReadOnly(t){this.toggleReadOnly([Nt.readOnly.of(t)])}setMaxLength(t){this.maxLength=t,this.toggleMaxlength([Nt.changeFilter.of(l=>l.newDoc.length<=t)])}}const aa=e=>{const t=O("editorId");return l=>{if(!l.clipboardData)return;if(l.clipboardData.files.length>0){const{files:i}=l.clipboardData;$.emit(t,Bt,Array.from(i).filter(n=>/image\/.*/.test(n.type))),l.preventDefault();return}if(e.autoDetectCode&&l.clipboardData.types.includes("vscode-editor-data")){const i=JSON.parse(l.clipboardData.getData("vscode-editor-data"));$.emit(t,D,"code",{mode:i.mode,text:l.clipboardData.getData("text/plain")}),l.preventDefault();return}const o=l.clipboardData.getData("text/plain");e.maxlength&&o.length+e.modelValue.length>e.maxlength&&$.emit(t,Ze,{name:"overlength",message:"The input text is too long",data:o})}},sa=aa,ra=e=>{const t=O("editorId");P(()=>{$.on(t,{name:vo,callback(l){var o;(o=e.value)==null||o.focus(l)}})})},ca=ra,da=(e,t)=>[{key:"Ctrl-b",mac:"Cmd-b",run:()=>($.emit(e,D,"bold"),!0)},{key:"Ctrl-d",mac:"Cmd-d",run:Jo,preventDefault:!0},{key:"Ctrl-s",mac:"Cmd-s",run:l=>($.emit(e,jt,l.state.doc.toString()),!0),shift:()=>($.emit(e,D,"strikeThrough"),!0)},{key:"Ctrl-u",mac:"Cmd-u",run:()=>($.emit(e,D,"underline"),!0),shift:()=>($.emit(e,D,"unorderedList"),!0)},{key:"Ctrl-i",mac:"Cmd-i",run:()=>($.emit(e,D,"italic"),!0),shift:()=>($.emit(e,Wt,"image"),!0)},{key:"Ctrl-1",mac:"Cmd-1",run:()=>($.emit(e,D,"h1"),!0)},{key:"Ctrl-2",mac:"Cmd-2",run:()=>($.emit(e,D,"h2"),!0)},{key:"Ctrl-3",mac:"Cmd-3",run:()=>($.emit(e,D,"h3"),!0)},{key:"Ctrl-4",mac:"Cmd-4",run:()=>($.emit(e,D,"h4"),!0)},{key:"Ctrl-5",mac:"Cmd-5",run:()=>($.emit(e,D,"h5"),!0)},{key:"Ctrl-6",mac:"Cmd-6",run:()=>($.emit(e,D,"h6"),!0)},{key:"Ctrl-ArrowUp",mac:"Cmd-ArrowUp",run:()=>($.emit(e,D,"sup"),!0)},{key:"Ctrl-ArrowDown",mac:"Cmd-ArrowDown",run:()=>($.emit(e,D,"sub"),!0)},{key:"Ctrl-o",mac:"Cmd-o",run:()=>($.emit(e,D,"orderedList"),!0)},{key:"Ctrl-c",mac:"Cmd-c",shift:()=>($.emit(e,D,"code"),!0),any(l,o){return(o.ctrlKey||o.metaKey)&&o.altKey&&o.code==="KeyC"?($.emit(e,D,"codeRow"),!0):!1}},{key:"Ctrl-l",mac:"Cmd-l",run:()=>($.emit(e,Wt,"link"),!0)},{key:"Ctrl-f",mac:"Cmd-f",shift:()=>t.noPrettier?!1:($.emit(e,D,"prettier"),!0)},{any:(l,o)=>(o.ctrlKey||o.metaKey)&&o.altKey&&o.shiftKey&&o.code==="KeyT"?($.emit(e,D,"table"),!0):!1}],ua=da,ha=e=>{const t=O("tabWidth"),l=O("editorId"),o=O("theme"),i=G(),n=it(),r=new Tt,h=new Tt,m=new Tt,a=ua(l,e),s=sa(e),f=[Po.of([...a,Ro]),No,r.of(Vo({codeLanguages:Ko})),Ue.lineWrapping,Ue.updateListener.of(v=>{v.docChanged&&e.onChange(v.state.doc.toString())}),Ue.domEventHandlers({paste:s,blur:e.onBlur,focus:e.onFocus,drop:e.onDrop,input:v=>{e.onInput&&e.onInput(v);const{data:g}=v;e.maxlength&&e.modelValue.length+g.length>e.maxlength&&$.emit(l,Ze,{name:"overlength",message:"The input text is too long",data:g})}})],w=()=>{const v=[...f,h.of(o.value==="light"?ro:lo),m.of(uo(e.completions))];return U.codeMirrorExtensions(o.value,v,[...a])};return P(()=>{const v=new Ue({doc:e.modelValue,parent:i.value,extensions:[w()]}),g=new na(v);n.value=g,setTimeout(()=>{g.setTabSize(t),g.setDisabled(e.disabled),g.setReadOnly(e.readonly),e.placeholder&&g.setPlaceholder(e.placeholder),typeof e.maxlength=="number"&&g.setMaxLength(e.maxlength),e.autofocus&&v.focus()},0),$.on(l,{name:bo,callback(){Wo(v)}}),$.on(l,{name:yo,callback(){Uo(v)}}),$.on(l,{name:D,callback(p,b={}){var k;const{text:C,options:x}=Hn(p,n.value,b);(k=n.value)==null||k.replaceSelectedText(C,x,l)}})}),I(o,()=>{var v;(v=n.value)==null||v.view.dispatch({effects:h.reconfigure(o.value==="light"?ro:lo)})},{deep:!0}),I(()=>e.completions,()=>{var v;(v=n.value)==null||v.view.dispatch({effects:m.reconfigure(uo(e.completions))})},{deep:!0}),I(()=>e.modelValue,()=>{var v,g;((v=n.value)==null?void 0:v.getValue())!==e.modelValue&&((g=n.value)==null||g.setValue(e.modelValue))}),I(()=>e.placeholder,()=>{var v;(v=n.value)==null||v.setPlaceholder(e.placeholder)}),I(()=>e.disabled,()=>{var v;(v=n.value)==null||v.setDisabled(e.disabled)}),I(()=>e.readonly,()=>{var v;(v=n.value)==null||v.setDisabled(e.readonly)}),I(()=>e.maxlength,()=>{var v;e.maxlength&&((v=n.value)==null||v.setMaxLength(e.maxlength))}),ca(n),{inputWrapperRef:i,codeMirrorUt:n}},ma=ha,pa=(e,t,l)=>{const o=ae({resizedWidth:e.inputBoxWitdh}),i=ae({width:e.inputBoxWitdh}),n=ae({left:e.inputBoxWitdh,display:"initial"}),r=a=>{var s,f,w;const v=((s=t.value)==null?void 0:s.offsetWidth)||0,g=((f=t.value)==null?void 0:f.getBoundingClientRect().x)||0;let p=a.x-g;p<$t?p=$t:p>v-$t&&(p=v-$t);const b=`${p}px`;i.width=b,n.left=b,o.resizedWidth=b,(w=e.onInputBoxWitdhChange)==null||w.call(e,b)},h=()=>{document.addEventListener("mousemove",r)},m=()=>{document.removeEventListener("mousemove",r)};return P(()=>{var a;(a=l.value)==null||a.addEventListener("mousedown",h),document.addEventListener("mouseup",m)}),nt(()=>{var a,s;(a=l.value)==null||a.removeEventListener("mousedown",h),(s=l.value)==null||s.removeEventListener("mouseup",m)}),I(()=>e.inputBoxWitdh,a=>{a&&(i.width=a,n.left=a)}),I([ze(e.setting,"htmlPreview"),ze(e.setting,"preview")],()=>{!e.setting.htmlPreview&&!e.setting.preview?(i.width="100%",n.display="none"):(i.width=o.resizedWidth,n.display="initial")},{immediate:!0}),{inputWrapperStyle:i,resizeOperateStyle:n}},fa=pa,ga=W({name:"MDEditorContent",props:Xi,setup(e){const t=O("editorId"),l=G(""),o=G(),i=G(),{inputWrapperRef:n,codeMirrorUt:r}=ma(e),{inputWrapperStyle:h,resizeOperateStyle:m}=fa(e,o,i);return _n(e,l,r),()=>d("div",{class:`${u}-content${e.setting.htmlPreview||e.setting.preview?" has-preview":""}`,ref:o},[d("div",{class:`${u}-input-wrapper`,style:h,ref:n},null),(e.setting.htmlPreview||e.setting.preview)&&d("div",{class:`${u}-resize-operate`,style:m,ref:i},null),d(xo,{modelValue:e.modelValue,setting:e.setting,onHtmlChanged:a=>{l.value=a,e.onHtmlChanged(a)},onGetCatalog:e.onGetCatalog,mdHeadingId:e.mdHeadingId,noMermaid:e.noMermaid,sanitize:e.sanitize,noKatex:e.noKatex,formatCopiedText:e.formatCopiedText,noHighlight:e.noHighlight,noImgZoomIn:e.noImgZoomIn,sanitizeMermaid:e.sanitizeMermaid},null),e.catalogVisible&&d(mt,{theme:e.theme,class:`${u}-catalog-editor`,editorId:t,mdHeadingId:e.mdHeadingId,key:"internal-catalog"},null)])}}),va=W({props:{modelValue:{type:String,default:""}},setup(e){const t=O("usedLanguageText");return()=>{var l,o;return d("div",{class:`${u}-footer-item`},[d("label",{class:`${u}-footer-label`},[`${(l=t.value.footer)==null?void 0:l.markdownTotal}:`]),d("span",null,[((o=e.modelValue)==null?void 0:o.length)||0])])}}}),ba={checked:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}}},ya=W({props:ba,setup(e){return()=>d("div",{class:[`${u}-checkbox`,e.checked&&`${u}-checkbox-checked`],onClick:()=>{e.onChange(!e.checked)}},null)}}),ka={scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}}},wa=W({props:ka,setup(e){const t=O("usedLanguageText");return()=>{var l;return d("div",{class:`${u}-footer-item`},[d("label",{class:`${u}-footer-label`,onClick:()=>{e.onScrollAutoChange(!e.scrollAuto)}},[(l=t.value.footer)==null?void 0:l.scrollAuto]),d(ya,{checked:e.scrollAuto,onChange:e.onScrollAutoChange},null)])}}}),$a={modelValue:{type:String,default:""},footers:{type:Array,default:[]},scrollAuto:{type:Boolean},onScrollAutoChange:{type:Function,default:()=>{}},defFooters:{type:Object}},Ca=W({name:"MDEditorFooter",props:$a,setup(e){const t=me(()=>{const o=e.footers.indexOf("="),i=o===-1?e.footers:e.footers.slice(0,o),n=o===-1?[]:e.footers.slice(o,Number.MAX_SAFE_INTEGER);return[i,n]}),l=o=>{if(fo.includes(o))switch(o){case"markdownTotal":return d(va,{modelValue:e.modelValue},null);case"scrollSwitch":return d(wa,{scrollAuto:e.scrollAuto,onScrollAutoChange:e.onScrollAutoChange},null)}else return e.defFooters instanceof Array?e.defFooters[o]||"":e.defFooters&&e.defFooters.children instanceof Array&&e.defFooters.children[o]||""};return()=>{const o=t.value[0].map(n=>l(n)),i=t.value[1].map(n=>l(n));return d("div",{class:`${u}-footer`},[d("div",{class:`${u}-footer-left`},[o]),d("div",{class:`${u}-footer-right`},[i])])}}}),Ta=W({name:"MdEditorV3",props:an,emits:sn,setup(e,t){const{editorId:l,noKatex:o,noMermaid:i,noPrettier:n,noUploadImg:r,noHighlight:h}=e,m=ae({scrollAuto:e.scrollAuto});Ji(e,t),Yi(e),Qi(e),en(e,t);const[a,s]=tn(e,t),f=ln(e);return nt(()=>{$.clear(l)}),on(e,t,f,a,s),()=>{var w;const v=ge({props:e,ctx:t},"defToolbars"),g=ge({props:e,ctx:t},"defFooters");return d("div",{id:l,class:[u,e.class,e.theme==="dark"&&`${u}-dark`,a.fullscreen||a.pageFullscreen?`${u}-fullscreen`:""],style:e.style},[d(In,{noPrettier:n,toolbars:e.toolbars,toolbarsExclude:e.toolbarsExclude,setting:a,updateSetting:s,tableShape:e.tableShape,defToolbars:v,noUploadImg:r,showToolbarName:e.showToolbarName},null),d(ga,{modelValue:e.modelValue,setting:a,mdHeadingId:e.mdHeadingId,noMermaid:i,noPrettier:n,sanitize:e.sanitize,placeholder:e.placeholder,noKatex:o,scrollAuto:m.scrollAuto,formatCopiedText:e.formatCopiedText,autofocus:e.autoFocus,disabled:e.disabled,readonly:e.readOnly,maxlength:e.maxLength,autoDetectCode:e.autoDetectCode,noHighlight:h,onChange:p=>{e.onChange?e.onChange(p):(t.emit("update:modelValue",p),t.emit("onChange",p))},onHtmlChanged:p=>{e.onHtmlChanged?e.onHtmlChanged(p):t.emit("onHtmlChanged",p)},onGetCatalog:p=>{e.onGetCatalog?e.onGetCatalog(p):t.emit("onGetCatalog",p)},onBlur:p=>{e.onBlur?e.onBlur(p):t.emit("onBlur",p)},onFocus:p=>{e.onFocus?e.onFocus(p):t.emit("onFocus",p)},onInput:p=>{e.onInput?e.onInput(p):t.emit("onInput",p)},completions:e.completions,catalogVisible:f.value,theme:e.theme,noImgZoomIn:e.noImgZoomIn,onDrop:p=>{e.onDrop?e.onDrop(p):t.emit("onDrop",p)},inputBoxWitdh:e.inputBoxWitdh,onInputBoxWitdhChange:p=>{e.onInputBoxWitdhChange?e.onInputBoxWitdhChange(p):t.emit("onInputBoxWitdhChange",p)},sanitizeMermaid:e.sanitizeMermaid},null),((w=e.footers)==null?void 0:w.length)>0&&d(Ca,{modelValue:e.modelValue,footers:e.footers,defFooters:g,scrollAuto:m.scrollAuto,onScrollAutoChange:p=>m.scrollAuto=p},null)])}}}),Rt=Ta;Rt.install=e=>(e.component(Rt.name,Rt),e.use(Mt).use(xt).use(Lt).use(mt).use(It),e);export{It as N,Rt as y};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}