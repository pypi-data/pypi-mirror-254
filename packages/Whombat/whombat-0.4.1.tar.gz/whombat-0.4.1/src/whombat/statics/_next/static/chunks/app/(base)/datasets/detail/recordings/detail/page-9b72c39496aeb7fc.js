(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3300],{1630:function(e,n,t){Promise.resolve().then(t.bind(t,5839))},5839:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return M}});var r=t(57437),a=t(24033),s=t(2265),l=t(5925),o=t(57305),i=t(7933),c=t(5909),d=t(12832),u=t(68447),m=t(45987),x=t(28215),h=t(60204);function f(e){let{onDelete:n}=e;return(0,r.jsx)(d.Z,{title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.aN,{className:"inline-block w-8 h-8 mr-2 text-red-500"}),"Are you sure you want to delete this recording?"]}),button:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.pJ,{className:"inline-block w-5 h-5 mr-2"}),"Delete Recording"]}),mode:"text",variant:"danger",children:e=>{let{close:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("p",{children:"This action cannot be undone. This will permanently delete the recording from the database and remove the metadata and all associated files. This includes any annotations, notes, and tags associated with the recording."}),(0,r.jsx)("p",{className:"font-semibold dark:text-red-400 text-red-600",children:"It is not recommended to delete a recording that has been annotated."}),(0,r.jsx)("p",{children:"Do you want to proceed?"})]}),(0,r.jsxs)("div",{className:"flex flex-row justify-end gap-2 mt-4",children:[(0,r.jsxs)(u.Z,{tabIndex:0,mode:"text",variant:"danger",onClick:n,children:[(0,r.jsx)(m.pJ,{className:"h-5 w-5 inline-block mr-2"}),"Delete"]}),(0,r.jsxs)(u.Z,{tabIndex:1,mode:"outline",variant:"primary",onClick:t,children:[(0,r.jsx)(m.Tw,{className:"h-5 w-5 inline-block mr-2"}),"Cancel"]})]})]})}})}function j(e){let{recording:n,onDelete:t}=e,{downloadURL:a,delete:s}=(0,h.Z)({uuid:n.uuid,recording:n,onDelete:t});return(0,r.jsxs)("div",{className:"flex flex-row gap-2 justify-center",children:[(0,r.jsxs)(x.Z,{mode:"text",variant:"primary",href:a||"","aria-disabled":null==a,download:!0,children:[(0,r.jsx)(m._8,{className:"h-5 w-5 inline-block mr-2"})," Download"]}),(0,r.jsx)(f,{onDelete:()=>s.mutate()})]})}var g=t(66358),v=t(24930),b=t.n(v),p=t(30143);let w=b()(()=>Promise.all([t.e(4212),t.e(4995)]).then(t.bind(t,54995)),{loadableGenerated:{webpack:()=>[54995]},ssr:!1}),N=b()(()=>Promise.all([t.e(4212),t.e(1167)]).then(t.bind(t,11167)),{loadableGenerated:{webpack:()=>[11167]},ssr:!1});function y(e){var n,t,a,s;let{recording:l}=e,o=null!=l.latitude&&null!=l.longitude;return(0,r.jsxs)(p.Z,{children:[(0,r.jsxs)("div",{className:"flex flex-row justify-center items-center",children:[(0,r.jsx)(m.Zl,{className:"inline-block mr-1 w-5 h-5 text-stone-500"}),"Recorded at"]}),o?(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(w,{className:"h-64",center:{lat:null!==(n=l.latitude)&&void 0!==n?n:0,lng:null!==(t=l.longitude)&&void 0!==t?t:0},scrollWheelZoom:!0,zoom:14,children:(0,r.jsx)(N,{draggable:!1,updateOnChange:!0,center:{lat:null!==(a=l.latitude)&&void 0!==a?a:0,lng:null!==(s=l.longitude)&&void 0!==s?s:0}})})}):(0,r.jsx)("div",{className:"text-sm text-stone-400 dark:text-stone-600",children:"No location provided."})]})}function Z(e){let{label:n}=e;return(0,r.jsx)("div",{className:"font-thin text-sm text-stone-500 mr-2",children:n})}function k(e){let{units:n}=e;return(0,r.jsx)("span",{className:"ml-1 text-stone-500",children:n})}function C(e){let{recording:n}=e;return(0,r.jsxs)(p.Z,{children:[(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(m.wZ,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),(0,r.jsx)(Z,{label:"Duration"}),n.duration.toFixed(3),(0,r.jsx)(k,{units:"s"})]}),(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(m.QE,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),(0,r.jsx)(Z,{label:"Channels"}),n.channels]}),(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(m.Dd,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),(0,r.jsx)(Z,{label:"Sample rate"}),n.samplerate.toLocaleString(),(0,r.jsx)(k,{units:"Hz"})]}),(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(m.i5,{className:"h-5 w-5 inline-block text-stone-500 mr-1"}),(0,r.jsx)(Z,{label:"Time expansion"}),n.time_expansion]})]})}var E=t(2964),D=t(26356),P=t(59371);function _(){return(0,r.jsx)("div",{className:"p-4 w-full",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center p-8 w-full rounded-lg border border-dashed border-stone-500 bg-stone-300 dark:bg-stone-800",children:[(0,r.jsxs)("span",{className:"text-stone-700 dark:text-stone-300",children:[(0,r.jsx)(m.uH,{className:"inline-block mr-1 w-5 h-5"})," No notes"]}),(0,r.jsx)("span",{className:"text-sm text-stone-500",children:"Create a note above to start a conversation about this recording."})]})})}function q(e){let{recording:n,currentUser:t}=e,{data:a,addNote:l,set:o}=(0,h.Z)({uuid:n.uuid,recording:n,enabled:!1}),i=(0,s.useCallback)(e=>{var n;null!=a&&o({...a,notes:null===(n=a.notes)||void 0===n?void 0:n.map(n=>n.uuid===e.uuid?e:n)})},[a,o]),c=(0,s.useCallback)(e=>{var n;null!=a&&o({...a,notes:null===(n=a.notes)||void 0===n?void 0:n.filter(n=>n.uuid!==e.uuid)})},[a,o]),d=(0,s.useMemo)(()=>n.notes||[],[n.notes]);return(0,r.jsxs)(p.Z,{children:[(0,r.jsxs)(E.H3,{children:[(0,r.jsx)(m.uH,{className:"inline-block mr-1 w-5 h-5"}),"Notes"]}),0===d.length?(0,r.jsx)(_,{}):(0,r.jsx)(P.Z,{notes:d,currentUser:t,onUpdate:i,onDelete:c}),(0,r.jsx)(D.Z,{onCreate:l.mutate})]})}var S=t(10924),T=t(50261);function R(e){let{recording:n,currentUser:t,parameters:a=c._z,onParameterSave:s,onDelete:l}=e;return(0,r.jsxs)("div",{className:"flex flex-col gap-4 pb-4",children:[(0,r.jsx)(g.ZP,{recording:n}),(0,r.jsxs)("div",{className:"flex flex-row flex-wrap gap-8 justify-between lg:flex-nowrap w-100",children:[(0,r.jsx)("div",{className:"grow",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)(T.Z,{recording:n})}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)(S.Z,{parameters:a,onParameterSave:s,recording:n})}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)(q,{recording:n,currentUser:t})})]})}),(0,r.jsxs)("div",{className:"flex flex-col flex-none gap-4 max-w-sm",children:[(0,r.jsx)(j,{recording:n,onDelete:l}),(0,r.jsx)(C,{recording:n}),(0,r.jsx)(y,{recording:n})]})]})]})}var F=t(97197);function M(){let e=(0,s.useContext)(o.Z),n=(0,a.useRouter)(),t=(0,a.useSearchParams)(),c=t.get("recording_uuid"),d=t.get("dataset_uuid"),u=(0,F.Z)(e=>e.spectrogramSettings),m=(0,F.Z)(e=>e.setSpectrogramSettings),x=(0,s.useCallback)(()=>{null==d&&n.push("/datasets/"),n.push("/datasets/detail/recordings/?dataset_uuid=".concat(d))},[n,d]),f=(0,s.useCallback)(e=>{var n;(null===(n=e.response)||void 0===n?void 0:n.status)===404&&(l.ZP.error("Recording not found"),x())},[x]),j=(0,s.useCallback)(e=>{l.ZP.success("Parameters saved"),m(e)},[m]),g=(0,s.useCallback)(()=>{l.ZP.success("Recording deleted"),x()},[x]);null==c&&(0,a.notFound)();let v=(0,h.Z)({uuid:c,onError:f});return v.isLoading?(0,r.jsx)(i.Z,{}):v.isError||null==v.data?f(v.error):(0,r.jsx)(R,{recording:v.data,currentUser:e,onDelete:g,parameters:u,onParameterSave:j})}},12832:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var r=t(57437),a=t(20841);function s(e){let{children:n,title:t,button:s="Open",...l}=e;return(0,r.jsx)(a.Z,{title:t,label:s,...l,children:n})}},30143:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(57437),a=t(54440),s=t.n(a);function l(e){let{children:n,className:t,...a}=e;return(0,r.jsx)("div",{className:s()("border flex flex-col gap-3 p-4 rounded-md border-stone-200 dark:border-stone-800 text-stone-700 dark:text-stone-300",t),...a,children:n})}},10924:function(e,n,t){"use strict";t.d(n,{Z:function(){return f}});var r=t(57437),a=t(2265),s=t(5909),l=t(87006),o=t(30143),i=t(37618),c=t(31698),d=t(88670),u=t(76254),m=t(7746),x=t(86674),h=t(52572);function f(e){var n,t;let{recording:f,height:j=384,withBar:g=!0,withControls:v=!0,withSettings:b=!0,withPlayer:p=!0,parameters:w=s._z,onParameterSave:N}=e,y=(0,a.useRef)(null),Z=null!==(t=null===(n=y.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==t?t:{width:0,height:0},k=(0,a.useMemo)(()=>({time:{min:0,max:f.duration},freq:{min:0,max:f.samplerate/2}}),[f.duration,f.samplerate]),C=(0,a.useMemo)(()=>({time:{min:0,max:Math.min(5,f.duration)},freq:{min:0,max:f.samplerate/2}}),[f.samplerate,f.duration]),E=(0,u.Z)({recording:f,endTime:k.time.max,startTime:k.time.min}),D=(0,x.Z)({dimensions:Z,recording:f,bounds:k,initial:C,parameters:w,enabled:!E.isPlaying}),{centerOn:P}=D,_=(0,a.useCallback)(e=>P({time:e}),[P]),{draw:q}=(0,h.Z)({viewport:D.viewport,currentTime:E.currentTime,isPlaying:E.isPlaying,onTimeChange:_}),{props:S,draw:T,isLoading:R}=D,F=(0,a.useCallback)(e=>{e.canvas.style.cursor="wait",R||(T(e),q(e))},[T,q,R]);return(0,m.Z)({ref:y,draw:F}),(0,r.jsxs)(o.Z,{children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[v&&(0,r.jsx)(c.Z,{canDrag:D.canDrag,canZoom:D.canZoom,onReset:D.reset,onDrag:D.enableDrag,onZoom:D.enableZoom}),b&&(0,r.jsx)(d.Z,{samplerate:f.samplerate,settings:D.parameters,onChange:D.setParameters,onReset:D.resetParameters,onSave:()=>null==N?void 0:N(D.parameters)}),p&&(0,r.jsx)(l.Z,{...E})]}),(0,r.jsx)("div",{className:"overflow-hidden rounded-md",style:{height:j},children:(0,r.jsx)("canvas",{ref:y,...S,className:"w-full h-full"})}),g&&(0,r.jsx)(i.Z,{bounds:D.bounds,viewport:D.viewport,onMove:D.zoom})]})}},41095:function(e,n,t){"use strict";t.d(n,{ZP:function(){return o}});var r=t(23588),a=t(67663),s=t(38038),l=t(2265);function o(e){let{uuid:n,initial:t,name:o,enabled:i=!0,getFn:c,onError:d}=e,u=(0,s.NL)(),m=(0,l.useCallback)(async()=>{if(null==n)throw Error("No uuid provided for object of type ".concat(o));return await c(n)},[n,o,c]),x=(0,a.a)({queryKey:[o,n],queryFn:m,retry:(e,n)=>{var t;if(null==n)return e<3;let r=null==n?void 0:null===(t=n.response)||void 0===t?void 0:t.status;return null==r?e<3:(!(r>=400)||!(r<500))&&e<3},initialData:t,staleTime:3e5,enabled:i&&null!=n}),h=(0,l.useCallback)(e=>{u.setQueryData([o,n],e)},[u,n,o]),{error:f,isError:j}=x;return(0,l.useEffect)(()=>{j&&(null==d||d(f))},[f,j,d]),{query:x,client:u,setData:h,useQuery:e=>{let{queryFn:t,name:r,enabled:s=!1}=e;return function(e){let{uuid:n,query:t,queryFn:r,name:s,secondaryName:o,enabled:i=!1}=e,{status:c,data:d}=t,u=(0,l.useCallback)(async()=>{if("pending"===c)throw Error("No data for object of type ".concat(s," (uuid=").concat(n,"). ")+"Either the query is not enabled or the query is still loading.");if("error"===c)throw Error("Error while loading object of type ".concat(s," (uuid=").concat(n,"), cannot mutate"));return await r(d)},[c,d,r,s,n]);return(0,a.a)({queryFn:u,queryKey:[s,n,o],enabled:"pending"!==c&&"error"!==c&&i})}({uuid:n,query:x,queryFn:t,secondaryName:r,name:o,enabled:s})},useMutation:e=>{let{mutationFn:t,onSuccess:a,onError:s,withUpdate:i=!0}=e;return function(e){let{uuid:n,query:t,client:a,mutationFn:s,name:o,onSuccess:i,onError:c,withUpdate:d=!0}=e,{status:u,data:m}=t,x=(0,l.useCallback)(async e=>{if(null==n)throw Error("No uuid provided for object of type ".concat(o));if("pending"===u)throw Error("No data for object of type ".concat(o," (uuid=").concat(n,"). ")+"Either the query is not enabled or the query is still loading.");if("error"===u)throw Error("Error while loading object of type ".concat(o," (uuid=").concat(n,"), cannot mutate"));return await s(m,e)},[u,m,s,o,n]);return(0,r.D)({mutationFn:x,onSuccess:e=>{d&&a.setQueryData([o,n],e),null==i||i(e)},onError:c})}({uuid:n,query:x,client:u,mutationFn:t,name:o,onSuccess:a,onError:s,withUpdate:i})},useDestruction:e=>{let{mutationFn:t,onSuccess:a,onError:s}=e;return function(e){let{uuid:n,query:t,client:a,mutationFn:s,name:o,onSuccess:i,onError:c}=e,{status:d,data:u}=t,m=(0,l.useCallback)(async()=>{if(null==n)throw Error("No uuid provided for object of type ".concat(o));if("pending"===d)throw Error("No data for object of type ".concat(o," (uuid=").concat(n,"). ")+"Either the query is not enabled or the query is still loading.");if("error"===d)throw Error("Error while loading object of type ".concat(o," (uuid=").concat(n,"), cannot mutate"));return await s(u)},[d,u,s,o,n]);return(0,r.D)({mutationFn:m,onSuccess:e=>{a.removeQueries({queryKey:[o,n]}),null==i||i(e)},onError:c})}({uuid:n,query:x,client:u,mutationFn:t,name:o,onSuccess:a,onError:s})}}}}},function(e){e.O(0,[1749,9966,3475,8966,5250,7663,828,721,4766,5166,8311,5062,1698,262,7548,9440,610,2971,4938,1744],function(){return e(e.s=1630)}),_N_E=e.O()}]);