"use strict";(globalThis["webpackChunkphotobooth_app_frontend"]=globalThis["webpackChunkphotobooth_app_frontend"]||[]).push([[492],{29492:(e,l,a)=>{a.r(l),a.d(l,{default:()=>V});var o=a(59835),t=a(86970),i=a(61957);const n={class:"q-pa-md"},d=(0,o._)("div",{class:"text-h6"},"New folder name",-1),r=(0,o._)("div",{class:"text-h6"},"Upload files to current folder",-1),s=["onClick"];function c(e,l,a,c,u,p){const f=(0,o.up)("q-breadcrumbs-el"),m=(0,o.up)("q-breadcrumbs"),g=(0,o.up)("q-card-section"),w=(0,o.up)("q-input"),_=(0,o.up)("q-btn"),b=(0,o.up)("q-card-actions"),h=(0,o.up)("q-card"),y=(0,o.up)("q-dialog"),v=(0,o.up)("q-uploader"),k=(0,o.up)("q-icon"),C=(0,o.up)("q-td"),W=(0,o.up)("q-table"),q=(0,o.up)("q-page"),F=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(q,{padding:""},{default:(0,o.w5)((()=>[(0,o._)("div",n,[(0,o.Wm)(m,{gutter:"sm",style:{cursor:"pointer"}},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{label:"Working Directory",icon:"home",onClick:l[0]||(l[0]=e=>c.onBreadcrumbClick(-1))}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(c.breadcrumbs,((e,l)=>((0,o.wg)(),(0,o.j4)(f,{key:l,onClick:e=>c.onBreadcrumbClick(l)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,t.zw)(e),1)])),_:2},1032,["onClick"])))),128))])),_:1}),(0,o.Wm)(y,{modelValue:c.dialog_create_new_folder,"onUpdate:modelValue":l[4]||(l[4]=e=>c.dialog_create_new_folder=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{style:{"min-width":"350px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[d])),_:1}),(0,o.Wm)(g,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{dense:"",modelValue:c.new_folder_name,"onUpdate:modelValue":l[1]||(l[1]=e=>c.new_folder_name=e),autofocus:"",onKeyup:l[2]||(l[2]=(0,i.D2)((e=>{c.createNewFolder(c.new_folder_name),c.dialog_create_new_folder=!1}),["enter"]))},null,8,["modelValue"])])),_:1}),(0,o.Wm)(b,{align:"right",class:"text-primary"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(_,{flat:"",label:"Cancel"},null,512),[[F]]),(0,o.wy)((0,o.Wm)(_,{flat:"",label:"Create folder",onClick:l[3]||(l[3]=e=>c.createNewFolder(c.new_folder_name))},null,512),[[F]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(y,{modelValue:c.dialog_upload_files,"onUpdate:modelValue":l[7]||(l[7]=e=>c.dialog_upload_files=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{style:{"min-width":"350px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(g,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{label:"Upload Files",url:"/admin/files/file/upload","form-fields":[{name:"upload_target_folder",value:c.folder_current}],"field-name":"uploaded_files",batch:"",multiple:"",onFinish:l[5]||(l[5]=e=>c.getFolderContent(c.folder_current)),onUploaded:l[6]||(l[6]=e=>c.dialog_upload_files=!1)},null,8,["form-fields"])])),_:1}),(0,o.Wm)(b,{align:"right",class:"text-primary"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(_,{flat:"",label:"Cancel"},null,512),[[F]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(W,{class:"full-height",flat:"",bordered:"",title:"File Browser",pagination:c.pagination,rows:c.folder_rows,filter:c.filter,columns:c.folder_columns,color:"primary","row-key":"filepath",dense:"",loading:c.folder_loading,selection:"multiple",selected:c.selected,"onUpdate:selected":l[13]||(l[13]=e=>c.selected=e),"virtual-scroll":"","rows-per-page-options":[0]},{"body-cell-type":(0,o.w5)((e=>[(0,o.Wm)(C,{props:e},{default:(0,o.w5)((()=>[e.value?((0,o.wg)(),(0,o.j4)(k,{key:0,name:"folder"})):((0,o.wg)(),(0,o.j4)(k,{key:1,name:"description"}))])),_:2},1032,["props"])])),"body-cell-name":(0,o.w5)((e=>[(0,o.Wm)(C,{props:e,style:{cursor:"pointer"}},{default:(0,o.w5)((()=>[(0,o._)("div",{onClick:l=>c.onNameClick(e.row)},(0,t.zw)(e.value),9,s)])),_:2},1032,["props"])])),"top-left":(0,o.w5)((()=>[(0,o._)("div",null,[(0,o.Wm)(_,{disable:c.folder_loading,onClick:l[8]||(l[8]=e=>c.dialog_create_new_folder=!0),label:"New Folder"},null,8,["disable"]),(0,o.Wm)(_,{class:"q-ml-sm",disable:c.folder_loading,onClick:l[9]||(l[9]=e=>c.dialog_upload_files=!0),label:"Upload file"},null,8,["disable"]),(0,o.Wm)(_,{class:"q-ml-sm",disable:0==c.selected.length,onClick:l[10]||(l[10]=e=>c.getZip(c.selected)),label:"download zip"},null,8,["disable"]),(0,o.Wm)(_,{class:"q-ml-sm",color:"negative",disable:0==c.selected.length,onClick:l[11]||(l[11]=e=>c.deleteItems(c.selected)),label:"delete selected"},null,8,["disable"])])])),"top-right":(0,o.w5)((()=>[(0,o.Wm)(w,{borderless:"",dense:"",debounce:"300",modelValue:c.filter,"onUpdate:modelValue":l[12]||(l[12]=e=>c.filter=e),placeholder:"Search"},{append:(0,o.w5)((()=>[(0,o.Wm)(k,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["pagination","rows","filter","columns","loading","selected"])])])),_:1})}a(95516),a(23036),a(62309);var u=a(60499),p=(a(91569),a(33752)),f=a(19302);function m(e,l=2){if(!+e)return"0 Bytes";const a=1024,o=l<0?0:l,t=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(a));return`${parseFloat((e/Math.pow(a,i)).toFixed(o))} ${t[i]}`}const g={watch:{folder_current(e,l){this.getFolderContent(e)}},setup(){const e=(0,f.Z)(),l=(0,u.iH)(""),a=(0,u.iH)(!1),t=(0,u.iH)([]),i=[{label:"Type",name:"type",required:!0,align:"left",field:"is_dir",style:"width: 25px"},{label:"Name",name:"name",required:!0,align:"left",field:"name"},{label:"Size",name:"size",required:!0,align:"left",field:"size",format:e=>m(e,0)}],n=(0,u.iH)([]),d=(0,u.iH)(""),r=(0,u.iH)(!1),s=(0,u.iH)(""),c=(0,u.iH)(!1),g=(0,u.iH)({rowsPerPage:0}),w=e=>e.split("/").filter((e=>""!==e)).join("/"),_=(0,o.Fl)((()=>{if(!l.value)return[];let e=w(l.value).split("/");return e})),b=e=>{e.is_dir?l.value=e.filepath:(0,p.Z)(`/admin/files/file/${e.filepath}`)},h=(e=-1)=>{l.value=_.value.slice(0,e+1).join("/")};async function y(l=""){a.value=!0,n.value=[];let o=await fetch(`/admin/files/list/${l}`,{method:"GET",headers:{"Content-Type":"application/json"}}),i=await o.json();o.ok?t.value=i:(console.error(i),e.notify({message:`Error ${o.status} getting listing. Please check logs.`,caption:"Files",type:"negative"})),a.value=!1}async function v(l=[]){let a=await fetch("/admin/files/zip",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(a.ok){e.notify({message:"Downloading ZIP file",caption:"Files",type:"positive"});let l=await a.blob();var o=window.URL.createObjectURL(l);window.location.assign(o)}else{let l=await a.json();console.error(l),e.notify({message:`Error ${a.status} creating zip. Please check logs.`,caption:"Files",type:"negative"})}}async function k(a=[]){let o=await fetch("/admin/files/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(o.ok)e.notify({message:"Selected items deleted.",caption:"Files",type:"positive"});else{let l=await o.json();console.error(l),e.notify({message:`Error ${o.status} deleting items. Please check logs.`,caption:"Files",type:"negative"})}y(l.value)}async function C(a){let o=a;l.value&&(o=l.value+"/"+o),console.log(o);let t=await fetch("/admin/files/folder/new",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),i=await t.json();t.ok?(e.notify({message:`Folder "${a}" created.`,caption:"Files",type:"positive"}),y(l.value)):(console.error(i),e.notify({message:`Error ${t.status} while creating folder. Please check logs.`,caption:"Files",type:"negative"}))}return(0,o.bv)((()=>{y()})),{breadcrumbs:_,folder_current:l,folder_columns:i,folder_rows:t,folder_loading:a,pagination:g,selected:n,filter:d,dialog_create_new_folder:r,new_folder_name:s,dialog_upload_files:c,onNameClick:b,onBreadcrumbClick:h,getFolderContent:y,getZip:v,deleteItems:k,createNewFolder:C}}};var w=a(11639),_=a(69885),b=a(72605),h=a(28052),y=a(32074),v=a(44458),k=a(63190),C=a(66611),W=a(11821),q=a(68879),F=a(55896),Z=a(70974),B=a(67220),j=a(22857),Q=a(62146),T=a(69984),P=a.n(T);const U=(0,w.Z)(g,[["render",c]]),V=U;P()(g,"components",{QPage:_.Z,QBreadcrumbs:b.Z,QBreadcrumbsEl:h.Z,QDialog:y.Z,QCard:v.Z,QCardSection:k.Z,QInput:C.Z,QCardActions:W.Z,QBtn:q.Z,QUploader:F.Z,QTable:Z.Z,QTd:B.Z,QIcon:j.Z}),P()(g,"directives",{ClosePopup:Q.Z})}}]);